<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Keela Outlook</title>

	<link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css">
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.min.css">
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.components.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Icons">

	<script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script type="text/javascript" src="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/js/fabric.min.js"></script>
    <script type="text/javascript" src="https://kit.fontawesome.com/16231497c8.js"></script>

	<style>
@charset "UTF-8";.ms-TextField{width:100%}.ms-Dropdown-title{border:none;padding:4px 12px 0 0}.ms-ContextualHost{left:94px!important;top:8px!important}.ms-Panel-contentInner{margin:0;padding:0}.ms-MessageBar{width:93.5%}.btn--disabled{color:#a6a6a6;pointer-events:none}.card-section{padding:12px 18px}.card-section.collapsible{overflow:hidden;transition:height .15s linear}.card-section-header{color:#848484;margin:0 0 18px}.decorated-text-content{display:flex;flex-direction:column;justify-content:center}.decorated-text-icon{max-width:36px}.decorated-text-decoration{align-self:center;justify-content:center}.KeyValue p{margin:.6em 0}.KeyValueImage{border-radius:5px;height:24px;position:relative;top:2px;width:24px}.KeyValueText{white-space:pre-wrap;word-break:break-word}.KeyValueBottomLabel,.KeyValueTopLabel,.SelectionInputTopLabel{color:#a6a6a6;display:block}.KeyValueTopLabel{margin-bottom:4px}.KeyValueBottomLabel{margin-top:4px}.card-iconimage{align-items:center;display:flex;justify-content:center}.card-icon-image-icon{color:#848484;height:20;width:20}.ImageButton{height:24px;margin-top:4px;width:24px}.navbar{background-color:#f4f4f4;box-sizing:border-box;color:#0078d7;padding:8px 14px;position:fixed;top:0;width:100%;z-index:9999}.navelem{font-size:x-large;height:35px;margin-left:auto;margin-right:0;text-align:center;width:28px}.navelem:hover{background-color:#eaeaea;outline:8px solid #eaeaea}.menu{left:0;margin:auto 5vw;overflow-x:hidden;overflow-y:hidden;position:absolute;top:16px;z-index:9999}.menu-icon:before{content:"⁝"}.menu-item{padding:8px 0}.menu-item-text{margin-left:12px}.menu-item-text:before{font-family:FabricMDL2Icons;padding:0 16px;position:relative;top:2px}.overlay{position:absolute;top:51px;width:100vw}.overlay-dark,.overlay-light{opacity:.5}.selection-input .ms-Dropdown{align-items:center;display:flex}.selection-input .ms-Dropdown .ms-Dropdown-caretDown{order:2;position:unset;right:unset}.selection-input .ms-Dropdown .ms-Dropdown-title{border:none;padding:4px 12px 0 0}.spinner{animation-duration:1.3s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:cubic-bezier(.53,.21,.29,.67);border-color:#0078d4 #c7e0f4 #c7e0f4;-o-border-image:initial;border-image:initial;border-radius:50%;border-style:solid;box-sizing:border-box;position:absolute;top:33.3333333333%}.spinner-large{border-width:2px;height:40px;left:calc(50% - 20px);width:40px}.spinner-medium{border-width:1.5px;height:30px;left:calc(50% - 15px);width:30px}.spinner-small{border-width:1px;height:20px;left:calc(50% - 10px);width:20px}.Switch{margin:0;top:4px}.TextButton{border:none;display:block;font-weight:700;text-transform:uppercase}.TextButton:focus{outline:none}.text-btn--filled{border-radius:2px;color:#fff;padding:8px}.text-btn--text{background:none;text-align:center}.text-input-label{padding:0!important;width:0!important}.text-input-label--bottom,.text-input-label--top{color:#a6a6a6}.text-input-input{font-family:Arial;font-size:14px;line-height:150%;min-height:28px;overflow-y:hidden;padding:8px 0!important;resize:vertical}.flex{display:flex}.card-section-toggler{align-items:center;display:flex;justify-content:center;padding:12px}.card-section-toggler-icon{font-weight:700;height:32px;line-height:2.5;text-align:center;transform:rotate(0deg);transition:transform .2s linear;width:32px}.card-section-toggler-icon.card-section-toggler--up{transform:rotate(180deg)}.card-section-toggler-icon:hover{background-color:hsla(0,0%,52%,.1);border-radius:50%}.card-widget{margin:12px 0;min-height:20px;width:100%}*{list-style-type:none}body,html{margin:0;padding:0}body{height:100vh}.disabled{pointer-events:none}.pointer{cursor:pointer}.CardHeader{align-items:center;display:flex;min-height:32px;padding:8px 16px}.headerIcon{height:32px;margin-right:16px;width:32px}.row{align-items:center;display:flex;margin:12px 0;min-height:20px;width:100%}.column{flex-grow:1}.column-icon{margin-right:16px}.column-label>.ImageButton{margin-right:0}.column-text{flex-grow:1;margin-right:8px;word-break:break-word}.ButtonSet{margin:0}.collapsible>.ButtonSet{margin:12px 0}.SetElement{display:inline}.ButtonSet .ImageButton,.ButtonSet .TextButton{margin:4px 16px 0 0}.row+.TextButton{margin:12px 0}.ImageButton,.TextButton{cursor:pointer;padding:0}.separated,.separated-both{border:solid #d0d0d0}.separated{border-width:1px 0 0}.separated-bottom{border-width:0 0 1px}.separated-both{border-width:1px 0}.centered{text-align:center}.Select{margin:0 auto}.Select,.menu{background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.4);transition:width .2s;-moz-transition:width .2s;-o-transition:width .2s;-webkit-transition:width .2s;width:90%}.singulared{height:0;width:0}.menu-item,.selectItem{transition:background-color;width:100%}.menu-item:active,.selectItem:active{background-color:#e7e7e7}.menu-item:hover,.selectItem:hover{background-color:#f4f4f4}.menu-item-text,.selectText{color:#333;margin:0}.selectText{margin-left:8px}.side i{padding:27%}.side i:hover{color:#d0d0d0}.hidden{display:none}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}
</style>
</head>

<body class="ms-font-m ms-welcome">
	<div class="navbar">
		<div class="navelem pointer">
			<span id="app-menu" class="menu-icon"></span>
		</div>
	</div>
	<main id="app-body" style="visibility:hidden;"></main>
	<div id="app-notif"></div>
	<div id="app-overlay"></div>

	<script>
!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1})}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var key,source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),_setPrototypeOf(subClass.prototype.constructor=subClass,superClass)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o})(o,p)}function _construct(Parent,args,Class){return(_construct=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),1}catch(e){}}}()?Reflect.construct.bind():function(Parent,args,Class){var a=[null];a.push.apply(a,args);args=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(args,Class.prototype),args}).apply(null,arguments)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return function(Class){if(null===Class||-1===Function.toString.call(Class).indexOf("[native code]"))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)}(Class)}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};for(var key,target={},sourceKeys=Object.keys(source),i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var i,it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=function(o,minLen){var n;if(o)return"string"==typeof o?_arrayLikeToArray(o,minLen):"Map"===(n="Object"===(n=Object.prototype.toString.call(o).slice(8,-1))&&o.constructor?o.constructor.name:n)||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}(o))||allowArrayLike&&o&&"number"==typeof o.length)return it&&(o=it),i=0,function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(exports,"__esModule",{value:!0});var LuxonError=function(_Error){function LuxonError(){return _Error.apply(this,arguments)||this}return _inheritsLoose(LuxonError,_Error),LuxonError}(_wrapNativeSuper(Error)),InvalidDateTimeError=function(_LuxonError){function InvalidDateTimeError(reason){return _LuxonError.call(this,"Invalid DateTime: "+reason.toMessage())||this}return _inheritsLoose(InvalidDateTimeError,_LuxonError),InvalidDateTimeError}(LuxonError),InvalidIntervalError=function(_LuxonError2){function InvalidIntervalError(reason){return _LuxonError2.call(this,"Invalid Interval: "+reason.toMessage())||this}return _inheritsLoose(InvalidIntervalError,_LuxonError2),InvalidIntervalError}(LuxonError),InvalidDurationError=function(_LuxonError3){function InvalidDurationError(reason){return _LuxonError3.call(this,"Invalid Duration: "+reason.toMessage())||this}return _inheritsLoose(InvalidDurationError,_LuxonError3),InvalidDurationError}(LuxonError),ConflictingSpecificationError=function(_LuxonError4){function ConflictingSpecificationError(){return _LuxonError4.apply(this,arguments)||this}return _inheritsLoose(ConflictingSpecificationError,_LuxonError4),ConflictingSpecificationError}(LuxonError),InvalidUnitError=function(_LuxonError5){function InvalidUnitError(unit){return _LuxonError5.call(this,"Invalid unit "+unit)||this}return _inheritsLoose(InvalidUnitError,_LuxonError5),InvalidUnitError}(LuxonError),InvalidArgumentError=function(_LuxonError6){function InvalidArgumentError(){return _LuxonError6.apply(this,arguments)||this}return _inheritsLoose(InvalidArgumentError,_LuxonError6),InvalidArgumentError}(LuxonError),ZoneIsAbstractError=function(_LuxonError7){function ZoneIsAbstractError(){return _LuxonError7.call(this,"Zone is an abstract class")||this}return _inheritsLoose(ZoneIsAbstractError,_LuxonError7),ZoneIsAbstractError}(LuxonError),LuxonError="numeric",s="short",l="long",DATE_SHORT={year:LuxonError,month:LuxonError,day:LuxonError},DATE_MED={year:LuxonError,month:s,day:LuxonError},DATE_MED_WITH_WEEKDAY={year:LuxonError,month:s,day:LuxonError,weekday:s},DATE_FULL={year:LuxonError,month:l,day:LuxonError},DATE_HUGE={year:LuxonError,month:l,day:LuxonError,weekday:l},TIME_SIMPLE={hour:LuxonError,minute:LuxonError},TIME_WITH_SECONDS={hour:LuxonError,minute:LuxonError,second:LuxonError},TIME_WITH_SHORT_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:l},TIME_24_SIMPLE={hour:LuxonError,minute:LuxonError,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:LuxonError,month:LuxonError,day:LuxonError,hour:LuxonError,minute:LuxonError},DATETIME_SHORT_WITH_SECONDS={year:LuxonError,month:LuxonError,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError},DATETIME_MED={year:LuxonError,month:s,day:LuxonError,hour:LuxonError,minute:LuxonError},DATETIME_MED_WITH_SECONDS={year:LuxonError,month:s,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError},DATETIME_MED_WITH_WEEKDAY={year:LuxonError,month:s,day:LuxonError,weekday:s,hour:LuxonError,minute:LuxonError},DATETIME_FULL={year:LuxonError,month:l,day:LuxonError,hour:LuxonError,minute:LuxonError,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:LuxonError,month:l,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:s},DATETIME_HUGE={year:LuxonError,month:l,day:LuxonError,weekday:l,hour:LuxonError,minute:LuxonError,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:LuxonError,month:l,day:LuxonError,weekday:l,hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:l};function isNumber(o){return"number"==typeof o}function isInteger(o){return"number"==typeof o&&o%1==0}function hasRelative(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function bestBy(arr,by,compare){if(0!==arr.length)return arr.reduce(function(best,next){next=[by(next),next];return best&&compare(best[0],next[0])===best[0]?best:next},null)[1]}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function integerBetween(thing,bottom,top){return isInteger(thing)&&bottom<=thing&&thing<=top}function padStart(input,n){void 0===n&&(n=2);input=input<0?"-"+(""+-input).padStart(n,"0"):(""+input).padStart(n,"0");return input}function parseInteger(string){if(null!=string&&""!==string)return parseInt(string,10)}function parseFloating(string){if(null!=string&&""!==string)return parseFloat(string)}function parseMillis(fraction){if(null!=fraction&&""!==fraction)return fraction=1e3*parseFloat("0."+fraction),Math.floor(fraction)}function roundTo(number,digits,towardZero){void 0===towardZero&&(towardZero=!1);digits=Math.pow(10,digits);return(towardZero?Math.trunc:Math.round)(number*digits)/digits}function isLeapYear(year){return year%4==0&&(year%100!=0||year%400==0)}function daysInYear(year){return isLeapYear(year)?366:365}function daysInMonth(year,month){var n,x=(x=month-1)-(n=12)*Math.floor(x/n)+1;return 2==x?isLeapYear(year+(month-x)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][x-1]}function objToLocalTS(obj){var d=Date.UTC(obj.year,obj.month-1,obj.day,obj.hour,obj.minute,obj.second,obj.millisecond);return obj.year<100&&0<=obj.year&&(d=new Date(d)).setUTCFullYear(d.getUTCFullYear()-1900),+d}function weeksInWeekYear(weekYear){var p1=(weekYear+Math.floor(weekYear/4)-Math.floor(weekYear/100)+Math.floor(weekYear/400))%7,weekYear=weekYear-1,weekYear=(weekYear+Math.floor(weekYear/4)-Math.floor(weekYear/100)+Math.floor(weekYear/400))%7;return 4==p1||3==weekYear?53:52}function untruncateYear(year){return 99<year?year:60<year?1900+year:2e3+year}function parseZoneInfo(ts,offsetFormat,locale,timeZone){void 0===timeZone&&(timeZone=null);var ts=new Date(ts),intlOpts={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"},timeZone=(timeZone&&(intlOpts.timeZone=timeZone),_extends({timeZoneName:offsetFormat},intlOpts)),offsetFormat=new Intl.DateTimeFormat(locale,timeZone).formatToParts(ts).find(function(m){return"timezonename"===m.type.toLowerCase()});return offsetFormat?offsetFormat.value:null}function signedOffset(offHourStr,offMinuteStr){offHourStr=parseInt(offHourStr,10),Number.isNaN(offHourStr)&&(offHourStr=0),offMinuteStr=parseInt(offMinuteStr,10)||0;return 60*offHourStr+(offHourStr<0||Object.is(offHourStr,-0)?-offMinuteStr:offMinuteStr)}function asNumber(value){var numericValue=Number(value);if("boolean"==typeof value||""===value||Number.isNaN(numericValue))throw new InvalidArgumentError("Invalid unit value "+value);return numericValue}function normalizeObject(obj,normalizer){var u,v,normalized={};for(u in obj)!hasOwnProperty(obj,u)||null!=(v=obj[u])&&(normalized[normalizer(u)]=asNumber(v));return normalized}function formatOffset(offset,format){var hours=Math.trunc(Math.abs(offset/60)),minutes=Math.trunc(Math.abs(offset%60)),sign=0<=offset?"+":"-";switch(format){case"short":return sign+padStart(hours,2)+":"+padStart(minutes,2);case"narrow":return sign+hours+(0<minutes?":"+minutes:"");case"techie":return sign+padStart(hours,2)+padStart(minutes,2);default:throw new RangeError("Value format "+format+" is out of range for property format")}}function timeObject(obj){return function(obj,keys){return keys.reduce(function(a,k){return a[k]=obj[k],a},{})}(obj,["hour","minute","second","millisecond"])}var s=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(length){switch(length){case"narrow":return[].concat(monthsNarrow);case"short":return[].concat(monthsShort);case"long":return[].concat(monthsLong);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(length){switch(length){case"narrow":return[].concat(weekdaysNarrow);case"short":return[].concat(weekdaysShort);case"long":return[].concat(weekdaysLong);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(length){switch(length){case"narrow":return[].concat(erasNarrow);case"short":return[].concat(erasShort);case"long":return[].concat(erasLong);default:return null}}function stringifyTokens(splits,tokenToString){for(var s="",_iterator=_createForOfIteratorHelperLoose(splits);!(_step=_iterator()).done;){var _step=_step.value;_step.literal?s+=_step.val:s+=tokenToString(_step.val)}return s}var _macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS},Formatter=function(){function Formatter(locale,formatOpts){this.opts=formatOpts,this.loc=locale,this.systemLoc=null}Formatter.create=function(locale,opts){return new Formatter(locale,opts=void 0===opts?{}:opts)},Formatter.parseFormat=function(fmt){for(var current=null,currentFull="",bracketed=!1,splits=[],i=0;i<fmt.length;i++){var c=fmt.charAt(i);"'"===c?(0<currentFull.length&&splits.push({literal:bracketed,val:currentFull}),current=null,currentFull="",bracketed=!bracketed):bracketed||c===current?currentFull+=c:(0<currentFull.length&&splits.push({literal:!1,val:currentFull}),current=currentFull=c)}return 0<currentFull.length&&splits.push({literal:bracketed,val:currentFull}),splits},Formatter.macroTokenToFormatOpts=function(token){return _macroTokenToFormatOpts[token]};var _proto=Formatter.prototype;return _proto.formatWithSystemDefault=function(dt,opts){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(dt,_extends({},this.opts,opts)).format()},_proto.formatDateTime=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).format()},_proto.formatDateTimeParts=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).formatToParts()},_proto.resolvedOptions=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).resolvedOptions()},_proto.num=function(n,p){var opts;return void 0===p&&(p=0),this.opts.forceSimple?padStart(n,p):(opts=_extends({},this.opts),0<p&&(opts.padTo=p),this.loc.numberFormatter(opts).format(n))},_proto.formatDateTimeFromString=function(dt,fmt){var _this=this,knownEnglish="en"===this.loc.listingMode(),useDateTimeFormatter=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,string=function(opts,extract){return _this.loc.extract(dt,opts,extract)},formatOffset=function(opts){return dt.isOffsetFixed&&0===dt.offset&&opts.allowZ?"Z":dt.isValid?dt.zone.formatOffset(dt.ts,opts.format):""},meridiem=function(){return knownEnglish?function(dt){return meridiems[dt.hour<12?0:1]}(dt):string({hour:"numeric",hourCycle:"h12"},"dayperiod")},month=function(length,standalone){return knownEnglish?function(dt,length){return months(length)[dt.month-1]}(dt,length):string(standalone?{month:length}:{month:length,day:"numeric"},"month")},weekday=function(length,standalone){return knownEnglish?function(dt,length){return weekdays(length)[dt.weekday-1]}(dt,length):string(standalone?{weekday:length}:{weekday:length,month:"long",day:"numeric"},"weekday")},maybeMacro=function(token){var formatOpts=Formatter.macroTokenToFormatOpts(token);return formatOpts?_this.formatWithSystemDefault(dt,formatOpts):token},era=function(length){return knownEnglish?function(dt,length){return eras(length)[dt.year<0?0:1]}(dt,length):string({era:length},"era")};return stringifyTokens(Formatter.parseFormat(fmt),function(token){switch(token){case"S":return _this.num(dt.millisecond);case"u":case"SSS":return _this.num(dt.millisecond,3);case"s":return _this.num(dt.second);case"ss":return _this.num(dt.second,2);case"uu":return _this.num(Math.floor(dt.millisecond/10),2);case"uuu":return _this.num(Math.floor(dt.millisecond/100));case"m":return _this.num(dt.minute);case"mm":return _this.num(dt.minute,2);case"h":return _this.num(dt.hour%12==0?12:dt.hour%12);case"hh":return _this.num(dt.hour%12==0?12:dt.hour%12,2);case"H":return _this.num(dt.hour);case"HH":return _this.num(dt.hour,2);case"Z":return formatOffset({format:"narrow",allowZ:_this.opts.allowZ});case"ZZ":return formatOffset({format:"short",allowZ:_this.opts.allowZ});case"ZZZ":return formatOffset({format:"techie",allowZ:_this.opts.allowZ});case"ZZZZ":return dt.zone.offsetName(dt.ts,{format:"short",locale:_this.loc.locale});case"ZZZZZ":return dt.zone.offsetName(dt.ts,{format:"long",locale:_this.loc.locale});case"z":return dt.zoneName;case"a":return meridiem();case"d":return useDateTimeFormatter?string({day:"numeric"},"day"):_this.num(dt.day);case"dd":return useDateTimeFormatter?string({day:"2-digit"},"day"):_this.num(dt.day,2);case"c":return _this.num(dt.weekday);case"ccc":return weekday("short",!0);case"cccc":return weekday("long",!0);case"ccccc":return weekday("narrow",!0);case"E":return _this.num(dt.weekday);case"EEE":return weekday("short",!1);case"EEEE":return weekday("long",!1);case"EEEEE":return weekday("narrow",!1);case"L":return useDateTimeFormatter?string({month:"numeric",day:"numeric"},"month"):_this.num(dt.month);case"LL":return useDateTimeFormatter?string({month:"2-digit",day:"numeric"},"month"):_this.num(dt.month,2);case"LLL":return month("short",!0);case"LLLL":return month("long",!0);case"LLLLL":return month("narrow",!0);case"M":return useDateTimeFormatter?string({month:"numeric"},"month"):_this.num(dt.month);case"MM":return useDateTimeFormatter?string({month:"2-digit"},"month"):_this.num(dt.month,2);case"MMM":return month("short",!1);case"MMMM":return month("long",!1);case"MMMMM":return month("narrow",!1);case"y":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year);case"yy":return useDateTimeFormatter?string({year:"2-digit"},"year"):_this.num(dt.year.toString().slice(-2),2);case"yyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year,4);case"yyyyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return _this.num(dt.weekYear.toString().slice(-2),2);case"kkkk":return _this.num(dt.weekYear,4);case"W":return _this.num(dt.weekNumber);case"WW":return _this.num(dt.weekNumber,2);case"o":return _this.num(dt.ordinal);case"ooo":return _this.num(dt.ordinal,3);case"q":return _this.num(dt.quarter);case"qq":return _this.num(dt.quarter,2);case"X":return _this.num(Math.floor(dt.ts/1e3));case"x":return _this.num(dt.ts);default:return maybeMacro(token)}})},_proto.formatDurationFromString=function(dur,fmt){var lildur,_this2=this,tokenToField=function(token){switch(token[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},fmt=Formatter.parseFormat(fmt),realTokens=fmt.reduce(function(found,_ref){var literal=_ref.literal,_ref=_ref.val;return literal?found:found.concat(_ref)},[]),dur=dur.shiftTo.apply(dur,realTokens.map(tokenToField).filter(function(t){return t}));return stringifyTokens(fmt,(lildur=dur,function(token){var mapped=tokenToField(token);return mapped?_this2.num(lildur.get(mapped),token.length):token}))},Formatter}(),Invalid=function(){function Invalid(reason,explanation){this.reason=reason,this.explanation=explanation}return Invalid.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},Invalid}(),Zone=function(){function Zone(){}var _proto=Zone.prototype;return _proto.offsetName=function(ts,opts){throw new ZoneIsAbstractError},_proto.formatOffset=function(ts,format){throw new ZoneIsAbstractError},_proto.offset=function(ts){throw new ZoneIsAbstractError},_proto.equals=function(otherZone){throw new ZoneIsAbstractError},_createClass(Zone,[{key:"type",get:function(){throw new ZoneIsAbstractError}},{key:"name",get:function(){throw new ZoneIsAbstractError}},{key:"ianaName",get:function(){return this.name}},{key:"isUniversal",get:function(){throw new ZoneIsAbstractError}},{key:"isValid",get:function(){throw new ZoneIsAbstractError}}]),Zone}(),singleton$1=null,SystemZone=function(_Zone){function SystemZone(){return _Zone.apply(this,arguments)||this}_inheritsLoose(SystemZone,_Zone);var _proto=SystemZone.prototype;return _proto.offsetName=function(ts,_ref){return parseZoneInfo(ts,_ref.format,_ref.locale)},_proto.formatOffset=function(ts,format){return formatOffset(this.offset(ts),format)},_proto.offset=function(ts){return-new Date(ts).getTimezoneOffset()},_proto.equals=function(otherZone){return"system"===otherZone.type},_createClass(SystemZone,[{key:"type",get:function(){return"system"}},{key:"name",get:function(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return singleton$1=null===singleton$1?new SystemZone:singleton$1}}]),SystemZone}(Zone),dtfCache={};var typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};var ianaZoneCache={},IANAZone=function(_Zone){function IANAZone(name){var _this=_Zone.call(this)||this;return _this.zoneName=name,_this.valid=IANAZone.isValidZone(name),_this}_inheritsLoose(IANAZone,_Zone),IANAZone.create=function(name){return ianaZoneCache[name]||(ianaZoneCache[name]=new IANAZone(name)),ianaZoneCache[name]},IANAZone.resetCache=function(){ianaZoneCache={},dtfCache={}},IANAZone.isValidSpecifier=function(s){return this.isValidZone(s)},IANAZone.isValidZone=function(zone){if(!zone)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:zone}).format(),!0}catch(e){return!1}};var _proto=IANAZone.prototype;return _proto.offsetName=function(ts,_ref){return parseZoneInfo(ts,_ref.format,_ref.locale,this.name)},_proto.formatOffset=function(ts,format){return formatOffset(this.offset(ts),format)},_proto.offset=function(ts){var year,month,day,adOrBc,minute,zone,hour,over,ts=new Date(ts);return isNaN(ts)?NaN:(zone=this.name,dtfCache[zone]||(dtfCache[zone]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:zone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),year=(zone=((zone=dtfCache[zone]).formatToParts?function(dtf,date){for(var formatted=dtf.formatToParts(date),filled=[],i=0;i<formatted.length;i++){var _formatted$i=formatted[i],type=_formatted$i.type,_formatted$i=_formatted$i.value,pos=typeToPos[type];"era"===type?filled[pos]=_formatted$i:void 0!==pos&&(filled[pos]=parseInt(_formatted$i,10))}return filled}:function(dtf,date){var dtf=dtf.format(date).replace(/\u200E/g,""),dtf=(date=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(dtf))[1],fDay=date[2];return[date[3],dtf,fDay,date[4],date[5],date[6],date[7]]})(zone,ts))[0],month=zone[1],day=zone[2],adOrBc=zone[3],hour=zone[4],minute=zone[5],zone=zone[6],hour=24===hour?0:hour,over=(ts=+ts)%1e3,(objToLocalTS({year:year="BC"===adOrBc?1-Math.abs(year):year,month:month,day:day,hour:hour,minute:minute,second:zone,millisecond:0})-(ts-=0<=over?over:1e3+over))/6e4)},_proto.equals=function(otherZone){return"iana"===otherZone.type&&otherZone.name===this.name},_createClass(IANAZone,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),IANAZone}(Zone),singleton=null,FixedOffsetZone=function(_Zone){function FixedOffsetZone(offset){var _this=_Zone.call(this)||this;return _this.fixed=offset,_this}_inheritsLoose(FixedOffsetZone,_Zone),FixedOffsetZone.instance=function(offset){return 0===offset?FixedOffsetZone.utcInstance:new FixedOffsetZone(offset)},FixedOffsetZone.parseSpecifier=function(s){if(s){s=s.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(s)return new FixedOffsetZone(signedOffset(s[1],s[2]))}return null};var _proto=FixedOffsetZone.prototype;return _proto.offsetName=function(){return this.name},_proto.formatOffset=function(ts,format){return formatOffset(this.fixed,format)},_proto.offset=function(){return this.fixed},_proto.equals=function(otherZone){return"fixed"===otherZone.type&&otherZone.fixed===this.fixed},_createClass(FixedOffsetZone,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+formatOffset(this.fixed,"narrow")}},{key:"ianaName",get:function(){return 0===this.fixed?"Etc/UTC":"Etc/GMT"+formatOffset(-this.fixed,"narrow")}},{key:"isUniversal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}],[{key:"utcInstance",get:function(){return singleton=null===singleton?new FixedOffsetZone(0):singleton}}]),FixedOffsetZone}(Zone),InvalidZone=function(_Zone){function InvalidZone(zoneName){var _this=_Zone.call(this)||this;return _this.zoneName=zoneName,_this}_inheritsLoose(InvalidZone,_Zone);var _proto=InvalidZone.prototype;return _proto.offsetName=function(){return null},_proto.formatOffset=function(){return""},_proto.offset=function(){return NaN},_proto.equals=function(){return!1},_createClass(InvalidZone,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),InvalidZone}(Zone);function normalizeZone(input,defaultZone){var lowered;return null==input?defaultZone:input instanceof Zone?input:"string"==typeof input?"default"===(lowered=input.toLowerCase())?defaultZone:"local"===lowered||"system"===lowered?SystemZone.instance:"utc"===lowered||"gmt"===lowered?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(lowered)||IANAZone.create(input):isNumber(input)?FixedOffsetZone.instance(input):"object"==typeof input&&input.offset&&"number"==typeof input.offset?input:new InvalidZone(input)}var throwOnInvalid,now=function(){return Date.now()},defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,Settings=function(){function Settings(){}return Settings.resetCaches=function(){Locale.resetCache(),IANAZone.resetCache()},_createClass(Settings,null,[{key:"now",get:function(){return now},set:function(n){now=n}},{key:"defaultZone",get:function(){return normalizeZone(defaultZone,SystemZone.instance)},set:function(zone){defaultZone=zone}},{key:"defaultLocale",get:function(){return defaultLocale},set:function(locale){defaultLocale=locale}},{key:"defaultNumberingSystem",get:function(){return defaultNumberingSystem},set:function(numberingSystem){defaultNumberingSystem=numberingSystem}},{key:"defaultOutputCalendar",get:function(){return defaultOutputCalendar},set:function(outputCalendar){defaultOutputCalendar=outputCalendar}},{key:"throwOnInvalid",get:function(){return throwOnInvalid},set:function(t){throwOnInvalid=t}}]),Settings}(),_excluded=["base"],_excluded2=["padTo","floor"],intlLFCache={};var intlDTCache={};function getCachedDTF(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),dtf=intlDTCache[key];return dtf||(dtf=new Intl.DateTimeFormat(locString,opts),intlDTCache[key]=dtf),dtf}var intlNumCache={};var intlRelCache={};var sysLocaleCache=null;function listStuff(loc,length,defaultOK,englishFn,intlFn){loc=loc.listingMode(defaultOK);return"error"===loc?null:("en"===loc?englishFn:intlFn)(length)}var PolyNumberFormatter=function(){function PolyNumberFormatter(intl,forceSimple,opts){this.padTo=opts.padTo||0,this.floor=opts.floor||!1,opts.padTo,opts.floor;var otherOpts=_objectWithoutPropertiesLoose(opts,_excluded2);(!forceSimple||0<Object.keys(otherOpts).length)&&(forceSimple=_extends({useGrouping:!1},opts),0<opts.padTo&&(forceSimple.minimumIntegerDigits=opts.padTo),this.inf=function(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),inf=intlNumCache[key];return inf||(inf=new Intl.NumberFormat(locString,opts),intlNumCache[key]=inf),inf}(intl,forceSimple))}return PolyNumberFormatter.prototype.format=function(i){var fixed;return this.inf?(fixed=this.floor?Math.floor(i):i,this.inf.format(fixed)):padStart(this.floor?Math.floor(i):roundTo(i,3),this.padTo)},PolyNumberFormatter}(),PolyDateFormatter=function(){function PolyDateFormatter(dt,intl,opts){this.opts=opts,dt.zone.isUniversal?(gmtOffset=0<=(gmtOffset=dt.offset/60*-1)?"Etc/GMT+"+gmtOffset:"Etc/GMT"+gmtOffset,0!==dt.offset&&IANAZone.create(gmtOffset).valid?(z=gmtOffset,this.dt=dt):(z="UTC",opts.timeZoneName?this.dt=dt:this.dt=0===dt.offset?dt:DateTime.fromMillis(dt.ts+60*dt.offset*1e3))):"system"===dt.zone.type?this.dt=dt:z=(this.dt=dt).zone.name;var z,gmtOffset=_extends({},this.opts);z&&(gmtOffset.timeZone=z),this.dtf=getCachedDTF(intl,gmtOffset)}var _proto2=PolyDateFormatter.prototype;return _proto2.format=function(){return this.dtf.format(this.dt.toJSDate())},_proto2.formatToParts=function(){return this.dtf.formatToParts(this.dt.toJSDate())},_proto2.resolvedOptions=function(){return this.dtf.resolvedOptions()},PolyDateFormatter}(),PolyRelFormatter=function(){function PolyRelFormatter(intl,isEnglish,opts){this.opts=_extends({style:"long"},opts),!isEnglish&&hasRelative()&&(this.rtf=function(locString,opts){(_opts=opts=void 0===opts?{}:opts).base;var _opts=_objectWithoutPropertiesLoose(_opts=opts,_excluded),_opts=JSON.stringify([locString,_opts]),inf=intlRelCache[_opts];return inf||(inf=new Intl.RelativeTimeFormat(locString,opts),intlRelCache[_opts]=inf),inf}(intl,opts))}var _proto3=PolyRelFormatter.prototype;return _proto3.format=function(count,unit){return this.rtf?this.rtf.format(count,unit):function(unit,count,numeric,narrow){void 0===numeric&&(numeric="always"),void 0===narrow&&(narrow=!1);var units={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},lastable=-1===["hours","minutes","seconds"].indexOf(unit);if("auto"===numeric&&lastable){var isDay="days"===unit;switch(count){case 1:return isDay?"tomorrow":"next "+units[unit][0];case-1:return isDay?"yesterday":"last "+units[unit][0];case 0:return isDay?"today":"this "+units[unit][0]}}var numeric=Object.is(count,-0)||count<0,count=1===(lastable=Math.abs(count)),lilUnits=units[unit],narrow=narrow?!count&&lilUnits[2]||lilUnits[1]:count?units[unit][0]:unit;return numeric?lastable+" "+narrow+" ago":"in "+lastable+" "+narrow}(unit,count,this.opts.numeric,"long"!==this.opts.style)},_proto3.formatToParts=function(count,unit){return this.rtf?this.rtf.formatToParts(count,unit):[]},PolyRelFormatter}(),Locale=function(){function Locale(locale,numbering,outputCalendar,specifiedLocale){var locale=function(localeStr){if(-1===(uIndex=localeStr.indexOf("-u-")))return[localeStr];var options,uIndex=localeStr.substring(0,uIndex);try{options=getCachedDTF(localeStr).resolvedOptions()}catch(e){options=getCachedDTF(uIndex).resolvedOptions()}return[uIndex,(localeStr=options).numberingSystem,localeStr.calendar]}(locale),parsedLocale=locale[0],parsedNumberingSystem=locale[1],locale=locale[2];this.locale=parsedLocale,this.numberingSystem=numbering||parsedNumberingSystem||null,this.outputCalendar=outputCalendar||locale||null,this.intl=function(localeStr,numberingSystem,outputCalendar){return(outputCalendar||numberingSystem)&&(localeStr+="-u",outputCalendar&&(localeStr+="-ca-"+outputCalendar),numberingSystem&&(localeStr+="-nu-"+numberingSystem)),localeStr}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=specifiedLocale,this.fastNumbersCached=null}Locale.fromOpts=function(opts){return Locale.create(opts.locale,opts.numberingSystem,opts.outputCalendar,opts.defaultToEN)},Locale.create=function(locale,numberingSystem,outputCalendar,defaultToEN){void 0===defaultToEN&&(defaultToEN=!1);locale=locale||Settings.defaultLocale;return new Locale(locale||(defaultToEN?"en-US":sysLocaleCache=sysLocaleCache||(new Intl.DateTimeFormat).resolvedOptions().locale),numberingSystem||Settings.defaultNumberingSystem,outputCalendar||Settings.defaultOutputCalendar,locale)},Locale.resetCache=function(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}},Locale.fromObject=function(_temp){var _temp=void 0===_temp?{}:_temp,locale=_temp.locale,numberingSystem=_temp.numberingSystem,_temp=_temp.outputCalendar;return Locale.create(locale,numberingSystem,_temp)};var _proto4=Locale.prototype;return _proto4.listingMode=function(){var isActuallyEn=this.isEnglish(),hasNoWeirdness=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return isActuallyEn&&hasNoWeirdness?"en":"intl"},_proto4.clone=function(alts){return alts&&0!==Object.getOwnPropertyNames(alts).length?Locale.create(alts.locale||this.specifiedLocale,alts.numberingSystem||this.numberingSystem,alts.outputCalendar||this.outputCalendar,alts.defaultToEN||!1):this},_proto4.redefaultToEN=function(alts){return this.clone(_extends({},alts=void 0===alts?{}:alts,{defaultToEN:!0}))},_proto4.redefaultToSystem=function(alts){return this.clone(_extends({},alts=void 0===alts?{}:alts,{defaultToEN:!1}))},_proto4.months=function(length,format,defaultOK){var _this=this;return void 0===format&&(format=!1),listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,months,function(){var intl=format?{month:length,day:"numeric"}:{month:length},formatStr=format?"format":"standalone";return _this.monthsCache[formatStr][length]||(_this.monthsCache[formatStr][length]=function(f){for(var ms=[],i=1;i<=12;i++){var dt=DateTime.utc(2016,i,1);ms.push(f(dt))}return ms}(function(dt){return _this.extract(dt,intl,"month")})),_this.monthsCache[formatStr][length]})},_proto4.weekdays=function(length,format,defaultOK){var _this2=this;return void 0===format&&(format=!1),listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,weekdays,function(){var intl=format?{weekday:length,year:"numeric",month:"long",day:"numeric"}:{weekday:length},formatStr=format?"format":"standalone";return _this2.weekdaysCache[formatStr][length]||(_this2.weekdaysCache[formatStr][length]=function(f){for(var ms=[],i=1;i<=7;i++){var dt=DateTime.utc(2016,11,13+i);ms.push(f(dt))}return ms}(function(dt){return _this2.extract(dt,intl,"weekday")})),_this2.weekdaysCache[formatStr][length]})},_proto4.meridiems=function(defaultOK){var _this3=this;return listStuff(this,void 0,defaultOK=void 0===defaultOK?!0:defaultOK,function(){return meridiems},function(){var intl;return _this3.meridiemCache||(intl={hour:"numeric",hourCycle:"h12"},_this3.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(function(dt){return _this3.extract(dt,intl,"dayperiod")})),_this3.meridiemCache})},_proto4.eras=function(length,defaultOK){var _this4=this;return listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,eras,function(){var intl={era:length};return _this4.eraCache[length]||(_this4.eraCache[length]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(function(dt){return _this4.extract(dt,intl,"era")})),_this4.eraCache[length]})},_proto4.extract=function(dt,intlOpts,field){dt=this.dtFormatter(dt,intlOpts).formatToParts().find(function(m){return m.type.toLowerCase()===field});return dt?dt.value:null},_proto4.numberFormatter=function(opts){return new PolyNumberFormatter(this.intl,(opts=void 0===opts?{}:opts).forceSimple||this.fastNumbers,opts)},_proto4.dtFormatter=function(dt,intlOpts){return new PolyDateFormatter(dt,this.intl,intlOpts=void 0===intlOpts?{}:intlOpts)},_proto4.relFormatter=function(opts){return void 0===opts&&(opts={}),new PolyRelFormatter(this.intl,this.isEnglish(),opts)},_proto4.listFormatter=function(opts){return function(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),dtf=intlLFCache[key];return dtf||(dtf=new Intl.ListFormat(locString,opts),intlLFCache[key]=dtf),dtf}(this.intl,opts=void 0===opts?{}:opts)},_proto4.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},_proto4.equals=function(other){return this.locale===other.locale&&this.numberingSystem===other.numberingSystem&&this.outputCalendar===other.outputCalendar},_createClass(Locale,[{key:"fastNumbers",get:function(){var loc;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(loc=this).numberingSystem||"latn"===loc.numberingSystem)&&("latn"===loc.numberingSystem||!loc.locale||loc.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(loc.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),Locale}();function combineRegexes(){for(var _len=arguments.length,regexes=new Array(_len),_key=0;_key<_len;_key++)regexes[_key]=arguments[_key];var full=regexes.reduce(function(f,r){return f+r.source},"");return RegExp("^"+full+"$")}function combineExtractors(){for(var _len2=arguments.length,extractors=new Array(_len2),_key2=0;_key2<_len2;_key2++)extractors[_key2]=arguments[_key2];return function(m){return extractors.reduce(function(_ref,ex){var mergedVals=_ref[0],mergedZone=_ref[1],_ref=_ref[2],ex=ex(m,_ref),_ref=ex[0],zone=ex[1],ex=ex[2];return[_extends({},mergedVals,_ref),zone||mergedZone,ex]},[{},null,1]).slice(0,2)}}function parse(s){if(null!=s){for(var _len3=arguments.length,patterns=new Array(1<_len3?_len3-1:0),_key3=1;_key3<_len3;_key3++)patterns[_key3-1]=arguments[_key3];for(var _i=0,_patterns=patterns;_i<_patterns.length;_i++){var _patterns$_i=_patterns[_i],regex=_patterns$_i[0],_patterns$_i=_patterns$_i[1],regex=regex.exec(s);if(regex)return _patterns$_i(regex)}}return[null,null]}function simpleParse(){for(var _len4=arguments.length,keys=new Array(_len4),_key4=0;_key4<_len4;_key4++)keys[_key4]=arguments[_key4];return function(match,cursor){for(var ret={},i=0;i<keys.length;i++)ret[keys[i]]=parseInteger(match[cursor+i]);return[ret,null,cursor+i]}}var LuxonError=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,l=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(l.source+("(?:"+LuxonError.source+"?(?:\\[("+s.source+")\\])?)?")),isoTimeExtensionRegex=RegExp("(?:T"+isoTimeRegex.source+")?"),extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),LuxonError=RegExp(l.source+" ?(?:"+LuxonError.source+"|("+s.source+"))?"),s=RegExp("(?: "+LuxonError.source+")?");function int(match,pos,fallback){match=match[pos];return void 0===match?fallback:parseInteger(match)}function extractISOTime(match,cursor){return[{hours:int(match,cursor,0),minutes:int(match,cursor+1,0),seconds:int(match,cursor+2,0),milliseconds:parseMillis(match[cursor+3])},null,cursor+4]}function extractISOOffset(match,cursor){var local=!match[cursor]&&!match[cursor+1],match=signedOffset(match[cursor+1],match[cursor+2]);return[{},local?null:FixedOffsetZone.instance(match),cursor+3]}function extractIANAZone(match,cursor){return[{},match[cursor]?IANAZone.create(match[cursor]):null,cursor+1]}var isoTimeOnly=RegExp("^T?"+l.source+"$"),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(match){function maybeNegate(num,force){return void 0===force&&(force=!1),void 0!==num&&(force||num&&hasNegativePrefix)?-num:num}var s=match[0],yearStr=match[1],monthStr=match[2],weekStr=match[3],dayStr=match[4],hourStr=match[5],minuteStr=match[6],secondStr=match[7],match=match[8],hasNegativePrefix="-"===s[0],s=secondStr&&"-"===secondStr[0];return[{years:maybeNegate(parseFloating(yearStr)),months:maybeNegate(parseFloating(monthStr)),weeks:maybeNegate(parseFloating(weekStr)),days:maybeNegate(parseFloating(dayStr)),hours:maybeNegate(parseFloating(hourStr)),minutes:maybeNegate(parseFloating(minuteStr)),seconds:maybeNegate(parseFloating(secondStr),"-0"===secondStr),milliseconds:maybeNegate(parseMillis(match),s)}]}var obsOffsets={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){yearStr={year:2===yearStr.length?untruncateYear(parseInteger(yearStr)):parseInteger(yearStr),month:monthsShort.indexOf(monthStr)+1,day:parseInteger(dayStr),hour:parseInteger(hourStr),minute:parseInteger(minuteStr)};return secondStr&&(yearStr.second=parseInteger(secondStr)),weekdayStr&&(yearStr.weekday=3<weekdayStr.length?weekdaysLong.indexOf(weekdayStr)+1:weekdaysShort.indexOf(weekdayStr)+1),yearStr}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(match){var weekdayStr=match[1],dayStr=match[2],monthStr=match[3],yearStr=match[4],hourStr=match[5],minuteStr=match[6],secondStr=match[7],obsOffset=match[8],milOffset=match[9],offHourStr=match[10],match=match[11],weekdayStr=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),yearStr=obsOffset?obsOffsets[obsOffset]:milOffset?0:signedOffset(offHourStr,match);return[weekdayStr,new FixedOffsetZone(yearStr)]}var rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(match){var weekdayStr=match[1],dayStr=match[2],monthStr=match[3];return[fromStrings(weekdayStr,match[4],monthStr,dayStr,match[5],match[6],match[7]),FixedOffsetZone.utcInstance]}function extractASCII(match){var weekdayStr=match[1],monthStr=match[2],dayStr=match[3],hourStr=match[4],minuteStr=match[5],secondStr=match[6];return[fromStrings(weekdayStr,match[7],monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}var isoYmdWithTimeExtensionRegex=combineRegexes(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(/(\d{4})-?(\d{3})/,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(function(match,cursor){return[{year:int(match,cursor),month:int(match,cursor+1,1),day:int(match,cursor+2,1)},null,cursor+3]},extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);var extractISOTimeOnly=combineExtractors(extractISOTime);var sqlYmdWithTimeExtensionRegex=combineRegexes(/(\d{4})-(\d\d)-(\d\d)/,s),sqlTimeCombinedRegex=combineRegexes(LuxonError),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);var l={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},casualMatrix=_extends({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},l),accurateMatrix=_extends({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},l),orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$1(dur,alts,clear){clear={values:(clear=void 0===clear?!1:clear)?alts.values:_extends({},dur.values,alts.values||{}),loc:dur.loc.clone(alts.loc),conversionAccuracy:alts.conversionAccuracy||dur.conversionAccuracy,matrix:alts.matrix||dur.matrix};return new Duration(clear)}function convert(matrix,fromMap,fromUnit,toMap,toUnit){var matrix=matrix[toUnit][fromUnit],raw=fromMap[fromUnit]/matrix,n=!(Math.sign(raw)===Math.sign(toMap[toUnit]))&&0!==toMap[toUnit]&&Math.abs(raw)<=1?(n=raw)<0?Math.floor(n):Math.ceil(n):Math.trunc(raw);toMap[toUnit]+=n,fromMap[fromUnit]-=n*matrix}var Duration=function(){function Duration(config){var accurate="longterm"===config.conversionAccuracy||!1,matrix=accurate?accurateMatrix:casualMatrix;config.matrix&&(matrix=config.matrix),this.values=config.values,this.loc=config.loc||Locale.create(),this.conversionAccuracy=accurate?"longterm":"casual",this.invalid=config.invalid||null,this.matrix=matrix,this.isLuxonDuration=!0}Duration.fromMillis=function(count,opts){return Duration.fromObject({milliseconds:count},opts)},Duration.fromObject=function(obj,opts){if(void 0===opts&&(opts={}),null==obj||"object"!=typeof obj)throw new InvalidArgumentError("Duration.fromObject: argument expected to be an object, got "+(null===obj?"null":typeof obj));return new Duration({values:normalizeObject(obj,Duration.normalizeUnit),loc:Locale.fromObject(opts),conversionAccuracy:opts.conversionAccuracy,matrix:opts.matrix})},Duration.fromDurationLike=function(durationLike){if(isNumber(durationLike))return Duration.fromMillis(durationLike);if(Duration.isDuration(durationLike))return durationLike;if("object"==typeof durationLike)return Duration.fromObject(durationLike);throw new InvalidArgumentError("Unknown duration argument "+durationLike+" of type "+typeof durationLike)},Duration.fromISO=function(text,opts){var parsed=parse(text,[isoDuration,extractISODuration])[0];return parsed?Duration.fromObject(parsed,opts):Duration.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Duration.fromISOTime=function(text,opts){var parsed=parse(text,[isoTimeOnly,extractISOTimeOnly])[0];return parsed?Duration.fromObject(parsed,opts):Duration.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Duration.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDurationError(reason);return new Duration({invalid:reason})},Duration.normalizeUnit=function(unit){var normalized={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[unit&&unit.toLowerCase()];if(normalized)return normalized;throw new InvalidUnitError(unit)},Duration.isDuration=function(o){return o&&o.isLuxonDuration||!1};var _proto=Duration.prototype;return _proto.toFormat=function(fmt,opts){opts=_extends({},opts=void 0===opts?{}:opts,{floor:!1!==opts.round&&!1!==opts.floor});return this.isValid?Formatter.create(this.loc,opts).formatDurationFromString(this,fmt):"Invalid Duration"},_proto.toHuman=function(opts){var _this=this,l=(void 0===opts&&(opts={}),orderedUnits$1.map(function(unit){var val=_this.values[unit];return void 0===val?null:_this.loc.numberFormatter(_extends({style:"unit",unitDisplay:"long"},opts,{unit:unit.slice(0,-1)})).format(val)}).filter(function(n){return n}));return this.loc.listFormatter(_extends({type:"conjunction",style:opts.listStyle||"narrow"},opts)).format(l)},_proto.toObject=function(){return this.isValid?_extends({},this.values):{}},_proto.toISO=function(){var s;return this.isValid?(s="P",0!==this.years&&(s+=this.years+"Y"),0===this.months&&0===this.quarters||(s+=this.months+3*this.quarters+"M"),0!==this.weeks&&(s+=this.weeks+"W"),0!==this.days&&(s+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(s+="T"),0!==this.hours&&(s+=this.hours+"H"),0!==this.minutes&&(s+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(s+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===s&&(s+="T0S"),s):null},_proto.toISOTime=function(opts){if(void 0===opts&&(opts={}),!this.isValid)return null;var millis=this.toMillis();if(millis<0||864e5<=millis)return null;opts=_extends({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},opts);var millis=this.shiftTo("hours","minutes","seconds","milliseconds"),fmt="basic"===opts.format?"hhmm":"hh:mm",millis=(opts.suppressSeconds&&0===millis.seconds&&0===millis.milliseconds||(fmt+="basic"===opts.format?"ss":":ss",opts.suppressMilliseconds&&0===millis.milliseconds||(fmt+=".SSS")),millis.toFormat(fmt));return millis=opts.includePrefix?"T"+millis:millis},_proto.toJSON=function(){return this.toISO()},_proto.toString=function(){return this.toISO()},_proto.toMillis=function(){return this.as("milliseconds")},_proto.valueOf=function(){return this.toMillis()},_proto.plus=function(duration){if(!this.isValid)return this;for(var dur=Duration.fromDurationLike(duration),result={},_iterator=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step=_iterator()).done;){var _step=_step.value;(hasOwnProperty(dur.values,_step)||hasOwnProperty(this.values,_step))&&(result[_step]=dur.get(_step)+this.get(_step))}return clone$1(this,{values:result},!0)},_proto.minus=function(duration){return this.isValid?(duration=Duration.fromDurationLike(duration),this.plus(duration.negate())):this},_proto.mapUnits=function(fn){if(!this.isValid)return this;for(var result={},_i=0,_Object$keys=Object.keys(this.values);_i<_Object$keys.length;_i++){var k=_Object$keys[_i];result[k]=asNumber(fn(this.values[k],k))}return clone$1(this,{values:result},!0)},_proto.get=function(unit){return this[Duration.normalizeUnit(unit)]},_proto.set=function(values){return this.isValid?clone$1(this,{values:_extends({},this.values,normalizeObject(values,Duration.normalizeUnit))}):this},_proto.reconfigure=function(_temp){var _temp=void 0===_temp?{}:_temp,locale=_temp.locale,numberingSystem=_temp.numberingSystem,conversionAccuracy=_temp.conversionAccuracy,_temp=_temp.matrix,locale=this.loc.clone({locale:locale,numberingSystem:numberingSystem});return clone$1(this,{loc:locale,matrix:_temp,conversionAccuracy:conversionAccuracy})},_proto.as=function(unit){return this.isValid?this.shiftTo(unit).get(unit):NaN},_proto.normalize=function(){var vals;return this.isValid?(vals=this.toObject(),function(matrix,vals){reverseUnits.reduce(function(previous,current){return void 0!==vals[current]?(previous&&convert(matrix,vals,previous,vals,current),current):previous},null)}(this.matrix,vals),clone$1(this,{values:vals},!0)):this},_proto.shiftTo=function(){for(var _len=arguments.length,units=new Array(_len),_key=0;_key<_len;_key++)units[_key]=arguments[_key];if(!this.isValid)return this;if(0===units.length)return this;for(var key,units=units.map(function(u){return Duration.normalizeUnit(u)}),built={},accumulated={},vals=this.toObject(),_iterator2=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step2=_iterator2()).done;){var k=_step2.value;if(0<=units.indexOf(k)){var ak,lastUnit=k,own=0;for(ak in accumulated)own+=this.matrix[ak][k]*accumulated[ak],accumulated[ak]=0;isNumber(vals[k])&&(own+=vals[k]);var down,_step2=Math.trunc(own);for(down in accumulated[k]=(1e3*own-1e3*(built[k]=_step2))/1e3,vals)orderedUnits$1.indexOf(down)>orderedUnits$1.indexOf(k)&&convert(this.matrix,vals,down,built,k)}else isNumber(vals[k])&&(accumulated[k]=vals[k])}for(key in accumulated)0!==accumulated[key]&&(built[lastUnit]+=key===lastUnit?accumulated[key]:accumulated[key]/this.matrix[lastUnit][key]);return clone$1(this,{values:built},!0).normalize()},_proto.negate=function(){if(!this.isValid)return this;for(var negated={},_i2=0,_Object$keys2=Object.keys(this.values);_i2<_Object$keys2.length;_i2++){var k=_Object$keys2[_i2];negated[k]=0===this.values[k]?0:-this.values[k]}return clone$1(this,{values:negated},!0)},_proto.equals=function(other){if(!this.isValid||!other.isValid)return!1;if(!this.loc.equals(other.loc))return!1;for(var v1,_iterator3=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step3=_iterator3()).done;){var _step3=_step3.value;if(v1=this.values[_step3],_step3=other.values[_step3],!(void 0===v1||0===v1?void 0===_step3||0===_step3:v1===_step3))return!1}return!0},_createClass(Duration,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),Duration}(),INVALID$1="Invalid Interval";function validateStartEnd(start,end){return start&&start.isValid?end&&end.isValid?end<start?Interval.invalid("end before start","The end of an interval must be after its start, but you had start="+start.toISO()+" and end="+end.toISO()):null:Interval.invalid("missing or invalid end"):Interval.invalid("missing or invalid start")}var Interval=function(){function Interval(config){this.s=config.start,this.e=config.end,this.invalid=config.invalid||null,this.isLuxonInterval=!0}Interval.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidIntervalError(reason);return new Interval({invalid:reason})},Interval.fromDateTimes=function(start,end){var start=friendlyDateTime(start),end=friendlyDateTime(end),validateError=validateStartEnd(start,end);return null==validateError?new Interval({start:start,end:end}):validateError},Interval.after=function(start,duration){duration=Duration.fromDurationLike(duration),start=friendlyDateTime(start);return Interval.fromDateTimes(start,start.plus(duration))},Interval.before=function(end,duration){duration=Duration.fromDurationLike(duration),end=friendlyDateTime(end);return Interval.fromDateTimes(end.minus(duration),end)},Interval.fromISO=function(text,opts){var start,end,endIsValid,_split=(text||"").split("/",2),s=_split[0],e=_split[1];if(s&&e){try{startIsValid=(start=DateTime.fromISO(s,opts)).isValid}catch(e){startIsValid=!1}try{endIsValid=(end=DateTime.fromISO(e,opts)).isValid}catch(e){endIsValid=!1}if(startIsValid&&endIsValid)return Interval.fromDateTimes(start,end);if(startIsValid){_split=Duration.fromISO(e,opts);if(_split.isValid)return Interval.after(start,_split)}else if(endIsValid){var startIsValid=Duration.fromISO(s,opts);if(startIsValid.isValid)return Interval.before(end,startIsValid)}}return Interval.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Interval.isInterval=function(o){return o&&o.isLuxonInterval||!1};var _proto=Interval.prototype;return _proto.length=function(unit){return void 0===unit&&(unit="milliseconds"),this.isValid?this.toDuration.apply(this,[unit]).get(unit):NaN},_proto.count=function(unit){var start,end;return void 0===unit&&(unit="milliseconds"),this.isValid?(start=this.start.startOf(unit),end=this.end.startOf(unit),Math.floor(end.diff(start,unit).get(unit))+1):NaN},_proto.hasSame=function(unit){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,unit))},_proto.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},_proto.isAfter=function(dateTime){return!!this.isValid&&this.s>dateTime},_proto.isBefore=function(dateTime){return!!this.isValid&&this.e<=dateTime},_proto.contains=function(dateTime){return!!this.isValid&&(this.s<=dateTime&&this.e>dateTime)},_proto.set=function(_temp){var _temp=void 0===_temp?{}:_temp,start=_temp.start,_temp=_temp.end;return this.isValid?Interval.fromDateTimes(start||this.s,_temp||this.e):this},_proto.splitAt=function(){var _this=this;if(!this.isValid)return[];for(var _len=arguments.length,dateTimes=new Array(_len),_key=0;_key<_len;_key++)dateTimes[_key]=arguments[_key];for(var sorted=dateTimes.map(friendlyDateTime).filter(function(d){return _this.contains(d)}).sort(),results=[],s=this.s,i=0;s<this.e;){var added=sorted[i]||this.e,added=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,added)),s=added,i+=1}return results},_proto.splitBy=function(duration){var dur=Duration.fromDurationLike(duration);if(!this.isValid||!dur.isValid||0===dur.as("milliseconds"))return[];for(var s=this.s,idx=1,results=[];s<this.e;){var added=this.start.plus(dur.mapUnits(function(x){return x*idx})),added=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,added)),s=added,idx+=1}return results},_proto.divideEqually=function(numberOfParts){return this.isValid?this.splitBy(this.length()/numberOfParts).slice(0,numberOfParts):[]},_proto.overlaps=function(other){return this.e>other.s&&this.s<other.e},_proto.abutsStart=function(other){return!!this.isValid&&+this.e==+other.s},_proto.abutsEnd=function(other){return!!this.isValid&&+other.e==+this.s},_proto.engulfs=function(other){return!!this.isValid&&(this.s<=other.s&&this.e>=other.e)},_proto.equals=function(other){return!(!this.isValid||!other.isValid)&&(this.s.equals(other.s)&&this.e.equals(other.e))},_proto.intersection=function(other){var s;return this.isValid?(s=(this.s>other.s?this:other).s,(other=(this.e<other.e?this:other).e)<=s?null:Interval.fromDateTimes(s,other)):this},_proto.union=function(other){var s;return this.isValid?(s=(this.s<other.s?this:other).s,other=(this.e>other.e?this:other).e,Interval.fromDateTimes(s,other)):this},Interval.merge=function(intervals){var intervals=intervals.sort(function(a,b){return a.s-b.s}).reduce(function(_ref2,item){var sofar=_ref2[0],_ref2=_ref2[1];return _ref2?_ref2.overlaps(item)||_ref2.abutsStart(item)?[sofar,_ref2.union(item)]:[sofar.concat([_ref2]),item]:[sofar,item]},[[],null]),found=intervals[0],intervals=intervals[1];return intervals&&found.push(intervals),found},Interval.xor=function(intervals){for(var _Array$prototype,start=null,currentCount=0,results=[],intervals=intervals.map(function(i){return[{time:i.s,type:"s"},{time:i.e,type:"e"}]}),_iterator=_createForOfIteratorHelperLoose((_Array$prototype=Array.prototype).concat.apply(_Array$prototype,intervals).sort(function(a,b){return a.time-b.time}));!(_step=_iterator()).done;)var _step=_step.value,start=1===(currentCount+="s"===_step.type?1:-1)?_step.time:(start&&+start!=+_step.time&&results.push(Interval.fromDateTimes(start,_step.time)),null);return Interval.merge(results)},_proto.difference=function(){for(var _this2=this,_len2=arguments.length,intervals=new Array(_len2),_key2=0;_key2<_len2;_key2++)intervals[_key2]=arguments[_key2];return Interval.xor([this].concat(intervals)).map(function(i){return _this2.intersection(i)}).filter(function(i){return i&&!i.isEmpty()})},_proto.toString=function(){return this.isValid?"["+this.s.toISO()+" – "+this.e.toISO()+")":INVALID$1},_proto.toISO=function(opts){return this.isValid?this.s.toISO(opts)+"/"+this.e.toISO(opts):INVALID$1},_proto.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():INVALID$1},_proto.toISOTime=function(opts){return this.isValid?this.s.toISOTime(opts)+"/"+this.e.toISOTime(opts):INVALID$1},_proto.toFormat=function(dateFormat,_temp2){_temp2=(void 0===_temp2?{}:_temp2).separator,_temp2=void 0===_temp2?" – ":_temp2;return this.isValid?""+this.s.toFormat(dateFormat)+_temp2+this.e.toFormat(dateFormat):INVALID$1},_proto.toDuration=function(unit,opts){return this.isValid?this.e.diff(this.s,unit,opts):Duration.invalid(this.invalidReason)},_proto.mapEndpoints=function(mapFn){return Interval.fromDateTimes(mapFn(this.s),mapFn(this.e))},_createClass(Interval,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),Interval}(),Info=function(){function Info(){}return Info.hasDST=function(zone){void 0===zone&&(zone=Settings.defaultZone);var proto=DateTime.now().setZone(zone).set({month:12});return!zone.isUniversal&&proto.offset!==proto.set({month:6}).offset},Info.isValidIANAZone=function(zone){return IANAZone.isValidZone(zone)},Info.normalizeZone=function(input){return normalizeZone(input,Settings.defaultZone)},Info.months=function(length,_temp){void 0===length&&(length="long");var _temp=void 0===_temp?{}:_temp,_ref$locale=_temp.locale,_ref$numberingSystem=_temp.numberingSystem,_ref$locObj=_temp.locObj,_ref$locObj=void 0===_ref$locObj?null:_ref$locObj,_temp=_temp.outputCalendar;return(_ref$locObj||Locale.create(void 0===_ref$locale?null:_ref$locale,void 0===_ref$numberingSystem?null:_ref$numberingSystem,void 0===_temp?"gregory":_temp)).months(length)},Info.monthsFormat=function(length,_temp2){void 0===length&&(length="long");var _temp2=void 0===_temp2?{}:_temp2,_ref2$locale=_temp2.locale,_ref2$numberingSystem=_temp2.numberingSystem,_ref2$locObj=_temp2.locObj,_ref2$locObj=void 0===_ref2$locObj?null:_ref2$locObj,_temp2=_temp2.outputCalendar;return(_ref2$locObj||Locale.create(void 0===_ref2$locale?null:_ref2$locale,void 0===_ref2$numberingSystem?null:_ref2$numberingSystem,void 0===_temp2?"gregory":_temp2)).months(length,!0)},Info.weekdays=function(length,_temp3){void 0===length&&(length="long");var _temp3=void 0===_temp3?{}:_temp3,_ref3$locale=_temp3.locale,_ref3$numberingSystem=_temp3.numberingSystem,_temp3=_temp3.locObj;return((void 0===_temp3?null:_temp3)||Locale.create(void 0===_ref3$locale?null:_ref3$locale,void 0===_ref3$numberingSystem?null:_ref3$numberingSystem,null)).weekdays(length)},Info.weekdaysFormat=function(length,_temp4){void 0===length&&(length="long");var _temp4=void 0===_temp4?{}:_temp4,_ref4$locale=_temp4.locale,_ref4$numberingSystem=_temp4.numberingSystem,_temp4=_temp4.locObj;return((void 0===_temp4?null:_temp4)||Locale.create(void 0===_ref4$locale?null:_ref4$locale,void 0===_ref4$numberingSystem?null:_ref4$numberingSystem,null)).weekdays(length,!0)},Info.meridiems=function(_temp5){_temp5=(void 0===_temp5?{}:_temp5).locale;return Locale.create(void 0===_temp5?null:_temp5).meridiems()},Info.eras=function(length,_temp6){void 0===length&&(length="short");_temp6=(void 0===_temp6?{}:_temp6).locale;return Locale.create(void 0===_temp6?null:_temp6,null,"gregory").eras(length)},Info.features=function(){return{relative:hasRelative()}},Info}();function dayDiff(earlier,later){function utcDayStart(dt){return dt.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()}later=utcDayStart(later)-utcDayStart(earlier);return Math.floor(Duration.fromMillis(later).as("days"))}function _diff(earlier,later,units,opts){var earlier=function(cursor,later,units){for(var results={},_i=0,_differs=[["years",function(a,b){return b.year-a.year}],["quarters",function(a,b){return b.quarter-a.quarter+4*(b.year-a.year)}],["months",function(a,b){return b.month-a.month+12*(b.year-a.year)}],["weeks",function(a,b){a=dayDiff(a,b);return(a-a%7)/7}],["days",dayDiff]];_i<_differs.length;_i++){var lowestOrder,_cursor$plus,highWater,_differs$_i=_differs[_i],unit=_differs$_i[0],_differs$_i=_differs$_i[1];0<=units.indexOf(unit)&&(lowestOrder=unit,_differs$_i=_differs$_i(cursor,later),later<(highWater=cursor.plus(((_cursor$plus={})[unit]=_differs$_i,_cursor$plus)))?(cursor=cursor.plus(((_cursor$plus={})[unit]=_differs$_i-1,_cursor$plus)),--_differs$_i):cursor=highWater,results[unit]=_differs$_i)}return[cursor,results,highWater,lowestOrder]}(earlier,later,units),cursor=earlier[0],results=earlier[1],highWater=earlier[2],earlier=earlier[3],remainingMillis=later-cursor,units=units.filter(function(u){return 0<=["hours","minutes","seconds","milliseconds"].indexOf(u)}),later=(0===units.length&&(highWater=highWater<later?cursor.plus(((later={})[earlier]=1,later)):highWater)!==cursor&&(results[earlier]=(results[earlier]||0)+remainingMillis/(highWater-cursor)),Duration.fromObject(results,opts));return 0<units.length?(earlier=Duration.fromMillis(remainingMillis,opts)).shiftTo.apply(earlier,units).plus(later):later}var numberingSystems={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function digitRegex(_ref,append){_ref=_ref.numberingSystem;return void 0===append&&(append=""),new RegExp(""+numberingSystems[_ref||"latn"]+append)}var MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(regex,post){return void 0===post&&(post=function(i){return i}),{regex:regex,deser:function(_ref){_ref=_ref[0];return post(function(str){var value=parseInt(str,10);if(isNaN(value)){for(var value="",i=0;i<str.length;i++){var code=str.charCodeAt(i);if(-1!==str[i].search(numberingSystems.hanidec))value+=hanidecChars.indexOf(str[i]);else for(var key in numberingSystemsUTF16){var key=numberingSystemsUTF16[key],min=key[0],key=key[1];min<=code&&code<=key&&(value+=code-min)}}return parseInt(value,10)}return value}(_ref))}}}var spaceOrNBSP="[ "+String.fromCharCode(160)+"]",spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(s){return s.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(s){return s.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(strings,startIndex){return null===strings?null:{regex:RegExp(strings.map(fixListRegex).join("|")),deser:function(_ref2){var s=_ref2[0];return strings.findIndex(function(i){return stripInsensitivities(s)===stripInsensitivities(i)})+startIndex}}}function offset(regex,groups){return{regex:regex,deser:function(_ref3){return signedOffset(_ref3[1],_ref3[2])},groups:groups}}function simple(regex){return{regex:regex,deser:function(_ref4){return _ref4[0]}}}function unitForToken(token,loc){function literal(t){return{regex:RegExp(t.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")),deser:function(_ref5){return _ref5[0]},literal:!0}}var one=digitRegex(loc),two=digitRegex(loc,"{2}"),three=digitRegex(loc,"{3}"),four=digitRegex(loc,"{4}"),six=digitRegex(loc,"{6}"),oneOrTwo=digitRegex(loc,"{1,2}"),oneToThree=digitRegex(loc,"{1,3}"),oneToSix=digitRegex(loc,"{1,6}"),oneToNine=digitRegex(loc,"{1,9}"),twoToFour=digitRegex(loc,"{2,4}"),fourToSix=digitRegex(loc,"{4,6}"),unit=function(t){if(token.literal)return literal(t);switch(t.val){case"G":return oneOf(loc.eras("short",!1),0);case"GG":return oneOf(loc.eras("long",!1),0);case"y":return intUnit(oneToSix);case"yy":return intUnit(twoToFour,untruncateYear);case"yyyy":return intUnit(four);case"yyyyy":return intUnit(fourToSix);case"yyyyyy":return intUnit(six);case"M":return intUnit(oneOrTwo);case"MM":return intUnit(two);case"MMM":return oneOf(loc.months("short",!0,!1),1);case"MMMM":return oneOf(loc.months("long",!0,!1),1);case"L":return intUnit(oneOrTwo);case"LL":return intUnit(two);case"LLL":return oneOf(loc.months("short",!1,!1),1);case"LLLL":return oneOf(loc.months("long",!1,!1),1);case"d":return intUnit(oneOrTwo);case"dd":return intUnit(two);case"o":return intUnit(oneToThree);case"ooo":return intUnit(three);case"HH":return intUnit(two);case"H":return intUnit(oneOrTwo);case"hh":return intUnit(two);case"h":return intUnit(oneOrTwo);case"mm":return intUnit(two);case"m":case"q":return intUnit(oneOrTwo);case"qq":return intUnit(two);case"s":return intUnit(oneOrTwo);case"ss":return intUnit(two);case"S":return intUnit(oneToThree);case"SSS":return intUnit(three);case"u":return simple(oneToNine);case"uu":return simple(oneOrTwo);case"uuu":return intUnit(one);case"a":return oneOf(loc.meridiems(),0);case"kkkk":return intUnit(four);case"kk":return intUnit(twoToFour,untruncateYear);case"W":return intUnit(oneOrTwo);case"WW":return intUnit(two);case"E":case"c":return intUnit(one);case"EEE":return oneOf(loc.weekdays("short",!1,!1),1);case"EEEE":return oneOf(loc.weekdays("long",!1,!1),1);case"ccc":return oneOf(loc.weekdays("short",!0,!1),1);case"cccc":return oneOf(loc.weekdays("long",!0,!1),1);case"Z":case"ZZ":return offset(new RegExp("([+-]"+oneOrTwo.source+")(?::("+two.source+"))?"),2);case"ZZZ":return offset(new RegExp("([+-]"+oneOrTwo.source+")("+two.source+")?"),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);default:return literal(t)}}(token)||{invalidReason:MISSING_FTP};return unit.token=token,unit}var partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};var dummyDateTimeCache=null;function expandMacroTokens(tokens,locale){var _Array$prototype;return(_Array$prototype=Array.prototype).concat.apply(_Array$prototype,tokens.map(function(t){return function(token,locale){return token.literal||null==(locale=formatOptsToTokens(Formatter.macroTokenToFormatOpts(token.val),locale))||locale.includes(void 0)?token:locale}(t,locale)}))}function explainFromTokens(locale,input,format){var format=expandMacroTokens(Formatter.parseFormat(format),locale),units=format.map(function(t){return unitForToken(t,locale)}),disqualifyingUnit=units.find(function(t){return t.invalidReason});if(disqualifyingUnit)return{input:input,tokens:format,invalidReason:disqualifyingUnit.invalidReason};var disqualifyingUnit=function(units){return["^"+units.map(function(u){return u.regex}).reduce(function(f,r){return f+"("+r.source+")"},"")+"$",units]}(units),units=disqualifyingUnit[0],disqualifyingUnit=disqualifyingUnit[1],units=RegExp(units,"i"),disqualifyingUnit=function(input,regex,handlers){var matches=input.match(regex);if(matches){var i,h,groups,all={},matchIndex=1;for(i in handlers)hasOwnProperty(handlers,i)&&(groups=(h=handlers[i]).groups?h.groups+1:1,!h.literal&&h.token&&(all[h.token.val[0]]=h.deser(matches.slice(matchIndex,matchIndex+groups))),matchIndex+=groups);return[matches,all]}return[matches,{}]}(input,units,disqualifyingUnit),rawMatches=disqualifyingUnit[0],disqualifyingUnit=disqualifyingUnit[1],_ref6=disqualifyingUnit?function(matches){var specificOffset,zone=null;return void 0!==matches.z&&(zone=IANAZone.create(matches.z)),void 0!==matches.Z&&(zone=zone||new FixedOffsetZone(matches.Z),specificOffset=matches.Z),void 0!==matches.q&&(matches.M=3*(matches.q-1)+1),void 0!==matches.h&&(matches.h<12&&1===matches.a?matches.h+=12:12===matches.h&&0===matches.a&&(matches.h=0)),0===matches.G&&matches.y&&(matches.y=-matches.y),void 0!==matches.u&&(matches.S=parseMillis(matches.u)),[Object.keys(matches).reduce(function(r,k){var f=function(token){switch(token){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(k);return f&&(r[f]=matches[k]),r},{}),zone,specificOffset]}(disqualifyingUnit):[null,null,void 0],result=_ref6[0],zone=_ref6[1],_ref6=_ref6[2];if(hasOwnProperty(disqualifyingUnit,"a")&&hasOwnProperty(disqualifyingUnit,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:input,tokens:format,regex:units,rawMatches:rawMatches,matches:disqualifyingUnit,result:result,zone:zone,specificOffset:_ref6}}function formatOptsToTokens(formatOpts,locale){return formatOpts?Formatter.create(locale,formatOpts).formatDateTimeParts(dummyDateTimeCache=dummyDateTimeCache||DateTime.fromMillis(1555555555555)).map(function(p){return function(part,formatOpts){var type=part.type,part=part.value;return"literal"===type?{literal:!0,val:part}:(part=formatOpts[type],(formatOpts="object"==typeof(formatOpts=partTypeStyleToTokenVal[type])?formatOpts[part]:formatOpts)?{literal:!1,val:formatOpts}:void 0)}(p,formatOpts)}):null}var nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(unit,value){return new Invalid("unit out of range","you specified "+value+" (of type "+typeof value+") as a "+unit+", which is invalid")}function dayOfWeek(year,month,day){month=new Date(Date.UTC(year,month-1,day)),year<100&&0<=year&&month.setUTCFullYear(month.getUTCFullYear()-1900),day=month.getUTCDay();return 0===day?7:day}function computeOrdinal(year,month,day){return day+(isLeapYear(year)?leapLadder:nonLeapLadder)[month-1]}function uncomputeOrdinal(year,ordinal){var year=isLeapYear(year)?leapLadder:nonLeapLadder,month0=year.findIndex(function(i){return i<ordinal});return{month:month0+1,day:ordinal-year[month0]}}function gregorianToWeek(gregObj){var weekYear,year=gregObj.year,month=gregObj.month,day=gregObj.day,ordinal=computeOrdinal(year,month,day),month=dayOfWeek(year,month,day),day=Math.floor((ordinal-month+10)/7);return day<1?day=weeksInWeekYear(weekYear=year-1):day>weeksInWeekYear(year)?(weekYear=year+1,day=1):weekYear=year,_extends({weekYear:weekYear,weekNumber:day,weekday:month},timeObject(gregObj))}function weekToGregorian(weekData){var year,weekYear=weekData.weekYear,weekNumber=weekData.weekNumber,weekday=weekData.weekday,weekdayOfJan4=dayOfWeek(weekYear,1,4),yearInDays=daysInYear(weekYear),weekNumber=7*weekNumber+weekday-weekdayOfJan4-3,weekday=(weekNumber<1?weekNumber+=daysInYear(year=weekYear-1):yearInDays<weekNumber?(year=weekYear+1,weekNumber-=daysInYear(weekYear)):year=weekYear,uncomputeOrdinal(year,weekNumber));return _extends({year:year,month:weekday.month,day:weekday.day},timeObject(weekData))}function gregorianToOrdinal(gregData){var year=gregData.year;return _extends({year:year,ordinal:computeOrdinal(year,gregData.month,gregData.day)},timeObject(gregData))}function ordinalToGregorian(ordinalData){var year=ordinalData.year,_uncomputeOrdinal2=uncomputeOrdinal(year,ordinalData.ordinal);return _extends({year:year,month:_uncomputeOrdinal2.month,day:_uncomputeOrdinal2.day},timeObject(ordinalData))}function hasInvalidGregorianData(obj){var validYear=isInteger(obj.year),validMonth=integerBetween(obj.month,1,12),validDay=integerBetween(obj.day,1,daysInMonth(obj.year,obj.month));return validYear?validMonth?!validDay&&unitOutOfRange("day",obj.day):unitOutOfRange("month",obj.month):unitOutOfRange("year",obj.year)}function hasInvalidTimeData(obj){var hour=obj.hour,minute=obj.minute,second=obj.second,obj=obj.millisecond,validHour=integerBetween(hour,0,23)||24===hour&&0===minute&&0===second&&0===obj,validMinute=integerBetween(minute,0,59),validSecond=integerBetween(second,0,59),validMillisecond=integerBetween(obj,0,999);return validHour?validMinute?validSecond?!validMillisecond&&unitOutOfRange("millisecond",obj):unitOutOfRange("second",second):unitOutOfRange("minute",minute):unitOutOfRange("hour",hour)}var INVALID="Invalid DateTime";function unsupportedZone(zone){return new Invalid("unsupported zone",'the zone "'+zone.name+'" is not supported')}function possiblyCachedWeekData(dt){return null===dt.weekData&&(dt.weekData=gregorianToWeek(dt.c)),dt.weekData}function clone(inst,alts){inst={ts:inst.ts,zone:inst.zone,c:inst.c,o:inst.o,loc:inst.loc,invalid:inst.invalid};return new DateTime(_extends({},inst,alts,{old:inst}))}function fixOffset(localTS,o,tz){var utcGuess=localTS-60*o*1e3,o2=tz.offset(utcGuess);return o===o2?[utcGuess,o]:o2===(tz=tz.offset(utcGuess-=60*(o2-o)*1e3))?[utcGuess,o2]:[localTS-60*Math.min(o2,tz)*1e3,Math.max(o2,tz)]}function tsToObj(ts,offset){ts+=60*offset*1e3;offset=new Date(ts);return{year:offset.getUTCFullYear(),month:offset.getUTCMonth()+1,day:offset.getUTCDate(),hour:offset.getUTCHours(),minute:offset.getUTCMinutes(),second:offset.getUTCSeconds(),millisecond:offset.getUTCMilliseconds()}}function objToTS(obj,offset,zone){return fixOffset(objToLocalTS(obj),offset,zone)}function adjustTime(inst,dur){var oPre=inst.o,year=inst.c.year+Math.trunc(dur.years),month=inst.c.month+Math.trunc(dur.months)+3*Math.trunc(dur.quarters),year=_extends({},inst.c,{year:year,month:month,day:Math.min(inst.c.day,daysInMonth(year,month))+Math.trunc(dur.days)+7*Math.trunc(dur.weeks)}),month=Duration.fromObject({years:dur.years-Math.trunc(dur.years),quarters:dur.quarters-Math.trunc(dur.quarters),months:dur.months-Math.trunc(dur.months),weeks:dur.weeks-Math.trunc(dur.weeks),days:dur.days-Math.trunc(dur.days),hours:dur.hours,minutes:dur.minutes,seconds:dur.seconds,milliseconds:dur.milliseconds}).as("milliseconds"),dur=fixOffset(objToLocalTS(year),oPre,inst.zone),year=dur[0],oPre=dur[1];return 0!==month&&(oPre=inst.zone.offset(year+=month)),{ts:year,o:oPre}}function parseDataToDateTime(parsed,parsedZone,opts,format,text,specificOffset){var setZone=opts.setZone,zone=opts.zone;return parsed&&0!==Object.keys(parsed).length?(parsed=DateTime.fromObject(parsed,_extends({},opts,{zone:parsedZone||zone,specificOffset:specificOffset})),setZone?parsed:parsed.setZone(zone)):DateTime.invalid(new Invalid("unparsable",'the input "'+text+"\" can't be parsed as "+format))}function toTechFormat(dt,format,allowZ){return void 0===allowZ&&(allowZ=!0),dt.isValid?Formatter.create(Locale.create("en-US"),{allowZ:allowZ,forceSimple:!0}).formatDateTimeFromString(dt,format):null}function _toISODate(o,extended){var longFormat=9999<o.c.year||o.c.year<0,c="";return longFormat&&0<=o.c.year&&(c+="+"),c+=padStart(o.c.year,longFormat?6:4),c=extended?(c=(c+="-")+padStart(o.c.month)+"-")+padStart(o.c.day):(c+=padStart(o.c.month))+padStart(o.c.day)}function _toISOTime(o,extended,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone){var c=padStart(o.c.hour);return extended?(c=(c+=":")+padStart(o.c.minute),0===o.c.second&&suppressSeconds||(c+=":")):c+=padStart(o.c.minute),0===o.c.second&&suppressSeconds||(c+=padStart(o.c.second),0===o.c.millisecond&&suppressMilliseconds||(c=(c+=".")+padStart(o.c.millisecond,3))),includeOffset&&(o.isOffsetFixed&&0===o.offset&&!extendedZone?c+="Z":c=o.o<0?(c=(c+="-")+padStart(Math.trunc(-o.o/60))+":")+padStart(Math.trunc(-o.o%60)):(c=(c+="+")+padStart(Math.trunc(o.o/60))+":")+padStart(Math.trunc(o.o%60))),extendedZone&&(c+="["+o.zone.ianaName+"]"),c}var defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(unit){var normalized={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[unit.toLowerCase()];if(normalized)return normalized;throw new InvalidUnitError(unit)}function quickDT(obj,opts){var zone=normalizeZone(opts.zone,Settings.defaultZone),opts=Locale.fromObject(opts),tsNow=Settings.now();if(void 0!==obj.year){for(var _iterator=_createForOfIteratorHelperLoose(orderedUnits);!(_step=_iterator()).done;){var _step=_step.value;void 0===obj[_step]&&(obj[_step]=defaultUnitValues[_step])}var invalid=hasInvalidGregorianData(obj)||hasInvalidTimeData(obj);if(invalid)return DateTime.invalid(invalid);var invalid=objToTS(obj,zone.offset(tsNow),zone),ts=invalid[0],invalid=invalid[1]}else ts=tsNow;return new DateTime({ts:ts,zone:zone,loc:opts,o:invalid})}function diffRelative(start,end,opts){function format(c,unit){return c=roundTo(c,round||opts.calendary?0:2,!0),end.loc.clone(opts).relFormatter(opts).format(c,unit)}function differ(unit){return opts.calendary?end.hasSame(start,unit)?0:end.startOf(unit).diff(start.startOf(unit),unit).get(unit):end.diff(start,unit).get(unit)}var round=void 0===opts.round||opts.round;if(opts.unit)return format(differ(opts.unit),opts.unit);for(var _iterator2=_createForOfIteratorHelperLoose(opts.units);!(_step2=_iterator2()).done;){var _step2=_step2.value,count=differ(_step2);if(1<=Math.abs(count))return format(count,_step2)}return format(end<start?-0:0,opts.units[opts.units.length-1])}function lastOpts(argList){var opts={},argList=0<argList.length&&"object"==typeof argList[argList.length-1]?(opts=argList[argList.length-1],Array.from(argList).slice(0,argList.length-1)):Array.from(argList);return[opts,argList]}var DateTime=function(){function DateTime(config){var _ref,zone=config.zone||Settings.defaultZone,invalid=config.invalid||(Number.isNaN(config.ts)?new Invalid("invalid input"):null)||(zone.isValid?null:unsupportedZone(zone)),c=(this.ts=void 0===config.ts?Settings.now():config.ts,null),o=null;invalid||(o=config.old&&config.old.ts===this.ts&&config.old.zone.equals(zone)?(c=(_ref=[config.old.c,config.old.o])[0],_ref[1]):(_ref=zone.offset(this.ts),c=tsToObj(this.ts,_ref),c=(invalid=Number.isNaN(c.year)?new Invalid("invalid input"):null)?null:c,invalid?null:_ref)),this._zone=zone,this.loc=config.loc||Locale.create(),this.invalid=invalid,this.weekData=null,this.c=c,this.o=o,this.isLuxonDateTime=!0}DateTime.now=function(){return new DateTime({})},DateTime.local=function(){var _lastOpts=lastOpts(arguments),opts=_lastOpts[0],_lastOpts=_lastOpts[1];return quickDT({year:_lastOpts[0],month:_lastOpts[1],day:_lastOpts[2],hour:_lastOpts[3],minute:_lastOpts[4],second:_lastOpts[5],millisecond:_lastOpts[6]},opts)},DateTime.utc=function(){var _lastOpts2=lastOpts(arguments),opts=_lastOpts2[0],_lastOpts2=_lastOpts2[1],year=_lastOpts2[0],month=_lastOpts2[1],day=_lastOpts2[2],hour=_lastOpts2[3],minute=_lastOpts2[4],second=_lastOpts2[5],_lastOpts2=_lastOpts2[6];return opts.zone=FixedOffsetZone.utcInstance,quickDT({year:year,month:month,day:day,hour:hour,minute:minute,second:second,millisecond:_lastOpts2},opts)},DateTime.fromJSDate=function(date,options){void 0===options&&(options={});var zoneToUse,date="[object Date]"===Object.prototype.toString.call(date)?date.valueOf():NaN;return Number.isNaN(date)?DateTime.invalid("invalid input"):(zoneToUse=normalizeZone(options.zone,Settings.defaultZone)).isValid?new DateTime({ts:date,zone:zoneToUse,loc:Locale.fromObject(options)}):DateTime.invalid(unsupportedZone(zoneToUse))},DateTime.fromMillis=function(milliseconds,options){if(void 0===options&&(options={}),isNumber(milliseconds))return milliseconds<-864e13||864e13<milliseconds?DateTime.invalid("Timestamp out of range"):new DateTime({ts:milliseconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromMillis requires a numerical input, but received a "+typeof milliseconds+" with value "+milliseconds)},DateTime.fromSeconds=function(seconds,options){if(void 0===options&&(options={}),isNumber(seconds))return new DateTime({ts:1e3*seconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromSeconds requires a numerical input")},DateTime.fromObject=function(obj,opts){obj=obj||{};var zoneToUse=normalizeZone((opts=void 0===opts?{}:opts).zone,Settings.defaultZone);if(!zoneToUse.isValid)return DateTime.invalid(unsupportedZone(zoneToUse));var tsNow=Settings.now(),offsetProvis=void 0!==opts.specificOffset?opts.specificOffset:zoneToUse.offset(tsNow),normalized=normalizeObject(obj,normalizeUnit),containsOrdinal=!(void 0===normalized.ordinal),containsGregorYear=!(void 0===normalized.year),containsGregorMD=!(void 0===normalized.month&&void 0===normalized.day),containsGregorYear=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber,opts=Locale.fromObject(opts);if((containsGregorYear||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");for(var defaultValues,containsGregorMD=definiteWeekDef||normalized.weekday&&!containsGregorYear,objNow=tsToObj(tsNow,offsetProvis),foundFirst=(containsGregorMD?(units=orderedWeekUnits,defaultValues=defaultWeekUnitValues,objNow=gregorianToWeek(objNow)):containsOrdinal?(units=orderedOrdinalUnits,defaultValues=defaultOrdinalUnitValues,objNow=gregorianToOrdinal(objNow)):(units=orderedUnits,defaultValues=defaultUnitValues),!1),_iterator3=_createForOfIteratorHelperLoose(units);!(_step3=_iterator3()).done;){var _step3=_step3.value;void 0!==normalized[_step3]?foundFirst=!0:normalized[_step3]=(foundFirst?defaultValues:objNow)[_step3]}var units,definiteWeekDef=(containsGregorMD?function(obj){var validYear=isInteger(obj.weekYear),validWeek=integerBetween(obj.weekNumber,1,weeksInWeekYear(obj.weekYear)),validWeekday=integerBetween(obj.weekday,1,7);return validYear?validWeek?!validWeekday&&unitOutOfRange("weekday",obj.weekday):unitOutOfRange("week",obj.week):unitOutOfRange("weekYear",obj.weekYear)}:containsOrdinal?function(obj){var validYear=isInteger(obj.year),validOrdinal=integerBetween(obj.ordinal,1,daysInYear(obj.year));return validYear?!validOrdinal&&unitOutOfRange("ordinal",obj.ordinal):unitOutOfRange("year",obj.year)}:hasInvalidGregorianData)(normalized)||hasInvalidTimeData(normalized);return definiteWeekDef?DateTime.invalid(definiteWeekDef):(units=new DateTime({ts:(tsNow=objToTS(containsGregorMD?weekToGregorian(normalized):containsOrdinal?ordinalToGregorian(normalized):normalized,offsetProvis,zoneToUse))[0],zone:zoneToUse,o:tsNow[1],loc:opts}),normalized.weekday&&containsGregorYear&&obj.weekday!==units.weekday?DateTime.invalid("mismatched weekday","you can't specify both a weekday of "+normalized.weekday+" and a date of "+units.toISO()):units)},DateTime.fromISO=function(text,opts){void 0===opts&&(opts={});var _parseISODate=parse(text,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset]);return parseDataToDateTime(_parseISODate[0],_parseISODate[1],opts,"ISO 8601",text)},DateTime.fromRFC2822=function(text,opts){void 0===opts&&(opts={});var _parseRFC2822Date=parse(text.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[rfc2822,extractRFC2822]);return parseDataToDateTime(_parseRFC2822Date[0],_parseRFC2822Date[1],opts,"RFC 2822",text)},DateTime.fromHTTP=function(text,opts){void 0===opts&&(opts={});text=parse(text,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII]);return parseDataToDateTime(text[0],text[1],opts,"HTTP",opts)},DateTime.fromFormat=function(text,fmt,opts){if(void 0===opts&&(opts={}),void 0===text||void 0===fmt)throw new InvalidArgumentError("fromFormat requires an input string and a format");var _opts=opts,_opts$locale=_opts.locale,_opts=_opts.numberingSystem,_opts$locale=function(locale,input,format){return[(locale=explainFromTokens(locale,input,format)).result,locale.zone,locale.specificOffset,locale.invalidReason]}(Locale.fromOpts({locale:void 0===_opts$locale?null:_opts$locale,numberingSystem:void 0===_opts?null:_opts,defaultToEN:!0}),text,fmt),_opts=_opts$locale[0],parsedZone=_opts$locale[1],specificOffset=_opts$locale[2],_opts$locale=_opts$locale[3];return _opts$locale?DateTime.invalid(_opts$locale):parseDataToDateTime(_opts,parsedZone,opts,"format "+fmt,text,specificOffset)},DateTime.fromString=function(text,fmt,opts){return DateTime.fromFormat(text,fmt,opts=void 0===opts?{}:opts)},DateTime.fromSQL=function(text,opts){void 0===opts&&(opts={});var _parseSQL=parse(text,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone]);return parseDataToDateTime(_parseSQL[0],_parseSQL[1],opts,"SQL",text)},DateTime.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(reason);return new DateTime({invalid:reason})},DateTime.isDateTime=function(o){return o&&o.isLuxonDateTime||!1},DateTime.parseFormatForOpts=function(formatOpts,localeOpts){formatOpts=formatOptsToTokens(formatOpts,Locale.fromObject(localeOpts=void 0===localeOpts?{}:localeOpts));return formatOpts?formatOpts.map(function(t){return t?t.val:null}).join(""):null},DateTime.expandFormat=function(fmt,localeOpts){return void 0===localeOpts&&(localeOpts={}),expandMacroTokens(Formatter.parseFormat(fmt),Locale.fromObject(localeOpts)).map(function(t){return t.val}).join("")};var _proto=DateTime.prototype;return _proto.get=function(unit){return this[unit]},_proto.resolvedLocaleOptions=function(opts){opts=Formatter.create(this.loc.clone(opts=void 0===opts?{}:opts),opts).resolvedOptions(this);return{locale:opts.locale,numberingSystem:opts.numberingSystem,outputCalendar:opts.calendar}},_proto.toUTC=function(offset,opts){return void 0===opts&&(opts={}),this.setZone(FixedOffsetZone.instance(offset=void 0===offset?0:offset),opts)},_proto.toLocal=function(){return this.setZone(Settings.defaultZone)},_proto.setZone=function(zone,_temp){var newTS,_temp=void 0===_temp?{}:_temp,_ref2$keepLocalTime=_temp.keepLocalTime,_ref2$keepLocalTime=void 0!==_ref2$keepLocalTime&&_ref2$keepLocalTime,_temp=_temp.keepCalendarTime,_temp=void 0!==_temp&&_temp;return(zone=normalizeZone(zone,Settings.defaultZone)).equals(this.zone)?this:zone.isValid?(newTS=this.ts,(_ref2$keepLocalTime||_temp)&&(_ref2$keepLocalTime=zone.offset(this.ts),newTS=objToTS(this.toObject(),_ref2$keepLocalTime,zone)[0]),clone(this,{ts:newTS,zone:zone})):DateTime.invalid(unsupportedZone(zone))},_proto.reconfigure=function(_temp2){var _temp2=void 0===_temp2?{}:_temp2,locale=_temp2.locale,numberingSystem=_temp2.numberingSystem,_temp2=_temp2.outputCalendar,locale=this.loc.clone({locale:locale,numberingSystem:numberingSystem,outputCalendar:_temp2});return clone(this,{loc:locale})},_proto.setLocale=function(locale){return this.reconfigure({locale:locale})},_proto.set=function(values){if(!this.isValid)return this;var mixed,values=normalizeObject(values,normalizeUnit),settingWeekStuff=!(void 0===values.weekYear&&void 0===values.weekNumber&&void 0===values.weekday),containsOrdinal=!(void 0===values.ordinal),containsGregorYear=!(void 0===values.year),containsGregorMD=!(void 0===values.month&&void 0===values.day),definiteWeekDef=values.weekYear||values.weekNumber;if((containsGregorYear||containsGregorMD||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");settingWeekStuff?mixed=weekToGregorian(_extends({},gregorianToWeek(this.c),values)):void 0!==values.ordinal?mixed=ordinalToGregorian(_extends({},gregorianToOrdinal(this.c),values)):(mixed=_extends({},this.toObject(),values),void 0===values.day&&(mixed.day=Math.min(daysInMonth(mixed.year,mixed.month),mixed.day)));containsGregorYear=objToTS(mixed,this.o,this.zone);return clone(this,{ts:containsGregorYear[0],o:containsGregorYear[1]})},_proto.plus=function(duration){return this.isValid?clone(this,adjustTime(this,Duration.fromDurationLike(duration))):this},_proto.minus=function(duration){return this.isValid?clone(this,adjustTime(this,Duration.fromDurationLike(duration).negate())):this},_proto.startOf=function(unit){if(!this.isValid)return this;var o={},unit=Duration.normalizeUnit(unit);switch(unit){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0}return"weeks"===unit&&(o.weekday=1),"quarters"===unit&&(unit=Math.ceil(this.month/3),o.month=3*(unit-1)+1),this.set(o)},_proto.endOf=function(unit){var _this$plus;return this.isValid?this.plus(((_this$plus={})[unit]=1,_this$plus)).startOf(unit).minus(1):this},_proto.toFormat=function(fmt,opts){return void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this,fmt):INVALID},_proto.toLocaleString=function(formatOpts,opts){return void 0===formatOpts&&(formatOpts=DATE_SHORT),void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.clone(opts),formatOpts).formatDateTime(this):INVALID},_proto.toLocaleParts=function(opts){return void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.clone(opts),opts).formatDateTimeParts(this):[]},_proto.toISO=function(_temp3){var c,_temp3=void 0===_temp3?{}:_temp3,_ref4$format=_temp3.format,_ref4$suppressSeconds=_temp3.suppressSeconds,_ref4$suppressSeconds=void 0!==_ref4$suppressSeconds&&_ref4$suppressSeconds,_ref4$suppressMillise=_temp3.suppressMilliseconds,_ref4$suppressMillise=void 0!==_ref4$suppressMillise&&_ref4$suppressMillise,_ref4$includeOffset=_temp3.includeOffset,_ref4$includeOffset=void 0===_ref4$includeOffset||_ref4$includeOffset,_temp3=_temp3.extendedZone,_temp3=void 0!==_temp3&&_temp3;return this.isValid?(c=_toISODate(this,_ref4$format="extended"===(void 0===_ref4$format?"extended":_ref4$format)),(c+="T")+_toISOTime(this,_ref4$format,_ref4$suppressSeconds,_ref4$suppressMillise,_ref4$includeOffset,_temp3)):null},_proto.toISODate=function(_temp4){_temp4=(void 0===_temp4?{}:_temp4).format;return this.isValid?_toISODate(this,"extended"===(void 0===_temp4?"extended":_temp4)):null},_proto.toISOWeekDate=function(){return toTechFormat(this,"kkkk-'W'WW-c")},_proto.toISOTime=function(_temp5){var _temp5=void 0===_temp5?{}:_temp5,_ref6$suppressMillise=_temp5.suppressMilliseconds,_ref6$suppressSeconds=_temp5.suppressSeconds,_ref6$includeOffset=_temp5.includeOffset,_ref6$includePrefix=_temp5.includePrefix,_ref6$extendedZone=_temp5.extendedZone,_temp5=_temp5.format;return this.isValid?(void 0!==_ref6$includePrefix&&_ref6$includePrefix?"T":"")+_toISOTime(this,"extended"===(void 0===_temp5?"extended":_temp5),void 0!==_ref6$suppressSeconds&&_ref6$suppressSeconds,void 0!==_ref6$suppressMillise&&_ref6$suppressMillise,void 0===_ref6$includeOffset||_ref6$includeOffset,void 0!==_ref6$extendedZone&&_ref6$extendedZone):null},_proto.toRFC2822=function(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},_proto.toHTTP=function(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},_proto.toSQLDate=function(){return this.isValid?_toISODate(this,!0):null},_proto.toSQLTime=function(_temp6){var _temp6=void 0===_temp6?{}:_temp6,_ref7$includeOffset=_temp6.includeOffset,_ref7$includeOffset=void 0===_ref7$includeOffset||_ref7$includeOffset,_ref7$includeZone=_temp6.includeZone,_ref7$includeZone=void 0!==_ref7$includeZone&&_ref7$includeZone,_temp6=_temp6.includeOffsetSpace,fmt="HH:mm:ss.SSS";return(_ref7$includeZone||_ref7$includeOffset)&&((void 0===_temp6||_temp6)&&(fmt+=" "),_ref7$includeZone?fmt+="z":_ref7$includeOffset&&(fmt+="ZZ")),toTechFormat(this,fmt,!0)},_proto.toSQL=function(opts){return void 0===opts&&(opts={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(opts):null},_proto.toString=function(){return this.isValid?this.toISO():INVALID},_proto.valueOf=function(){return this.toMillis()},_proto.toMillis=function(){return this.isValid?this.ts:NaN},_proto.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},_proto.toUnixInteger=function(){return this.isValid?Math.floor(this.ts/1e3):NaN},_proto.toJSON=function(){return this.toISO()},_proto.toBSON=function(){return this.toJSDate()},_proto.toObject=function(opts){var base;return void 0===opts&&(opts={}),this.isValid?(base=_extends({},this.c),opts.includeConfig&&(base.outputCalendar=this.outputCalendar,base.numberingSystem=this.loc.numberingSystem,base.locale=this.loc.locale),base):{}},_proto.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},_proto.diff=function(otherDateTime,unit,opts){var otherIsLater;return void 0===unit&&(unit="milliseconds"),void 0===opts&&(opts={}),this.isValid&&otherDateTime.isValid?(opts=_extends({locale:this.locale,numberingSystem:this.numberingSystem},opts),unit=unit,unit=(Array.isArray(unit)?unit:[unit]).map(Duration.normalizeUnit),otherDateTime=_diff((otherIsLater=otherDateTime.valueOf()>this.valueOf())?this:otherDateTime,otherIsLater?otherDateTime:this,unit,opts),otherIsLater?otherDateTime.negate():otherDateTime):Duration.invalid("created by diffing an invalid DateTime")},_proto.diffNow=function(unit,opts){return void 0===unit&&(unit="milliseconds"),void 0===opts&&(opts={}),this.diff(DateTime.now(),unit,opts)},_proto.until=function(otherDateTime){return this.isValid?Interval.fromDateTimes(this,otherDateTime):this},_proto.hasSame=function(otherDateTime,unit){var inputMs;return!!this.isValid&&(inputMs=otherDateTime.valueOf(),(otherDateTime=this.setZone(otherDateTime.zone,{keepLocalTime:!0})).startOf(unit)<=inputMs&&inputMs<=otherDateTime.endOf(unit))},_proto.equals=function(other){return this.isValid&&other.isValid&&this.valueOf()===other.valueOf()&&this.zone.equals(other.zone)&&this.loc.equals(other.loc)},_proto.toRelative=function(options){var base,padding,units,unit;return this.isValid?(base=(options=void 0===options?{}:options).base||DateTime.fromObject({},{zone:this.zone}),padding=options.padding?this<base?-options.padding:options.padding:0,units=["years","months","days","hours","minutes","seconds"],unit=options.unit,Array.isArray(options.unit)&&(units=options.unit,unit=void 0),diffRelative(base,this.plus(padding),_extends({},options,{numeric:"always",units:units,unit:unit}))):null},_proto.toRelativeCalendar=function(options){return void 0===options&&(options={}),this.isValid?diffRelative(options.base||DateTime.fromObject({},{zone:this.zone}),this,_extends({},options,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},DateTime.min=function(){for(var _len=arguments.length,dateTimes=new Array(_len),_key=0;_key<_len;_key++)dateTimes[_key]=arguments[_key];if(dateTimes.every(DateTime.isDateTime))return bestBy(dateTimes,function(i){return i.valueOf()},Math.min);throw new InvalidArgumentError("min requires all arguments be DateTimes")},DateTime.max=function(){for(var _len2=arguments.length,dateTimes=new Array(_len2),_key2=0;_key2<_len2;_key2++)dateTimes[_key2]=arguments[_key2];if(dateTimes.every(DateTime.isDateTime))return bestBy(dateTimes,function(i){return i.valueOf()},Math.max);throw new InvalidArgumentError("max requires all arguments be DateTimes")},DateTime.fromFormatExplain=function(text,fmt,options){var options=options=void 0===options?{}:options,_options$locale=options.locale,options=options.numberingSystem;return explainFromTokens(Locale.fromOpts({locale:void 0===_options$locale?null:_options$locale,numberingSystem:void 0===options?null:options,defaultToEN:!0}),text,fmt)},DateTime.fromStringExplain=function(text,fmt,options){return DateTime.fromFormatExplain(text,fmt,options=void 0===options?{}:options)},_createClass(DateTime,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return isLeapYear(this.year)}},{key:"daysInMonth",get:function(){return daysInMonth(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?daysInYear(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return DATE_SHORT}},{key:"DATE_MED",get:function(){return DATE_MED}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return DATE_MED_WITH_WEEKDAY}},{key:"DATE_FULL",get:function(){return DATE_FULL}},{key:"DATE_HUGE",get:function(){return DATE_HUGE}},{key:"TIME_SIMPLE",get:function(){return TIME_SIMPLE}},{key:"TIME_WITH_SECONDS",get:function(){return TIME_WITH_SECONDS}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return TIME_WITH_SHORT_OFFSET}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return TIME_WITH_LONG_OFFSET}},{key:"TIME_24_SIMPLE",get:function(){return TIME_24_SIMPLE}},{key:"TIME_24_WITH_SECONDS",get:function(){return TIME_24_WITH_SECONDS}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return TIME_24_WITH_SHORT_OFFSET}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return TIME_24_WITH_LONG_OFFSET}},{key:"DATETIME_SHORT",get:function(){return DATETIME_SHORT}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return DATETIME_SHORT_WITH_SECONDS}},{key:"DATETIME_MED",get:function(){return DATETIME_MED}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return DATETIME_MED_WITH_SECONDS}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return DATETIME_MED_WITH_WEEKDAY}},{key:"DATETIME_FULL",get:function(){return DATETIME_FULL}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return DATETIME_FULL_WITH_SECONDS}},{key:"DATETIME_HUGE",get:function(){return DATETIME_HUGE}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return DATETIME_HUGE_WITH_SECONDS}}]),DateTime}();function friendlyDateTime(dateTimeish){if(DateTime.isDateTime(dateTimeish))return dateTimeish;if(dateTimeish&&dateTimeish.valueOf&&isNumber(dateTimeish.valueOf()))return DateTime.fromJSDate(dateTimeish);if(dateTimeish&&"object"==typeof dateTimeish)return DateTime.fromObject(dateTimeish);throw new InvalidArgumentError("Unknown datetime argument: "+dateTimeish+", of type "+typeof dateTimeish)}exports.DateTime=DateTime,exports.Duration=Duration,exports.FixedOffsetZone=FixedOffsetZone,exports.IANAZone=IANAZone,exports.Info=Info,exports.Interval=Interval,exports.InvalidZone=InvalidZone,exports.Settings=Settings,exports.SystemZone=SystemZone,exports.VERSION="3.0.4",exports.Zone=Zone},{}],2:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderableComponent=void 0;require=function(_super){function RenderableComponent(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RenderableComponent,_super),RenderableComponent.prototype.hide=function(){return __awaiter(this,void 0,void 0,function(){var _a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return _a.hidden=!0,[2,this]}})})},RenderableComponent.prototype.render=function(maybeParent,prepend){return void 0===prepend&&(prepend=!1),__awaiter(this,void 0,void 0,function(){var element,_a,_b,parent;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return element=_a,parent=maybeParent||document.body,prepend?parent.prepend(element):parent.append(element),[2,element]}})})},RenderableComponent.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var _a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return _a.hidden=!1,[2,this]}})})},RenderableComponent.prototype.teardown=function(){return __awaiter(this,void 0,void 0,function(){var element,_a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return(element=_a).remove(),[2,element]}})})},RenderableComponent}(require("../services/card/index").InspectableComponent);exports.RenderableComponent=require},{"../services/card/index":62}],3:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.AddInMenu=void 0,require(".")),html_1=require("../utils/html"),identifiers_1=require("../utils/identifiers"),require=function(_super){function AddInMenu(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.cardActions={},_this.universalActions={},_this}return __extends(AddInMenu,_super),AddInMenu.prototype.getIdentifiers=function(type){return Object.keys(this["".concat(type,"Actions")])},AddInMenu.prototype.addCardAction=function(cardAction){return __awaiter(this,void 0,void 0,function(){var guid;return __generator(this,function(_a){return guid=(0,identifiers_1.getGuid)(this.getIdentifiers("card")),this.cardActions[guid]=cardAction,[2,this]})})},AddInMenu.prototype.addUniversalAction=function(universalAction){return __awaiter(this,void 0,void 0,function(){var guid;return __generator(this,function(_a){return guid=(0,identifiers_1.getGuid)(this.getIdentifiers("universal")),this.universalActions[guid]=universalAction,[2,this]})})},AddInMenu.prototype.clear=function(type){var store=this["".concat(type,"Actions")];return Object.entries(store).forEach(function(_a){var _a=__read(_a,2),guid=_a[0];_a[1].teardown(),delete store[guid]}),this},AddInMenu.prototype.isClosed=function(){return(this.element||(this.element=this.create())).classList.contains("singulared")},AddInMenu.prototype.isOpen=function(){return!this.isClosed()},AddInMenu.prototype.remove=function(type,guid){var type=this["".concat(type,"Actions")],action=type[guid];return null!=action&&action.teardown(),delete type[guid],this},AddInMenu.prototype.close=function(){var element=this.element;return null!=element&&element.classList.add("singulared"),this},AddInMenu.prototype.toggle=function(){var element=this.element;return null!=element&&element.classList.toggle("singulared"),this},AddInMenu.prototype.create=function(){var _a,_this=this,element=document.createElement("div");return element.classList.add("menu","singulared"),null!=(_a=document.querySelector(".navelem"))&&_a.addEventListener("click",function(event){event.stopPropagation(),event.preventDefault(),_this.toggle(),_this.isOpen()&&(0,html_1.bindSelfRemovingListener)(document.body,"click",function(){return _this.close()})}),element},AddInMenu.prototype.render=function(maybeParent){return __awaiter(this,void 0,void 0,function(){var cardActions,_a,element,_b,_c,_d,_e,e_1_1,_f,e_2_1,_g;return __generator(this,function(_h){switch(_h.label){case 0:cardActions=(_a=this).cardActions,_a=_a.universalActions,element=this.element||(this.element=this.create()),_h.label=1;case 1:_h.trys.push([1,6,7,8]),_b=__values(Object.values(cardActions)),_c=_b.next(),_h.label=2;case 2:return _c.done?[3,5]:[4,_c.value.render(element)];case 3:_h.sent(),_h.label=4;case 4:return _c=_b.next(),[3,2];case 5:return[3,8];case 6:return e_1_1=_h.sent(),e_1_1={error:e_1_1},[3,8];case 7:try{_c&&!_c.done&&(_f=_b.return)&&_f.call(_b)}finally{if(e_1_1)throw e_1_1.error}return[7];case 8:_h.trys.push([8,13,14,15]),_d=__values(Object.values(_a)),_e=_d.next(),_h.label=9;case 9:return _e.done?[3,12]:[4,_e.value.render(element)];case 10:_h.sent(),_h.label=11;case 11:return _e=_d.next(),[3,9];case 12:return[3,15];case 13:return e_2_1=_h.sent(),e_2_1={error:e_2_1},[3,15];case 14:try{_e&&!_e.done&&(_g=_d.return)&&_g.call(_d)}finally{if(e_2_1)throw e_2_1.error}return[7];case 15:return[2,_super.prototype.render.call(this,maybeParent)]}})})},AddInMenu}(_1.RenderableComponent);exports.AddInMenu=require},{".":2,"../utils/html":92,"../utils/identifiers":93}],4:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Overlay=void 0,require(".")),html_1=require("../utils/html"),require=function(_super){function Overlay(containerId){var _this=_super.call(this)||this;return _this.containerId=containerId,_this.color="white",_this.tone="light",_this}return __extends(Overlay,_super),Overlay.prototype.setColor=function(color){return this.color=color,this},Overlay.prototype.setTone=function(tone){return this.tone=tone,this},Overlay.prototype.create=function(){var tone=this.tone,color=this.color,overlay=document.createElement("div");return overlay.classList.add("overlay"),overlay.classList.add("overlay-".concat(tone)),overlay.hidden=!0,overlay.style.backgroundColor=color,overlay},Overlay.prototype.cover=function(){var containerId=this.containerId,element=this.element||(this.element=this.create()),appContainer=document.getElementById(containerId);if(appContainer)return appContainer=window.getComputedStyle(appContainer),appContainer=(0,html_1.parsePixelLength)(appContainer.height)+35,element.style.height="".concat(appContainer,"px"),this;throw new Error("missing app container: #".concat(containerId))},Overlay.prototype.hide=function(){return this.cover(),_super.prototype.hide.call(this)},Overlay.prototype.show=function(){return this.cover(),_super.prototype.show.call(this)},Overlay}(_1.RenderableComponent);exports.Overlay=require},{".":2,"../utils/html":92}],5:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.Spinner=void 0;require=function(_super){function Spinner(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.size="small",_this}return __extends(Spinner,_super),Spinner.prototype.setSize=function(size){return this.size=size,this},Spinner.prototype.create=function(){var size=this.size,spinner=document.createElement("div");return spinner.classList.add("spinner","spinner-".concat(size)),spinner},Spinner.prototype.render=function(maybeParent){var element=this.element||(this.element=this.create()),classList=element.classList;return classList.forEach(function(token){token.startsWith("spinner-")&&classList.remove(token)}),element.classList.add("spinner-".concat(this.size)),_super.prototype.render.call(this,maybeParent)},Spinner}(require(".").RenderableComponent);exports.Spinner=require},{".":2}],6:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toggler=void 0;require=function(_super){function Toggler(collapsed){var _this=_super.call(this)||this;return _this.collapsed=collapsed,_this}return __extends(Toggler,_super),Toggler.prototype.setOnToggle=function(callback){return this.toggleCallback=callback,this},Toggler.prototype.create=function(){var _this=this,wrapper=document.createElement("div"),shevron=(wrapper.classList.add("card-section-toggler"),document.createElement("div"));return shevron.classList.add("card-section-toggler-icon","ms-Icon","ms-Icon--ChevronDown","pointer"),shevron.addEventListener("click",function(){return __awaiter(_this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return shevron.classList.toggle("card-section-toggler--up"),this.collapsed=!this.collapsed,[4,null==(_a=this.toggleCallback)?void 0:_a.call(this,wrapper,this)];case 1:return _b.sent(),[2]}})})}),wrapper.append(shevron),wrapper},Toggler}(require(".").RenderableComponent);exports.Toggler=require},{".":2}],7:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},luxon_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventObject=void 0,__importDefault(require("luxon"))),office_1=require("./utils/office"),EventTimezone=function(){function EventTimezone(){}return Object.defineProperty(EventTimezone.prototype,"id",{get:function(){return(0,office_1.getProfile)().timeZone},enumerable:!1,configurable:!0}),Object.defineProperty(EventTimezone.prototype,"offset",{get:function(){return(60*luxon_1.default.DateTime.fromJSDate(new Date,{zone:this.id}).offset*1e3).toString()},enumerable:!1,configurable:!0}),EventTimezone}(),CommonEventObject=function(){function CommonEventObject(){this.timeZone=new EventTimezone,this.parameters={},this.formInputs={}}return Object.defineProperty(CommonEventObject.prototype,"platform",{get:function(){return Office.context.platform||Office.PlatformType.OfficeOnline},enumerable:!1,configurable:!0}),Object.defineProperty(CommonEventObject.prototype,"userLocale",{get:function(){return Office.context.displayLanguage||"en-US"},enumerable:!1,configurable:!0}),CommonEventObject}(),GmailEventObject=function(){function GmailEventObject(item){this.item=item}return Object.defineProperty(GmailEventObject.prototype,"accessToken",{get:function(){return new Promise(function(res,rej){(0,office_1.getMailbox)().getCallbackTokenAsync(function(result){var error=result.error,result=result.value;null!=error&&error.code?rej(error):res(result)})})},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"bccRecipients",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"ccRecipients",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.cc.map(function(_a){return _a.emailAddress}))||[]},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"messageId",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.itemId)||""},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"threadId",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.conversationId)||""},enumerable:!1,configurable:!0}),GmailEventObject}(),__importDefault=function(){function EventObject(){var _a;this.commonEventObject=new CommonEventObject,this.gmail=new GmailEventObject(null==(_a=Office.context.mailbox)?void 0:_a.item)}return Object.defineProperty(EventObject.prototype,"formInput",{get:function(){var formInputs=this.commonEventObject.formInputs,inputs={};return Object.entries(formInputs).forEach(function(_a){var _a=__read(_a,2),key=_a[0],_a=_a[1].stringInputs;inputs[key]=_a.value[0]}),inputs},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"formInputs",{get:function(){var formInputs=this.commonEventObject.formInputs,inputs={};return Object.entries(formInputs).forEach(function(_a){var _a=__read(_a,2),key=_a[0],_a=_a[1].stringInputs;inputs[key]=_a.value}),inputs},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"clientPlatform",{get:function(){return this.commonEventObject.platform},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"messageMetadata",{get:function(){var gmail=this.gmail;return{accessToken:gmail.accessToken,messageId:gmail.messageId}},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"parameters",{get:function(){return this.commonEventObject.parameters},set:function(value){this.commonEventObject.parameters=value},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userCountry",{get:function(){var userLocale=this.commonEventObject.userLocale;return __read(userLocale.split("-"),2)[1]||"US"},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userLocale",{get:function(){return this.commonEventObject.userLocale},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userTimezone",{get:function(){return this.commonEventObject.timeZone},enumerable:!1,configurable:!0}),EventObject}();exports.EventObject=__importDefault},{"./utils/office":97,luxon:1}],8:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},overlay_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.getActionResponse=void 0,require("../components/overlay")),spinner_1=require("../components/spinner"),action_response_1=require("../services/card/builders/action_response"),enums_1=require("../services/card/enums"),functions_1=require("../utils/functions"),log_1=require("../utils/log"),strings_1=require("../utils/strings");exports.getActionResponse=function(action,event){return __awaiter(void 0,void 0,void 0,function(){var indicator,name,overlayParent,overlay,spinner,parameters,handlerResult_1,handlerResult_1_1,card,navigation,error_1,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:if(indicator=action.indicator,name=action.name,parameters=action.parameters,name)return Object.assign(event.parameters,parameters),overlayParent=document.getElementById("app-overlay"),[4,(overlay=new overlay_1.Overlay("app-body")).render(overlayParent)];throw new Error("action is missing the function name",{cause:action});case 1:return _b.sent(),[4,overlay.show()];case 2:return _b.sent(),(spinner=new spinner_1.Spinner).setSize("large"),[4,spinner.render(overlayParent)];case 3:return _b.sent(),indicator===enums_1.LoadIndicator.NONE?[3,5]:[4,spinner.show()];case 4:_b.sent(),_b.label=5;case 5:if(_b.trys.push([5,6,7,10]),(parameters=(0,functions_1.callFunctionFromGlobalScope)(name,event))instanceof Array){navigation=window.CardService.newNavigation();try{for(handlerResult_1=__values(parameters),handlerResult_1_1=handlerResult_1.next();!handlerResult_1_1.done;handlerResult_1_1=handlerResult_1.next())card=handlerResult_1_1.value,navigation.pushCard(card)}catch(e_1_1){e_1={error:e_1_1}}finally{try{handlerResult_1_1&&!handlerResult_1_1.done&&(_a=handlerResult_1.return)&&_a.call(handlerResult_1)}finally{if(e_1)throw e_1.error}}return[2,(new action_response_1.ActionResponseBuilder).setNavigation(navigation).build()]}return window.CardServiceConfig.isInstance(parameters,"Card")?(navigation=window.CardService.newNavigation(),[2,(new action_response_1.ActionResponseBuilder).setNavigation(navigation.pushCard(parameters)).build()]):[2,parameters];case 6:throw error_1=_b.sent(),(0,log_1.log)("error","failed to handle action",(0,strings_1.safeToString)(error_1)),error_1;case 7:return[4,spinner.hide()];case 8:return _b.sent(),[4,overlay.hide()];case 9:return _b.sent(),[7];case 10:return[2]}})})}},{"../components/overlay":4,"../components/spinner":5,"../services/card/builders/action_response":27,"../services/card/enums":61,"../utils/functions":90,"../utils/log":94,"../utils/strings":98}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDisplayCardsResponse=void 0;var universal_action_response_1=require("../services/card/builders/universal_action_response");exports.getDisplayCardsResponse=function(action){var builder=new universal_action_response_1.UniversalActionResponseBuilder;return builder.displayAddOnCards(action.getCards()),builder.build()}},{"../services/card/builders/universal_action_response":31}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOpenLinkResponse=void 0;var universal_action_response_1=require("../services/card/builders/universal_action_response");exports.getOpenLinkResponse=function(action){var builder=new universal_action_response_1.UniversalActionResponseBuilder;return builder.setOpenLink(action),builder.build()}},{"../services/card/builders/universal_action_response":31}],11:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},action_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleAction=void 0,require("../getters/action")),display_cards_1=require("../getters/display_cards"),open_link_1=require("../getters/open_link"),action_2=require("../services/card/actions/action"),display_cards_2=require("../services/card/actions/display_cards"),open_link_2=require("../services/card/actions/open_link"),action_response_1=require("../services/card/components/responses/action_response"),suggestions_response_1=require("../services/card/components/responses/suggestions_response"),universal_action_response_1=require("../services/card/components/responses/universal_action_response"),actions_1=require("../stores/actions"),rules_1=require("../stores/rules"),log_1=require("../utils/log"),strings_1=require("../utils/strings"),response_1=require("./response");exports.handleAction=function(event,element){return __awaiter(void 0,void 0,void 0,function(){var guid,action,actionResponse_1,actionHandlerStore,_b;return __generator(this,function(_c){switch(_c.label){case 0:if(guid=element.getAttribute("action"),action=guid?actions_1.ActionStore.get(guid):void 0,!guid||!action)return[2];console.debug(guid,event,action),_c.label=1;case 1:if(_c.trys.push([1,5,6,8]),actionHandlerStore=new rules_1.RuleStore([[action_2.Action,action_1.getActionResponse],[display_cards_2.DisplayCardsAction,display_cards_1.getDisplayCardsResponse],[open_link_2.OpenLink,open_link_1.getOpenLinkResponse]]),actionHandlerStore=__read(actionHandlerStore.find(function(_a){_a=__read(_a,1)[0];return action instanceof _a||window.CardServiceConfig.isInstance(action,_a.name)}),2),actionHandlerStore=actionHandlerStore[1])return[4,actionHandlerStore(action,event)];throw new Error("missing handler for action",{cause:action});case 2:if(!(actionResponse_1=_c.sent()))return[3,4];if(actionHandlerStore=new rules_1.RuleStore([[action_response_1.ActionResponse,response_1.handleActionResponse],[suggestions_response_1.SuggestionsResponse,response_1.handleSuggestionsResponse],[universal_action_response_1.UniversalActionResponse,response_1.handleUniversalActionResponse]]),_b=__read(actionHandlerStore.find(function(_a){_a=__read(_a,1)[0];return actionResponse_1 instanceof _a||window.CardServiceConfig.isInstance(actionResponse_1,_a.name)}),2),_b=_b[1])return[4,_b(actionResponse_1,element)];throw new Error("missing action response handler",{cause:actionResponse_1});case 3:_c.sent(),_c.label=4;case 4:return[3,8];case 5:return _b=_c.sent(),(0,log_1.log)("error","action handler error",(0,strings_1.safeToString)(_b)),[3,8];case 6:return actions_1.ActionStore.remove(guid),[4,new Promise(function(r){return setTimeout(r,500)})];case 7:return _c.sent(),[7];case 8:return[2]}})})}},{"../getters/action":8,"../getters/display_cards":9,"../getters/open_link":10,"../services/card/actions/action":21,"../services/card/actions/display_cards":24,"../services/card/actions/open_link":25,"../services/card/components/responses/action_response":52,"../services/card/components/responses/suggestions_response":53,"../services/card/components/responses/universal_action_response":54,"../stores/actions":83,"../stores/rules":85,"../utils/log":94,"../utils/strings":98,"./response":14}],12:[function(require,module,exports){"use strict";var __values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},events_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=void 0,require("../events")),guards_1=require("../utils/guards"),action_1=require("./action"),addToFormInputs=function(event,name,value){event=event.commonEventObject.formInputs;(event[name]||(event[name]={stringInputs:{value:[]}})).stringInputs.value.push(value)},removeFromFormInputs=function(event,name,value){name=(event=event.commonEventObject.formInputs[name].stringInputs).value||(event.value=[]);-1<name.indexOf(value)&&name.splice(name.indexOf(value),1)},fillFormInputs=function(event){var e_1,_a,e_2,_b,forms=document.getElementsByTagName("form");try{for(var forms_1=__values(forms),forms_1_1=forms_1.next();!forms_1_1.done;forms_1_1=forms_1.next()){var elements=forms_1_1.value.elements;try{e_2=void 0;for(var elements_1=__values(elements),elements_1_1=elements_1.next();!elements_1_1.done;elements_1_1=elements_1.next()){var name_1,value,element=elements_1_1.value;(0,guards_1.isInputLike)(element)&&(name_1=element.name,value=element.value,(!(0,guards_1.isOfficeJSstateFormElement)(element)||(0,guards_1.isSelectedStateFormElement)(element)?addToFormInputs:removeFromFormInputs)(event,name_1,value))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{elements_1_1&&!elements_1_1.done&&(_b=elements_1.return)&&_b.call(elements_1)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{forms_1_1&&!forms_1_1.done&&(_a=forms_1.return)&&_a.call(forms_1)}finally{if(e_1)throw e_1.error}}};exports.handleEvent=function(element){var event=new events_1.EventObject;fillFormInputs(event),(0,action_1.handleAction)(event,element)}},{"../events":7,"../utils/guards":91,"./action":11}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleOpenLinkAction=void 0;var ready_1=require("../../ready"),enums_1=require("../services/card/enums"),anchors_1=require("../utils/anchors");exports.handleOpenLinkAction=function(openLink){var onClose=openLink.onClose,openAs=openLink.openAs,openLink=openLink.url,openLink=void 0===openLink?"":openLink;(_a={})[enums_1.OpenAs.FULL_SIZE]="browser",_a[enums_1.OpenAs.OVERLAY]="dialog";var _a=Office.context.host?_a[openAs]:"web";(0,anchors_1.openURL)(openLink,_a,function(){onClose===enums_1.OnClose.RELOAD&&(0,ready_1.readyCallback)(Office.context)})}},{"../../ready":101,"../services/card/enums":61,"../utils/anchors":87}],14:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},navigation_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleUniversalActionResponse=exports.handleSuggestionsResponse=exports.handleActionResponse=void 0,require("../services/card/components/navigation")),rules_1=require("../stores/rules"),log_1=require("../utils/log"),strings_1=require("../utils/strings"),open_link_1=require("./open_link"),navigationRules=new rules_1.RuleStore([[navigation_1.NavigationType.NAMED,function(store,action){store.named(action.name)}],[navigation_1.NavigationType.POP,function(store){store.pop()}],[navigation_1.NavigationType.PUSH,function(store,action){store.push(action.card)}],[navigation_1.NavigationType.ROOT,function(store){store.root()}]]);exports.handleActionResponse=function(response){return __awaiter(void 0,void 0,void 0,function(){var notification,openLink,actions,CardStore_1,_loop_1,actions_1,actions_1_1,action,navigation,error_1,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:return(_b.trys.push([0,6,,7]),navigation=response.navigation,notification=response.notification,openLink=response.openLink,navigation)?(actions=navigation.actions,[4,(CardStore_1=window.CardServiceConfig.CardStore).teardown()]):[3,3];case 1:_b.sent(),_loop_1=function(action){var type=action.type,navigationHandler=__read(navigationRules.find(function(_a){return __read(_a,1)[0]===type}),2)[1];if(!navigationHandler)throw new Error("missing Navigation handler",{cause:action});navigationHandler(CardStore_1,action)};try{for(actions_1=__values(actions),actions_1_1=actions_1.next();!actions_1_1.done;actions_1_1=actions_1.next())action=actions_1_1.value,_loop_1(action)}catch(e_1_1){e_1={error:e_1_1}}finally{try{actions_1_1&&!actions_1_1.done&&(_a=actions_1.return)&&_a.call(actions_1)}finally{if(e_1)throw e_1.error}}return[4,CardStore_1.render(document.getElementById("app-body"))];case 2:_b.sent(),_b.label=3;case 3:return notification?(navigation=document.getElementById("app-notif")||document.body,[4,notification.render(navigation)]):[3,5];case 4:_b.sent(),_b.label=5;case 5:return openLink&&(0,open_link_1.handleOpenLinkAction)(openLink),[3,7];case 6:return error_1=_b.sent(),(0,log_1.log)("error","ActionResponse handler error",(0,strings_1.safeToString)(error_1)),[3,7];case 7:return[2]}})})},exports.handleSuggestionsResponse=function(response,element){element.dispatchEvent(new CustomEvent("suggestions",{detail:(null==(element=response.suggestions)?void 0:element.suggestions)||[],bubbles:!1}))};exports.handleUniversalActionResponse=function(response){return __awaiter(void 0,void 0,void 0,function(){var cards,openLink,CardStore_2,error_2;return __generator(this,function(_a){switch(_a.label){case 0:return(_a.trys.push([0,4,,5]),cards=response.cards,openLink=response.openLink,CardStore_2=window.CardServiceConfig.CardStore,cards.length)?[4,CardStore_2.teardown()]:[3,3];case 1:return _a.sent(),CardStore_2.reset(cards),[4,CardStore_2.render(document.getElementById("app-body"))];case 2:_a.sent(),_a.label=3;case 3:return openLink&&(0,open_link_1.handleOpenLinkAction)(openLink),[3,5];case 4:return error_2=_a.sent(),(0,log_1.log)("error","UniversalActionResponse handler error",(0,strings_1.safeToString)(error_2)),[3,5];case 5:return[2]}})})}},{"../services/card/components/navigation":50,"../stores/rules":85,"../utils/log":94,"../utils/strings":98,"./open_link":13}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var exports=require("./services/base/logger"),service_1=require("./services/cache/service"),service_2=require("./services/card/service"),service_3=require("./services/gmail/service"),service_4=require("./services/lock/service"),service_5=require("./services/properties/service"),service_6=require("./services/session/service"),service_7=require("./services/url_fetch/service"),service_8=require("./services/utilities/service");require("./stores/services").ServicesStore.setAll([new service_2.CardService,new service_1.CacheService,new service_3.GmailApp,new service_4.LockService,new exports.Logger,new service_5.PropertiesService,new service_6.Session,new service_7.UrlFetchApp,new service_8.Utilities]),window[service_2.CardServiceConfig.name]=service_2.CardServiceConfig},{"./services/base/logger":17,"./services/cache/service":20,"./services/card/service":63,"./services/gmail/service":70,"./services/lock/service":73,"./services/properties/service":76,"./services/session/service":78,"./services/url_fetch/service":80,"./services/utilities/service":82,"./stores/services":86}],16:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},Blob=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Blob=void 0,function(){function Blob(){this.content=new ArrayBuffer(0),this.name=null,this.type=null}return Blob.prototype.copyBlob=function(){var type=this.type,name=this.name,blob=new Blob;return blob.setBytes(this.getBytes()),name&&blob.setName(name),type&&blob.setContentType(type),blob},Blob.prototype.getBytes=function(){var content=this.content;return __spreadArray([],__read(new Uint8Array(content)),!1)},Blob.prototype.getDataAsString=function(_charset){var content=this.content;return(new TextDecoder).decode(content)},Blob.prototype.getName=function(){return this.name},Blob.prototype.setBytes=function(data){return this.content=Uint8Array.from(data).buffer,this},Blob.prototype.setContentType=function(contentType){return this.type=contentType,this},Blob.prototype.setDataFromString=function(string,_charset){void 0===_charset&&(_charset="utf8");_charset=new TextEncoder;return this.content=_charset.encode(string).buffer,this},Blob.prototype.setName=function(name){return this.name=name,this},Blob}());exports.Blob=Blob},{}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=void 0;var Logger=function(){function Logger(){this.stack=[]}return Logger.prototype.clear=function(){return this.stack.length=0,this},Logger.prototype.getLog=function(){return this.stack.map(function(_a){var message=_a.message,_a=_a.timestamp;return"".concat(_a,": ").concat(message)}).join("\n")},Logger.prototype.log=function(data){return this.stack.push({message:Object.prototype.toString.call(data),timestamp:(new Date).toISOString()}),console.log(data),this},Logger}();exports.Logger=Logger},{}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cache=void 0;var Cache=function(){function Cache(storage,type){this.storage=storage,this.type=type}return Object.defineProperty(Cache.prototype,"typedStorage",{get:function(){var storage=this.storage,type=this.type,typedStorage=storage.getItem(type);return typedStorage?JSON.parse(typedStorage):(typedStorage={},storage.setItem(type,JSON.stringify(typedStorage)),typedStorage)},set:function(value){var storage=this.storage,type=this.type;storage.setItem(type,JSON.stringify(value))},enumerable:!1,configurable:!0}),Cache.prototype.expire=function(key,after){var _this=this;return setTimeout(function(){return _this.remove(key)},after),this},Cache.prototype.expireAll=function(after){var _this=this;return setTimeout(function(){_this.typedStorage={}},after),this},Cache.prototype.constrainExpiration=function(seconds){return seconds<1?1:21600<seconds?21600:seconds},Cache.prototype.get=function(key){var typedStorage=this.typedStorage;return key in typedStorage?typedStorage[key]:null},Cache.prototype.getAll=function(keys){var typedStorage=this.typedStorage,keys=keys.filter(function(key){return key in typedStorage}).map(function(key){return[key,typedStorage[key]]});return Object.fromEntries(keys)},Cache.prototype.put=function(key,value,expirationInSeconds){void 0===expirationInSeconds&&(expirationInSeconds=600);var typedStorage=this.typedStorage,value=(typedStorage[key]=value.toString(),this.typedStorage=typedStorage,this.constrainExpiration(expirationInSeconds));return this.expire(key,1e3*value)},Cache.prototype.putAll=function(values,expirationInSeconds){void 0===expirationInSeconds&&(expirationInSeconds=600),this.typedStorage=values;values=this.constrainExpiration(expirationInSeconds);return this.expireAll(1e3*values)},Cache.prototype.remove=function(key){var typedStorage=this.typedStorage;return delete typedStorage[key],this.typedStorage=typedStorage,this},Cache.prototype.removeAll=function(keys){var typedStorage=this.typedStorage;return keys.forEach(function(key){return delete typedStorage[key]}),this.typedStorage=typedStorage,this},Cache}();exports.Cache=Cache},{}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CacheType=void 0,function(CacheType){CacheType.DOCUMENT="DOCUMENT",CacheType.SCRIPT="SCRIPT",CacheType.USER="USER"}(exports.CacheType||(exports.CacheType={}))},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CacheService=void 0;var cache_1=require("./cache"),enums_1=require("./enums"),require=function(){function CacheService(){}return CacheService.prototype.getDocumentCache=function(){var localStorage=window.localStorage;return new cache_1.Cache(localStorage,enums_1.CacheType.DOCUMENT)},CacheService.prototype.getScriptCache=function(){var localStorage=window.localStorage;return new cache_1.Cache(localStorage,enums_1.CacheType.SCRIPT)},CacheService.prototype.getUserCache=function(){var localStorage=window.localStorage;return new cache_1.Cache(localStorage,enums_1.CacheType.USER)},CacheService}();exports.CacheService=require},{"./cache":18,"./enums":19}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;var enums_1=require("../enums"),require=function(){function Action(){this.indicator=enums_1.LoadIndicator.SPINNER,this.parameters={}}return Action.prototype.setFunctionName=function(functionName){return this.name=functionName,this},Action.prototype.setLoadIndicator=function(loadIndicator){return this.indicator=loadIndicator,this},Action.prototype.setParameters=function(parameters){return this.parameters=parameters,this},Action}();exports.Action=require},{"../enums":61}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthorizationAction=void 0;var AuthorizationAction=function(){function AuthorizationAction(){}return AuthorizationAction.prototype.setAuthorizationUrl=function(authorizationUrl){return this.url=authorizationUrl,this},AuthorizationAction}();exports.AuthorizationAction=AuthorizationAction},{}],23:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardAction=void 0,require("../../../../gas-js/components")),event_1=require("../../../../gas-js/handlers/event"),actions_1=require("../../../../gas-js/stores/actions"),enums_1=require("../enums"),require=function(_super){function CardAction(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.composedEmailType=enums_1.ComposedEmailType.REPLY_AS_DRAFT,_this}return __extends(CardAction,_super),CardAction.prototype.setAuthorizationAction=function(action){return this.action=action,this},CardAction.prototype.setComposeAction=function(action,composedEmailType){return this.action=action,this.composedEmailType=composedEmailType,this},CardAction.prototype.setOnClickAction=function(action){return this.action=action,this},CardAction.prototype.setOnClickOpenLinkAction=function(action){return this.action=action,this},CardAction.prototype.setOpenLink=function(openLink){return this.action=openLink,this},CardAction.prototype.setText=function(text){return this.text=text,this},CardAction.prototype.create=function(){var wrapper,textElement,text=this.text,action=this.action;if(!text)throw new Error("card actions must have text set");if(action)return(wrapper=document.createElement("div")).classList.add("menu-item"),(textElement=document.createElement("p")).classList.add("menu-item-text"),textElement.textContent=text,wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,action),(0,event_1.handleEvent)(wrapper)}),wrapper.append(textElement),wrapper;throw new Error("card actions must have an action set")},CardAction}(components_1.RenderableComponent);exports.CardAction=require},{"../../../../gas-js/components":2,"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../enums":61}],24:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},DisplayCardsAction=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.DisplayCardsAction=void 0,function(){function DisplayCardsAction(){this.cards=[]}return DisplayCardsAction.prototype.getCards=function(){return __spreadArray([],__read(this.cards),!1)},DisplayCardsAction.prototype.setCards=function(cards){return this.cards=__spreadArray([],__read(cards),!1),this},DisplayCardsAction.prototype.displayCards=function(){return __awaiter(this,void 0,void 0,function(){var cards,parent,cards_1,cards_1_1,e_1_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:cards=this.getCards(),parent=document.getElementById("app-body"),_b.label=1;case 1:_b.trys.push([1,6,7,8]),cards_1=__values(cards),cards_1_1=cards_1.next(),_b.label=2;case 2:return cards_1_1.done?[3,5]:[4,cards_1_1.value.render(parent)];case 3:_b.sent(),_b.label=4;case 4:return cards_1_1=cards_1.next(),[3,2];case 5:return[3,8];case 6:return e_1_1=_b.sent(),e_1_1={error:e_1_1},[3,8];case 7:try{cards_1_1&&!cards_1_1.done&&(_a=cards_1.return)&&_a.call(cards_1)}finally{if(e_1_1)throw e_1_1.error}return[7];case 8:return[2,this]}})})},DisplayCardsAction}());exports.DisplayCardsAction=DisplayCardsAction},{}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenLink=void 0;var enums_1=require("../enums"),require=function(){function OpenLink(){this.onClose=enums_1.OnClose.NOTHING,this.openAs=enums_1.OpenAs.FULL_SIZE}return OpenLink.prototype.setOnClose=function(onClose){return this.onClose=onClose,this},OpenLink.prototype.setOpenAs=function(openAs){return this.openAs=openAs,this},OpenLink.prototype.setUrl=function(url){return this.url=url,this},OpenLink}();exports.OpenLink=require},{"../enums":61}],26:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalAction=void 0,require("../../../../gas-js/components")),events_1=require("../../../../gas-js/events"),event_1=require("../../../../gas-js/handlers/event"),actions_1=require("../../../../gas-js/stores/actions"),functions_1=require("../../../../gas-js/utils/functions"),display_cards_1=require("./display_cards"),require=function(_super){function UniversalAction(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(UniversalAction,_super),UniversalAction.prototype.getText=function(){var text=this.text;if(text)return text;throw new Error("universal actions must have text set")},UniversalAction.prototype.run=function(){var functionName=this.functionName;if(functionName)return(functionName=(0,functions_1.callFunctionFromGlobalScope)(functionName,new events_1.EventObject))instanceof Array?(new display_cards_1.DisplayCardsAction).setCards(functionName):window.CardServiceConfig.isInstance(functionName,"Card")?(new display_cards_1.DisplayCardsAction).setCards([functionName]):functionName;throw new Error("universal actions must have a function name set")},UniversalAction.prototype.setRunFunction=function(name){return this.functionName=name,this},UniversalAction.prototype.setText=function(text){return this.text=text,this},UniversalAction.prototype.create=function(){var _this=this,text=this.getText(),wrapper=document.createElement("div"),textElement=(wrapper.classList.add("menu-item"),document.createElement("p"));return textElement.classList.add("menu-item-text"),textElement.textContent=text,wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,_this.run()),(0,event_1.handleEvent)(wrapper)}),wrapper.append(textElement),wrapper},UniversalAction}(components_1.RenderableComponent);exports.UniversalAction=require},{"../../../../gas-js/components":2,"../../../../gas-js/events":7,"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/functions":90,"./display_cards":24}],27:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),action_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionResponseBuilder=void 0,require("../components/responses/action_response")),require=function(_super){function ActionResponseBuilder(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.stateChanged=!1,_this}return __extends(ActionResponseBuilder,_super),ActionResponseBuilder.prototype.build=function(){var response=new action_response_1.ActionResponse({navigation:this.navigation,notification:this.notification,openLink:this.openLink,stateChanged:this.stateChanged});return _super.prototype.build.call(this,response),response},ActionResponseBuilder.prototype.setNavigation=function(navigation){return this.navigation=navigation,this},ActionResponseBuilder.prototype.setNotification=function(notification){return this.notification=notification,this},ActionResponseBuilder.prototype.setOpenLink=function(openLink){return this.openLink=openLink,this},ActionResponseBuilder.prototype.setStateChanged=function(stateChanged){return this.stateChanged=stateChanged,this},ActionResponseBuilder.prototype.validate=function(){return[this.navigation,this.notification,this.openLink].some(Boolean)},ActionResponseBuilder}(require("./index").CardServiceBuilder);exports.ActionResponseBuilder=require},{"../components/responses/action_response":52,"./index":29}],28:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),card_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardBuilder=void 0,require("../components/card")),enums_1=require("../enums"),require=function(_super){function CardBuilder(menu){var _this=_super.call(this)||this;return _this.menu=menu,_this.actions=[],_this.sections=[],_this.style=enums_1.DisplayStyle.REPLACE,_this}return __extends(CardBuilder,_super),CardBuilder.prototype.addCardAction=function(cardAction){return this.actions.push(cardAction),this},CardBuilder.prototype.addSection=function(section){var sections=this.sections;if(100===sections.length)throw new Error("Can't add more than 100 sections to a card");return sections.push(section),this},CardBuilder.prototype.build=function(){var card=new card_1.Card(this.menu,{actions:this.actions,footer:this.footer,header:this.header,name:this.name,peekHeader:this.peekHeader,sections:this.sections,style:this.style});return _super.prototype.build.call(this,card)},CardBuilder.prototype.setDisplayStyle=function(displayStyle){return this.style=displayStyle,this},CardBuilder.prototype.setFixedFooter=function(fixedFooter){return this.footer=fixedFooter,this},CardBuilder.prototype.setHeader=function(cardHeader){return this.header=cardHeader,this},CardBuilder.prototype.setName=function(name){return this.name=name,this},CardBuilder.prototype.setPeekCardHeader=function(peekCardHeader){return this.peekHeader=peekCardHeader,this},CardBuilder.prototype.validate=function(){return!0},CardBuilder}(require("./index").CardServiceBuilder);exports.CardBuilder=require},{"../components/card":37,"../enums":61,"./index":29}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardServiceBuilder=void 0;var CardServiceBuilder=function(){function CardServiceBuilder(){}return CardServiceBuilder.prototype.build=function(item){if(this.validate())return item;throw new Error("Invalid ".concat(item.constructor.name))},CardServiceBuilder}();exports.CardServiceBuilder=CardServiceBuilder},{}],30:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),suggestions_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestionsResponseBuilder=void 0,require("../components/responses/suggestions_response")),require=function(_super){function SuggestionsResponseBuilder(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SuggestionsResponseBuilder,_super),SuggestionsResponseBuilder.prototype.build=function(){var response=new suggestions_response_1.SuggestionsResponse({suggestions:this.suggestions});return _super.prototype.build.call(this,response),response},SuggestionsResponseBuilder.prototype.setSuggestions=function(suggestions){return this.suggestions=suggestions,this},SuggestionsResponseBuilder.prototype.validate=function(){return!!this.suggestions},SuggestionsResponseBuilder}(require("./index").CardServiceBuilder);exports.SuggestionsResponseBuilder=require},{"../components/responses/suggestions_response":53,"./index":29}],31:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),universal_action_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalActionResponseBuilder=void 0,require("../components/responses/universal_action_response")),require=function(_super){function UniversalActionResponseBuilder(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.cards=[],_this}return __extends(UniversalActionResponseBuilder,_super),UniversalActionResponseBuilder.prototype.build=function(){var response=new universal_action_response_1.UniversalActionResponse({cards:this.cards,openLink:this.openLink});return _super.prototype.build.call(this,response),response},UniversalActionResponseBuilder.prototype.displayAddOnCards=function(cardObjects){return this.cards=cardObjects,this},UniversalActionResponseBuilder.prototype.setOpenLink=function(openLink){return this.openLink=openLink,this},UniversalActionResponseBuilder.prototype.validate=function(){var openLink=this.openLink;return[this.cards.length,openLink].some(Boolean)},UniversalActionResponseBuilder}(require("./index").CardServiceBuilder);exports.UniversalActionResponseBuilder=require},{"../components/responses/universal_action_response":54,"./index":29}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Attachment=void 0;var Attachment=function(){function Attachment(){}return Attachment.prototype.setIconUrl=function(iconUrl){return this.iconUrl=iconUrl,this},Attachment.prototype.setMimeType=function(mimeType){return this.mimeType=mimeType,this},Attachment.prototype.setResourceUrl=function(resourceUrl){return this.resourceUrl=resourceUrl,this},Attachment.prototype.setTitle=function(title){return this.title=title,this},Attachment}();exports.Attachment=Attachment},{}],33:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthorizationException=void 0;require=function(_super){function AuthorizationException(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AuthorizationException,_super),AuthorizationException.prototype.setAuthorizationUrl=function(authUrl){return this.authUrl=authUrl,this},AuthorizationException.prototype.setCustomUiCallback=function(callback){return this.callback=callback,this},AuthorizationException.prototype.setResourceDisplayName=function(name){return this.name=name,this},AuthorizationException.prototype.throwException=function(){var authUrl=this.authUrl,name=(this.callback,this.name);if(!authUrl)throw new Error("AuthorizationException must have an auth URL set");if(!name)throw new Error("AuthorizationException must have a name set")},AuthorizationException}(require("../index").InspectableComponent);exports.AuthorizationException=require},{"../index":62}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BorderStyle=void 0;var enums_1=require("../enums"),require=function(){function BorderStyle(){this.color="#000",this.type=enums_1.BorderType.NO_BORDER}return BorderStyle.prototype.setCornerRadius=function(radius){return this.radius=radius,this},BorderStyle.prototype.setStrokeColor=function(color){return this.color=color,this},BorderStyle.prototype.setType=function(type){return this.type=type,this},BorderStyle}();exports.BorderStyle=require},{"../enums":61}],35:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Button=void 0,require("../../../../gas-js/components")),enums_1=require("../enums"),require=function(_super){function Button(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.composedEmailType=enums_1.ComposedEmailType.REPLY_AS_DRAFT,_this}return __extends(Button,_super),Button.prototype.setAuthorizationAction=function(action){return this.action=action,this},Button.prototype.setComposeAction=function(action,composedEmailType){return this.action=action,this.composedEmailType=composedEmailType,this},Button.prototype.setOnClickAction=function(action){return this.action=action,this},Button.prototype.setOnClickOpenLinkAction=function(action){return this.action=action,this},Button.prototype.setOpenLink=function(openLink){return this.action=openLink,this},Button}(components_1.RenderableComponent);exports.Button=require},{"../../../../gas-js/components":2,"../enums":61}],36:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ButtonSet=void 0;require=function(_super){function ButtonSet(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.buttons=[],_this}return __extends(ButtonSet,_super),ButtonSet.prototype.addButton=function(button){return this.buttons.push(button),this},ButtonSet.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var buttons,wrapper,buttons_1,buttons_1_1,element,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:buttons=this.buttons,(wrapper=document.createElement("div")).classList.add("row"),_b.label=1;case 1:_b.trys.push([1,6,7,8]),buttons_1=__values(buttons),buttons_1_1=buttons_1.next(),_b.label=2;case 2:return buttons_1_1.done?[3,5]:[4,buttons_1_1.value.render(wrapper)];case 3:(element=_b.sent()).classList.add("SetElement"),element.classList.remove("row"),_b.label=4;case 4:return buttons_1_1=buttons_1.next(),[3,2];case 5:return[3,8];case 6:return element=_b.sent(),e_1={error:element},[3,8];case 7:try{buttons_1_1&&!buttons_1_1.done&&(_a=buttons_1.return)&&_a.call(buttons_1)}finally{if(e_1)throw e_1.error}return[7];case 8:return[2,wrapper]}})})},ButtonSet}(require("../../../../gas-js/components").RenderableComponent);exports.ButtonSet=require},{"../../../../gas-js/components":2}],37:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Card=void 0,require("../../../../gas-js/components")),enums_1=require("../enums"),require=function(_super){function Card(menu,config){var _this=_super.call(this)||this;return _this.menu=menu,_this.config=config,_this}return __extends(Card,_super),Object.defineProperty(Card.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),Card.prototype.create=function(){var wrapper=document.createElement("div");return wrapper.classList.add("Card"),wrapper},Card.prototype.render=function(parent){return __awaiter(this,void 0,void 0,function(){var menu,actions,footer,header,sections,element,renderedSections,shouldSeparate,sections_1,sections_1_1,peekHeader,_a,e_1,_b;return __generator(this,function(_c){switch(_c.label){case 0:if(menu=this.menu,_a=this.config,actions=_a.actions,footer=_a.footer,header=_a.header,peekHeader=_a.peekHeader,sections=_a.sections,_a=_a.style,peekHeader||_a===enums_1.DisplayStyle.PEEK)throw new Error("peek cards are not implemented");return menu.clear("card"),actions.forEach(function(action){return menu.addCardAction(action)}),[4,menu.render(document.getElementById("app-menu"))];case 1:return(_c.sent(),element=this.element||(this.element=this.create()),header)?[4,header.render(element)]:[3,3];case 2:_c.sent(),_c.label=3;case 3:renderedSections=[],shouldSeparate=1<sections.length,_c.label=4;case 4:_c.trys.push([4,9,10,11]),sections_1=__values(sections),sections_1_1=sections_1.next(),_c.label=5;case 5:return sections_1_1.done?[3,8]:[4,sections_1_1.value.render(element)];case 6:(peekHeader=_c.sent()).classList.toggle("separated",shouldSeparate),renderedSections.push(peekHeader),_c.label=7;case 7:return sections_1_1=sections_1.next(),[3,5];case 8:return[3,11];case 9:return _a=_c.sent(),e_1={error:_a},[3,11];case 10:try{sections_1_1&&!sections_1_1.done&&(_b=sections_1.return)&&_b.call(sections_1)}finally{if(e_1)throw e_1.error}return[7];case 11:return footer?[4,footer.render(element)]:[3,13];case 12:_c.sent(),_c.label=13;case 13:return[4,_super.prototype.render.call(this,parent)];case 14:return _c.sent(),renderedSections.forEach(function(element){element.dispatchEvent(new CustomEvent("collapse"))}),[2,element]}})})},Card}(components_1.RenderableComponent);exports.Card=require},{"../../../../gas-js/components":2,"../enums":61}],38:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardHeader=void 0,require("../../../../gas-js/components")),enums_1=require("../enums"),require=function(_super){function CardHeader(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.imageStyle=enums_1.ImageStyle.SQUARE,_this}return __extends(CardHeader,_super),CardHeader.prototype.setImageAltText=function(imageAltText){return this.imageAltText=imageAltText,this},CardHeader.prototype.setImageStyle=function(imageStyle){return this.imageStyle=imageStyle,this},CardHeader.prototype.setImageUrl=function(imageUrl){return this.imageUrl=imageUrl,this},CardHeader.prototype.setSubtitle=function(subtitle){return this.subtitle=subtitle,this},CardHeader.prototype.setTitle=function(title){return this.title=title,this},CardHeader.prototype.create=function(){var wrapper,imageElement,_a=this,imageUrl=_a.imageUrl,title=_a.title,imageAltText=_a.imageAltText,imageStyle=_a.imageStyle,_a=_a.subtitle;if(title)return(wrapper=document.createElement("div")).classList.add("CardHeader","separated-both"),imageUrl&&((imageElement=document.createElement("img")).src=imageUrl,imageElement.alt=imageAltText||"",imageElement.classList.add("headerIcon","style-".concat(imageStyle.toLowerCase())),wrapper.append(imageElement)),(imageUrl=document.createElement("p")).classList.add("ms-font-m-plus"),imageUrl.id="card-header-title",imageUrl.textContent=title,wrapper.append(imageUrl),_a&&((imageAltText=document.createElement("span")).classList.add("card-header-subtitle","ms-fontSize-14"),imageAltText.textContent=_a,wrapper.append(imageAltText)),wrapper;throw new Error("card header must have a title")},CardHeader}(components_1.RenderableComponent);exports.CardHeader=require},{"../../../../gas-js/components":2,"../enums":61}],39:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardSection=void 0,require("../../../../gas-js/components")),collapsibility_1=require("../../../../gas-js/utils/collapsibility"),toggler_1=require("../../../components/toggler"),require=function(_super){function CardSection(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.collapsible=!1,_this.numUncollapsibleWidgets=0,_this.toggler=new toggler_1.Toggler(!0),_this.widgets=[],_this}return __extends(CardSection,_super),CardSection.prototype.addWidget=function(widget){if(100===this.widgets.length)throw new Error("Can't add more than 100 widgets to a section");return this.widgets.push(widget),this},CardSection.prototype.setCollapsible=function(collapsible){return this.collapsible=collapsible,this},CardSection.prototype.setHeader=function(header){return this.header=header,this},CardSection.prototype.setNumUncollapsibleWidgets=function(numUncollapsibleWidgets){return this.numUncollapsibleWidgets=numUncollapsibleWidgets,this},CardSection.prototype.create=function(){var _this=this,_a=this,collapsible=_a.collapsible,header=_a.header,numUncollapsibleWidgets=_a.numUncollapsibleWidgets,toggler=_a.toggler,widgets=_a.widgets,wrapper=document.createElement("form");return wrapper.classList.add("card-section"),header&&((_a=document.createElement("p")).classList.add("ms-font-m-plus","card-section-header"),_a.textContent=header,wrapper.append(_a)),collapsible&&widgets.length>numUncollapsibleWidgets&&(wrapper.classList.add("collapsible"),toggler.setOnToggle(function(_togglerElement,_a){var collapsed=_a.collapsed;return __awaiter(_this,void 0,void 0,function(){var height;return __generator(this,function(_b){return height=(0,collapsibility_1.getUncollapsedHeight)(wrapper,collapsed?numUncollapsibleWidgets:widgets.length),wrapper.style.height="".concat(height,"px"),[2]})})}),wrapper.addEventListener("collapse",function(){var height=(0,collapsibility_1.getUncollapsedHeight)(wrapper,numUncollapsibleWidgets);wrapper.style.height="".concat(height,"px")})),wrapper},CardSection.prototype.render=function(parent){return __awaiter(this,void 0,void 0,function(){var collapsible,toggler,_a,element,widgets_1,widgets_1_1,e_1_1,_b;return __generator(this,function(_c){switch(_c.label){case 0:collapsible=(_a=this).collapsible,toggler=_a.toggler,_a=_a.widgets,element=this.element||(this.element=this.create()),_c.label=1;case 1:_c.trys.push([1,6,7,8]),widgets_1=__values(_a),widgets_1_1=widgets_1.next(),_c.label=2;case 2:return widgets_1_1.done?[3,5]:[4,widgets_1_1.value.render(element)];case 3:_c.sent(),_c.label=4;case 4:return widgets_1_1=widgets_1.next(),[3,2];case 5:return[3,8];case 6:return e_1_1=_c.sent(),e_1_1={error:e_1_1},[3,8];case 7:try{widgets_1_1&&!widgets_1_1.done&&(_b=widgets_1.return)&&_b.call(widgets_1)}finally{if(e_1_1)throw e_1_1.error}return[7];case 8:return[4,_super.prototype.render.call(this,parent)];case 9:return(_c.sent(),collapsible)?[4,toggler.render(parent)]:[3,11];case 10:_c.sent(),_c.label=11;case 11:return[2,element]}})})},CardSection}(components_1.RenderableComponent);exports.CardSection=require},{"../../../../gas-js/components":2,"../../../../gas-js/utils/collapsibility":88,"../../../components/toggler":6}],40:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},actions_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.DecoratedText=void 0,require("../../../../gas-js/stores/actions")),html_1=require("../../../../gas-js/utils/html"),require=function(_super){function DecoratedText(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.wrapText=!1,_this}return __extends(DecoratedText,_super),DecoratedText.prototype.setBottomLabel=function(text){return this.text=text,this},DecoratedText.prototype.setButton=function(button){return this.button=button,this},DecoratedText.prototype.setEndIcon=function(endIcon){return this.endIcon=endIcon,this},DecoratedText.prototype.setStartIcon=function(startIcon){return this.startIcon=startIcon,this},DecoratedText.prototype.setSwitchControl=function(switchToSet){return this.switchControl=switchToSet,this},DecoratedText.prototype.setText=function(text){return this.text=text,this},DecoratedText.prototype.setTopLabel=function(text){return this.topLabel=text,this},DecoratedText.prototype.setWrapText=function(wrapText){return this.wrapText=wrapText,this},DecoratedText.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var bottomLabel,button,endIcon,switchControl,text,topLabel,_a,wrapper,row,action,actionableWidgets,startIcon,topLabelElement,bottomLabelElement,rendered;return __generator(this,function(_b){switch(_b.label){case 0:if(action=(_a=this).action,bottomLabel=_a.bottomLabel,button=_a.button,endIcon=_a.endIcon,startIcon=_a.startIcon,switchControl=_a.switchControl,text=_a.text,topLabel=_a.topLabel,_a=_a.wrapText,!text)throw new Error("DecoratedText must have text set");if(1<(actionableWidgets=[button,endIcon,switchControl]).filter(Boolean).length)throw new Error("A DecoratedText can only support one button, one switch or one icon.");return((wrapper=document.createElement("div")).classList.add("KeyValue","ms-Grid","card-widget"),(row=document.createElement("div")).classList.add("ms-Grid-row","flex"),wrapper.append(row),action&&actions_1.ActionStore.bind("click",wrapper,action),action=actionableWidgets.some(Boolean)||startIcon?9:12,actionableWidgets=12-action,startIcon)?[4,startIcon.render(row)]:[3,2];case 1:_b.sent().classList.add("decorated-text-icon","ms-Grid-col","ms-sm".concat(actionableWidgets),"ms-md".concat(actionableWidgets),"ms-lg".concat(actionableWidgets)),_b.label=2;case 2:return((startIcon=document.createElement("div")).classList.add("decorated-text-content","ms-Grid-col","ms-sm".concat(action),"ms-md".concat(action),"ms-lg".concat(action)),row.append(startIcon),topLabel&&((topLabelElement=document.createElement("label")).classList.add("ms-fontSize-s","KeyValueTopLabel"),topLabelElement.textContent=topLabel,startIcon.append(topLabelElement)),(topLabelElement=document.createElement("span")).classList.add("ms-font-m-plus","KeyValueText"),startIcon.append(topLabelElement),(0,html_1.parseHTMLWidgetContent)(topLabelElement,_a?text:text.replace(/\r?\n/g," ")),bottomLabel&&((bottomLabelElement=document.createElement("label")).classList.add("ms-fontSize-s","KeyValueBottomLabel"),bottomLabelElement.textContent=bottomLabel,startIcon.append(bottomLabelElement)),bottomLabelElement=endIcon||button||switchControl)?[4,bottomLabelElement.render(row)]:[3,4];case 3:(rendered=_b.sent()).classList.remove("row"),rendered.classList.add("decorated-text-decoration","ms-Grid-col","ms-sm".concat(actionableWidgets),"ms-md".concat(actionableWidgets),"ms-lg".concat(actionableWidgets)),_b.label=4;case 4:return[2,wrapper]}})})},DecoratedText}(require("./button").Button);exports.DecoratedText=require},{"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/html":92,"./button":35}],41:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.Divider=void 0;require=function(_super){function Divider(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Divider,_super),Divider.prototype.create=function(){var element=document.createElement("hr");return element.classList.add("card-divider"),element},Divider}(require("../../../../gas-js/components").RenderableComponent);exports.Divider=require},{"../../../../gas-js/components":2}],42:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.FixedFooter=void 0,require("../../../../gas-js/components")),enums_1=require("../enums"),require=function(_super){function FixedFooter(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(FixedFooter,_super),FixedFooter.prototype.setPrimaryButton=function(button){if(button.textButtonStyle!==enums_1.TextButtonStyle.FILLED)throw new Error("The primary button must be a TextButtonStyle.FILLED button");return this.primary=button,this},FixedFooter.prototype.setSecondaryButton=function(button){if(this.primary){if(button.textButtonStyle!==enums_1.TextButtonStyle.TEXT)throw new Error("The secondary button must be a TextButtonStyle.TEXT button");this.secondary=button}return this},FixedFooter.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var primary,_a,wrapper,row;return __generator(this,function(_b){switch(_b.label){case 0:return(primary=(_a=this).primary,_a=_a.secondary,(wrapper=document.createElement("div")).classList.add("ms-Grid","card-fixed-footer"),(row=document.createElement("div")).classList.add("ms-Grid-row"),wrapper.append(row),primary)?[4,primary.render(row)]:[3,2];case 1:_b.sent().classList.add("ms-Grid-col","ms-sm6","ms-md6","ms-lg6"),_b.label=2;case 2:return _a?[4,_a.render(row)]:[3,4];case 3:_b.sent().classList.add("ms-Grid-col","ms-sm6","ms-md6","ms-lg6"),_b.label=4;case 4:return[2,wrapper]}})})},FixedFooter}(components_1.RenderableComponent);exports.FixedFooter=require},{"../../../../gas-js/components":2,"../enums":61}],43:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),border_style_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Grid=void 0,require("./border_style")),require=function(_super){function Grid(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.borderStyle=new border_style_1.BorderStyle,_this.items=[],_this.numColumns=1,_this}return __extends(Grid,_super),Grid.prototype.addItem=function(gridItem){return this.items.push(gridItem),this},Grid.prototype.setBorderStyle=function(borderStyle){return this.borderStyle=borderStyle,this},Grid.prototype.setNumColumns=function(numColumns){return this.numColumns=numColumns<1?1:3<numColumns?3:numColumns,this},Grid.prototype.setTitle=function(title){return this.title=title,this},Grid.prototype.create=function(){this.numColumns,this.title,this.borderStyle;var wrapper=document.createElement("div");return wrapper.classList.add("ms-Grid"),wrapper},Grid}(require("./button").Button);exports.Grid=require},{"./border_style":34,"./button":35}],44:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GridItem=void 0,require("../../../../gas-js/components")),enums_1=require("../enums"),require=function(_super){function GridItem(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.alignment=enums_1.HorizontalAlignment.START,_this.layout=enums_1.GridItemLayout.TEXT_BELOW,_this}return __extends(GridItem,_super),GridItem.prototype.setIdentifier=function(id){return this.id=id,this},GridItem.prototype.setImage=function(image){return this.image=image,this},GridItem.prototype.setLayout=function(layout){return this.layout=layout,this},GridItem.prototype.setSubtitle=function(subtitle){return this.subtitle=subtitle,this},GridItem.prototype.setTextAlignment=function(alignment){return this.alignment=alignment,this},GridItem.prototype.setTitle=function(title){return this.title=title,this},GridItem.prototype.create=function(){var _a=this,_a=(_a.alignment,_a.layout,_a.id,_a.image,_a.subtitle,_a.title,document.createElement("div"));return _a.classList.add("row","card-grid--item"),_a},GridItem}(components_1.RenderableComponent);exports.GridItem=require},{"../../../../gas-js/components":2,"../enums":61}],45:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.IconImage=void 0,require("../../../../gas-js/components")),url_1=require("../../../utils/url"),enums_1=require("../enums"),require=function(_super){function IconImage(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.icon=enums_1.Icon.NONE,_this.imageCropType=enums_1.ImageCropType.SQUARE,_this}return __extends(IconImage,_super),IconImage.prototype.setAltText=function(altText){return this.altText=altText,this},IconImage.prototype.setIcon=function(icon){return this.icon=icon,this},IconImage.prototype.setIconUrl=function(url){return this.url=url,this},IconImage.prototype.setImageCropType=function(imageCropType){return this.imageCropType=imageCropType,this},IconImage.prototype.create=function(){var isCardServiceIcon,image,_c=this.altText,_c=void 0===_c?"":_c,icon=this.icon,url=this.url,imageCropType=this.imageCropType,wrapper=document.createElement("div"),imageCropType=(wrapper.classList.add("card-iconimage","crop-".concat(imageCropType.toLowerCase())),icon||url);if(imageCropType)return isCardServiceIcon=icon in enums_1.Icon,url||isCardServiceIcon?((image=document.createElement("img")).alt=_c,image.height=20,image.src=isCardServiceIcon?"".concat((0,url_1.getNormalizedBaseURL)(),"/public/icons/").concat(imageCropType,".png"):imageCropType,image.width=20,wrapper.append(image)):(url=icon.startsWith("fa-"),icon&&url&&((_c=(image=document.createElement("i")).classList).add.apply(_c,__spreadArray(["card-icon-image-icon"],__read(icon.split(" ")),!1)),wrapper.append(image)),icon&&!url&&((image=document.createElement("span")).classList.add("card-icon-image-icon","material-icons"),image.textContent=icon,wrapper.append(image))),wrapper;throw new Error("IconImage must have either icon or icon URL set")},IconImage}(components_1.RenderableComponent);exports.IconImage=require},{"../../../../gas-js/components":2,"../../../utils/url":99,"../enums":61}],46:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),event_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageButton=void 0,require("../../../../gas-js/handlers/event")),actions_1=require("../../../../gas-js/stores/actions"),require=function(_super){function ImageButton(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ImageButton,_super),ImageButton.prototype.setAltText=function(altText){return this.altText=altText,this},ImageButton.prototype.setIcon=function(icon){return this.icon=icon,this},ImageButton.prototype.setIconUrl=function(url){return this.url=url,this},ImageButton.prototype.create=function(){var widget,image,action=this.action,altText=this.altText,icon=this.icon,url=this.url;if(!action)throw new Error("ImageButton must have at least one action set");if(!altText)throw new Error("ImageButton must have an alt text set");if(icon||url)return widget=document.createElement("div"),(image=document.createElement("img")).classList.add("ImageButton"),image.alt=altText,image.src=url||"".concat(location.origin,"/public/").concat(icon,".png"),image.title=altText,image.addEventListener("click",function(){actions_1.ActionStore.set(image,action),(0,event_1.handleEvent)(image)}),widget.append(image),widget;throw new Error("ImageButton must have either icon or icon URL set")},ImageButton}(require("./button").Button);exports.ImageButton=require},{"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"./button":35}],47:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageComponent=void 0,require("../../../../gas-js/components")),border_style_1=require("./border_style"),image_crop_style_1=require("./image_crop_style"),require=function(_super){function ImageComponent(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.borderStyle=new border_style_1.BorderStyle,_this.imageCropStyle=new image_crop_style_1.ImageCropStyle,_this}return __extends(ImageComponent,_super),ImageComponent.prototype.setAltText=function(altText){return this.altText=altText,this},ImageComponent.prototype.setBorderStyle=function(borderStyle){return this.borderStyle=borderStyle,this},ImageComponent.prototype.setCropStyle=function(imageCropStyle){return this.imageCropStyle=imageCropStyle,this},ImageComponent.prototype.setImageUrl=function(url){return this.url=url,this},ImageComponent.prototype.create=function(){var _b=this.altText,_b=void 0===_b?"":_b,_c=(this.borderStyle,this.imageCropStyle,this.url),_c=void 0===_c?"":_c,wrapper=document.createElement("div"),image=(wrapper.classList.add("row"),document.createElement("img"));return image.alt=_b,image.src=_c,wrapper.append(image),wrapper},ImageComponent}(components_1.RenderableComponent);exports.ImageComponent=require},{"../../../../gas-js/components":2,"./border_style":34,"./image_crop_style":48}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageCropStyle=void 0;var enums_1=require("../enums"),require=function(){function ImageCropStyle(){this.type=enums_1.ImageCropType.SQUARE}return ImageCropStyle.prototype.setAspectRatio=function(ratio){var type=this.type;if(type===enums_1.ImageCropType.RECTANGLE_CUSTOM){if(ratio<0)throw new Error("aspect ratio must be a positive value");this.ratio=ratio}return this},ImageCropStyle.prototype.setImageCropType=function(type){return this.type=type,this},ImageCropStyle}();exports.ImageCropStyle=require},{"../enums":61}],49:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},event_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyValue=void 0,require("../../../../gas-js/handlers/event")),actions_1=require("../../../../gas-js/stores/actions"),html_1=require("../../../../gas-js/utils/html"),require=function(_super){function KeyValue(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.multiline=!1,_this}return __extends(KeyValue,_super),KeyValue.prototype.setBottomLabel=function(text){return this.bottomLabel=text,this},KeyValue.prototype.setButton=function(button){return this.button=button,this},KeyValue.prototype.setContent=function(text){return this.content=text,this},KeyValue.prototype.setIcon=function(icon){return this.icon=icon,this},KeyValue.prototype.setIconAltText=function(altText){return this.iconAltText=altText,this},KeyValue.prototype.setIconUrl=function(url){return this.iconUrl=url,this},KeyValue.prototype.setMultiline=function(multiline){return this.multiline=multiline,this},KeyValue.prototype.setSwitch=function(switchToSet){return this.switchToSet=switchToSet,this},KeyValue.prototype.setTopLabel=function(text){return this.topLabel=text,this},KeyValue.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var action,bottomLabel,button,_b,multiline,switchToSet,wrapper,iconUrl,icon,img,_a,iconAltText;return __generator(this,function(_c){switch(_c.label){case 0:return(action=(_a=this).action,bottomLabel=_a.bottomLabel,button=_a.button,_b=_a.content,_b=void 0===_b?"":_b,icon=_a.icon,iconAltText=_a.iconAltText,iconUrl=_a.iconUrl,multiline=_a.multiline,switchToSet=_a.switchToSet,_a=_a.topLabel,(wrapper=document.createElement("div")).classList.add("KeyValue","row"),action&&wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,action),(0,event_1.handleEvent)(wrapper)}),(iconUrl=iconUrl||icon)&&((icon=document.createElement("div")).classList.add("column-icon"),wrapper.append(icon),(img=document.createElement("img")).classList.add("KeyValueImage"),img.src=iconUrl,iconAltText&&(img.alt=iconAltText),icon.append(img)),(iconUrl=document.createElement("div")).classList.add("column-text"),wrapper.append(iconUrl),_a&&((iconAltText=document.createElement("label")).classList.add("ms-fontSize-s","KeyValueTopLabel"),iconAltText.textContent=_a,iconUrl.append(iconAltText)),(icon=document.createElement("span")).classList.add("ms-font-m-plus","KeyValueText"),iconUrl.append(icon),(0,html_1.parseHTMLWidgetContent)(icon,multiline?_b:_b.replace(/\r?\n/g," ")),bottomLabel&&((img=document.createElement("label")).classList.add("ms-fontSize-s","KeyValueBottomLabel"),img.textContent=bottomLabel,iconUrl.append(img)),_a=button||switchToSet)?((iconAltText=document.createElement("div")).classList.add("column-label"),wrapper.append(iconAltText),[4,_a.render(iconAltText)]):[3,2];case 1:_c.sent(),_c.label=2;case 2:return[2,wrapper]}})})},KeyValue}(require("./button").Button);exports.KeyValue=require},{"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/html":92,"./button":35}],50:[function(require,module,exports){"use strict";var extendStatics,NavigationType,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),require=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Navigation=exports.PushNavigationAction=exports.NavigationAction=exports.NavigationType=void 0,require("../index")),NavigationAction=(!function(NavigationType){NavigationType.NAMED="NAMED",NavigationType.POP="POP",NavigationType.PUSH="PUSH",NavigationType.ROOT="ROOT"}(NavigationType=exports.NavigationType||(exports.NavigationType={})),function(type,name){this.type=type,this.name=name}),PushNavigationAction=function(_super){function PushNavigationAction(card){var _this=_super.call(this,NavigationType.PUSH)||this;return _this.card=card,_this}return __extends(PushNavigationAction,_super),PushNavigationAction}(exports.NavigationAction=NavigationAction),require=(exports.PushNavigationAction=PushNavigationAction,function(_super){function Navigation(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.actions=[],_this}return __extends(Navigation,_super),Navigation.prototype.popCard=function(){return this.actions.push(new NavigationAction(NavigationType.POP)),this},Navigation.prototype.popToNamedCard=function(cardName){return this.actions.push(new NavigationAction(NavigationType.NAMED,cardName)),this},Navigation.prototype.popToRoot=function(){return this.actions.push(new NavigationAction(NavigationType.ROOT)),this},Navigation.prototype.pushCard=function(card){return this.actions.push(new PushNavigationAction(card)),this},Navigation.prototype.updateCard=function(card){return this.actions.push(new NavigationAction(NavigationType.POP),new PushNavigationAction(card)),this},Navigation}(require.InspectableComponent));exports.Navigation=require},{"../index":62}],51:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.Notification=void 0;require=function(_super){function Notification(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.text="",_this}return __extends(Notification,_super),Notification.prototype.setText=function(text){return this.text=text,this},Notification.prototype.create=function(){var text=this.text,wrapper=document.createElement("div"),content=(wrapper.classList.add("ms-MessageBar"),document.createElement("div")),icon=(content.classList.add("ms-MessageBar-content"),wrapper.append(content),document.createElement("div")),icontent=(icon.classList.add("ms-MessageBar-icon"),content.append(icon),document.createElement("i")),icon=(icontent.classList.add("ms-Icon","ms-Icon--Info"),icon.append(icontent),document.createElement("div"));return icon.classList.add("ms-MessageBar-text"),icon.textContent=text,content.append(icon),wrapper},Notification.prototype.render=function(parent){var _this=this,parent=_super.prototype.render.call(this,parent);return new Promise(function(resolve){setTimeout(function(){_this.teardown(),resolve()},3e3)}),parent},Notification}(require("../../../../gas-js/components").RenderableComponent);exports.Notification=require},{"../../../../gas-js/components":2}],52:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionResponse=void 0;require=function(_super){function ActionResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(ActionResponse,_super),Object.defineProperty(ActionResponse.prototype,"navigation",{get:function(){return this.config.navigation},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"notification",{get:function(){return this.config.notification},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"openLink",{get:function(){return this.config.openLink},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"stateChanged",{get:function(){return this.config.stateChanged},enumerable:!1,configurable:!0}),ActionResponse}(require("../../index").InspectableComponent);exports.ActionResponse=require},{"../../index":62}],53:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestionsResponse=void 0;require=function(_super){function SuggestionsResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(SuggestionsResponse,_super),Object.defineProperty(SuggestionsResponse.prototype,"suggestions",{get:function(){return this.config.suggestions},enumerable:!1,configurable:!0}),SuggestionsResponse}(require("../../index").InspectableComponent);exports.SuggestionsResponse=require},{"../../index":62}],54:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalActionResponse=void 0;require=function(_super){function UniversalActionResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(UniversalActionResponse,_super),Object.defineProperty(UniversalActionResponse.prototype,"cards",{get:function(){return this.config.cards},enumerable:!1,configurable:!0}),Object.defineProperty(UniversalActionResponse.prototype,"openLink",{get:function(){return this.config.openLink},enumerable:!1,configurable:!0}),UniversalActionResponse}(require("../../index").InspectableComponent);exports.UniversalActionResponse=require},{"../../index":62}],55:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectionInput=exports.SelectionInputItem=void 0,require("../../../../gas-js/components")),event_1=require("../../../../gas-js/handlers/event"),actions_1=require("../../../../gas-js/stores/actions"),strings_1=require("../../../../gas-js/utils/strings"),log_1=require("../../../utils/log"),enums_1=require("../enums"),SelectionInputItem=function(_super){function SelectionInputItem(type,init){var _this=_super.call(this)||this;return _this.type=type,_this.init=init,_this}return __extends(SelectionInputItem,_super),SelectionInputItem.prototype.create=function(){var _a;return(_a={})[enums_1.SelectionInputType.CHECK_BOX]=function(_a){var action=_a.action,name=_a.name,text=_a.text,value=_a.value,_a=_a.selected,wrapper=document.createElement("div"),input=(wrapper.classList.add("ms-CheckBox"),document.createElement("input")),label=(input.classList.add("ms-CheckBox-input"),input.checked=_a,input.name=name,input.type="checkbox",input.value=value,wrapper.append(input),document.createElement("label")),name=(label.classList.add("ms-CheckBox-field"),label.classList.toggle("is-checked",_a),wrapper.append(label),document.createElement("span"));return name.classList.add("ms-Label"),name.textContent=text,label.append(name),action&&wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,action);var checked=input.checked;input.checked=!checked,label.classList.toggle("is-checked",!checked),(0,event_1.handleEvent)(wrapper)}),wrapper},_a[enums_1.SelectionInputType.DROPDOWN]=function(_a){var selected=_a.selected,text=_a.text,_a=_a.value,wrapper=document.createElement("option");return wrapper.selected=selected,wrapper.textContent=text,wrapper.value=_a,wrapper},_a[enums_1.SelectionInputType.RADIO_BUTTON]=function(_a){var action=_a.action,name=_a.name,selected=_a.selected,text=_a.text,_a=_a.value,wrapper=document.createElement("li"),input=(wrapper.classList.add("ms-RadioButton"),document.createElement("input")),name=(input.classList.add("ms-RadioButton-input"),input.checked=selected,input.name=name,input.type="radio",input.value=_a,wrapper.append(input),document.createElement("label")),_a=(name.classList.add("ms-RadioButton-field"),name.classList.toggle("is-checked",selected),wrapper.append(name),document.createElement("span"));return _a.classList.add("ms-Label"),_a.textContent=text,name.append(_a),action&&wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,action);var parentElement=wrapper.parentElement;if(!parentElement)throw new Error("disconnected input",{cause:wrapper});var inputs=__spreadArray([],__read(parentElement.getElementsByTagName("input")),!1),labels=__spreadArray([],__read(parentElement.getElementsByTagName("label")),!1);inputs.forEach(function(item,index){var selected=item===input;item.checked=selected,labels[index].classList.toggle("is-checked",selected)}),(0,event_1.handleEvent)(wrapper)}),wrapper},_a[this.type](this.init)},SelectionInputItem}(components_1.RenderableComponent),require=(exports.SelectionInputItem=SelectionInputItem,function(_super){function SelectionInput(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.items=[],_this.type=enums_1.SelectionInputType.CHECK_BOX,_this}return __extends(SelectionInput,_super),SelectionInput.prototype.addItem=function(text,value,selected){return this.items.push({text:(0,strings_1.safeToString)(text),value:(0,strings_1.safeToString)(value),selected:selected}),this},SelectionInput.prototype.setFieldName=function(fieldName){return this.fieldName=fieldName,this},SelectionInput.prototype.setOnChangeAction=function(action){return this.action=action,this},SelectionInput.prototype.setTitle=function(title){return this.title=title,this},SelectionInput.prototype.setType=function(type){return this.type=type,this},SelectionInput.prototype.renderItems=function(name,parent){return __awaiter(this,void 0,void 0,function(){var action,type,_a,items_1,items_1_1,props,e_1,_b;return __generator(this,function(_c){switch(_c.label){case 0:action=(_a=this).action,type=_a.type,_a=_a.items,_c.label=1;case 1:_c.trys.push([1,6,7,8]),items_1=__values(_a),items_1_1=items_1.next(),_c.label=2;case 2:return items_1_1.done?[3,5]:(props=items_1_1.value,[4,new SelectionInputItem(type,__assign(__assign({},props),{name:name,action:action})).render(parent)]);case 3:_c.sent(),_c.label=4;case 4:return items_1_1=items_1.next(),[3,2];case 5:return[3,8];case 6:return props=_c.sent(),e_1={error:props},[3,8];case 7:try{items_1_1&&!items_1_1.done&&(_b=items_1.return)&&_b.call(items_1)}finally{if(e_1)throw e_1.error}return[7];case 8:return[2]}})})},SelectionInput.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var fieldName,_a,widget,content,_b,_this=this;return __generator(this,function(_c){switch(_c.label){case 0:if(fieldName=(_a=this).fieldName,_a=_a.type,!fieldName)throw new Error("SelectionInput must have field name set");(widget=document.createElement("div")).classList.add("ms-Grid","selection-input","card-widget"),(_b={})[enums_1.SelectionInputType.CHECK_BOX]=function(name){return __awaiter(_this,void 0,void 0,function(){var column;return __generator(this,function(_a){switch(_a.label){case 0:return(column=document.createElement("div")).classList.add("column"),widget.append(column),[4,this.renderItems(name,column)];case 1:return _a.sent(),[2,column]}})})},_b[enums_1.SelectionInputType.DROPDOWN]=function(name,_a){var action=_a.action,title=_a.title;return __awaiter(_this,void 0,void 0,function(){var wrapper,label,input,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(wrapper=document.createElement("div")).classList.add("ms-Dropdown"),widget.append(wrapper),title&&((label=document.createElement("label")).classList.add("ms-Label","SelectionInputTopLabel"),label.textContent=title,wrapper.append(label)),(label=document.createElement("i")).classList.add("ms-Dropdown-caretDown","ms-Icon","ms-Icon--ChevronDown"),wrapper.append(label),(input=document.createElement("select")).classList.add("ms-Dropdown-select"),input.name=name,wrapper.append(input),[4,this.renderItems(name,input)];case 1:return _c.sent(),action&&input.addEventListener("change",function(){actions_1.ActionStore.set(widget,action),(0,event_1.handleEvent)(input)}),new fabric.Dropdown(wrapper),null!=(_b=wrapper.querySelector(".ms-Dropdown-truncator"))&&_b.classList.add("hidden"),[2,wrapper]}})})},_b[enums_1.SelectionInputType.RADIO_BUTTON]=function(name){return __awaiter(_this,void 0,void 0,function(){var column,group,list;return __generator(this,function(_a){switch(_a.label){case 0:return(column=document.createElement("div")).classList.add("column"),widget.append(column),(group=document.createElement("div")).classList.add("ms-ChoiceFieldGroup"),column.append(group),(list=document.createElement("ul")).classList.add("ms-ChoiceFieldGroup-list"),group.append(list),[4,this.renderItems(name,list)];case 1:return _a.sent(),[2,column]}})})},_b=_b,_c.label=1;case 1:return _c.trys.push([1,3,,4]),[4,_b[_a](fieldName,this)];case 2:return content=_c.sent(),widget.append(content),[3,4];case 3:return content=_c.sent(),(0,log_1.log)("error","failed to create SelectionInput content",(0,strings_1.safeToString)(content)),[3,4];case 4:return[2,widget]}})})},SelectionInput}(components_1.RenderableComponent));exports.SelectionInput=require},{"../../../../gas-js/components":2,"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/strings":98,"../../../utils/log":94,"../enums":61}],56:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},Suggestions=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Suggestions=void 0,function(){function Suggestions(){this.suggestions=[]}return Suggestions.prototype.addSuggestion=function(suggestion){return this.suggestions.push(suggestion),this},Suggestions.prototype.addSuggestions=function(suggestions){var _a;return(_a=this.suggestions).push.apply(_a,__spreadArray([],__read(suggestions),!1)),this},Suggestions}());exports.Suggestions=Suggestions},{}],57:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Switch=void 0,require("../../../../gas-js/components")),event_1=require("../../../../gas-js/handlers/event"),actions_1=require("../../../../gas-js/stores/actions"),strings_1=require("../../../../gas-js/utils/strings"),enums_1=require("../enums"),require=function(_super){function Switch(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.controlType=enums_1.SwitchControlType.SWITCH,_this.selected=!1,_this}return __extends(Switch,_super),Switch.prototype.setControlType=function(controlType){return this.controlType=controlType,this},Switch.prototype.setFieldName=function(fieldName){return this.fieldName=fieldName,this},Switch.prototype.setOnChangeAction=function(action){return this.action=action,this},Switch.prototype.setSelected=function(selected){return this.selected=selected,this},Switch.prototype.setValue=function(value){return this.value=(0,strings_1.safeToString)(value),value},Switch.prototype.create=function(){var _a=this,action=_a.action,controlType=_a.controlType,fieldName=_a.fieldName,_b=_a.selected,_b=void 0!==_b&&_b,_a=_a.value,_a=void 0===_a?"":_a;if(!fieldName)throw new Error("Switch must have a field name set");if(controlType!==enums_1.SwitchControlType.SWITCH)throw new Error("checkbox control type is not implemented");var wrapper=document.createElement("div"),controlType=(wrapper.classList.add("ms-Toggle","ms-font-m-plus","Switch"),document.createElement("input")),fieldName=(controlType.classList.add("ms-Toggle-input"),controlType.classList.toggle("is-selected",_b),controlType.id=controlType.name=fieldName,controlType.type="checkbox",controlType.value=_a,wrapper.append(controlType),action&&wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,action),(0,event_1.handleEvent)(wrapper)}),document.createElement("label"));return fieldName.classList.add("ms-Toggle-field"),fieldName.classList.toggle("is-selected",_b),wrapper.append(fieldName),new fabric.Toggle(wrapper),wrapper},Switch}(components_1.RenderableComponent);exports.Switch=require},{"../../../../gas-js/components":2,"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/strings":98,"../enums":61}],58:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),event_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextButton=void 0,require("../../../../gas-js/handlers/event")),actions_1=require("../../../../gas-js/stores/actions"),html_1=require("../../../../gas-js/utils/html"),enums_1=require("../enums"),require=function(_super){function TextButton(backgroundColor){var _this=_super.call(this)||this;return _this.backgroundColor=backgroundColor,_this.disabled=!1,_this.textButtonStyle=enums_1.TextButtonStyle.TEXT,_this}return __extends(TextButton,_super),TextButton.prototype.setAltText=function(altText){return this.altText=altText,this},TextButton.prototype.setBackgroundColor=function(backgroundColor){return this.backgroundColor=backgroundColor,this},TextButton.prototype.setDisabled=function(disabled){return this.disabled=disabled,this},TextButton.prototype.setText=function(text){return this.text=text,this},TextButton.prototype.setTextButtonStyle=function(textButtonStyle){return this.textButtonStyle=textButtonStyle,this},TextButton.prototype.create=function(){var _a=this,action=_a.action,altText=_a.altText,backgroundColor=_a.backgroundColor,disabled=_a.disabled,textButtonStyle=_a.textButtonStyle,_a=_a.text,_a=void 0===_a?"":_a,wrapper=document.createElement("div"),button=(wrapper.classList.add("row"),document.createElement("div")),disabled=(button.classList.add("TextButton"),button.classList.toggle("btn--disabled",disabled),button.ariaLabel=altText||(0,html_1.stripHTMLMarkup)(_a),textButtonStyle===enums_1.TextButtonStyle.FILLED);if(button.style[disabled?"backgroundColor":"color"]=backgroundColor,button.classList.add("text-btn--".concat(disabled?"filled":"text")),(0,html_1.parseHTMLWidgetContent)(button,_a),action)return button.addEventListener("click",function(){actions_1.ActionStore.set(button,action),(0,event_1.handleEvent)(button)}),wrapper.append(button),wrapper;throw new Error("TextButton must have at least one action set")},TextButton}(require("./button").Button);exports.TextButton=require},{"../../../../gas-js/handlers/event":12,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/html":92,"../enums":61,"./button":35}],59:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextInput=void 0,require("../../../../gas-js/components")),actions_1=require("../../../../gas-js/stores/actions"),guards_1=require("../../../../gas-js/utils/guards"),strings_1=require("../../../../gas-js/utils/strings"),require=function(_super){function TextInput(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.multiline=!1,_this}return __extends(TextInput,_super),TextInput.prototype.setFieldName=function(fieldName){return this.fieldName=fieldName,this},TextInput.prototype.setHint=function(hint){return this.hint=hint,this},TextInput.prototype.setMultiline=function(multiline){return this.multiline=multiline,this},TextInput.prototype.setOnChangeAction=function(action){return this.action=action,this},TextInput.prototype.setSuggestions=function(suggestions){return this.suggestions=suggestions,this},TextInput.prototype.setSuggestionsAction=function(suggestionsAction){return this.suggestionsAction=suggestionsAction,this},TextInput.prototype.setTitle=function(title){return this.title=title,this},TextInput.prototype.setValue=function(value){return this.value=(0,strings_1.safeToString)(value),this},TextInput.prototype.create=function(){var _this=this,_a=this,action=_a.action,fieldName=_a.fieldName,hint=_a.hint,_b=_a.multiline,_b=void 0!==_b&&_b,suggestions=_a.suggestions,suggestionsAction=_a.suggestionsAction,title=_a.title,_a=_a.value,_a=void 0===_a?"":_a;if(!fieldName)throw new Error("TextInput must have a field name set");if(!title)throw new Error("TextInput must have a title set");if(suggestions||suggestionsAction)throw new Error("suggestions are not implemented");var suggestions=document.createElement("div"),suggestionsAction=(suggestions.classList.add("text-input","card-widget","ms-Grid"),document.createElement("div")),title=(suggestionsAction.classList.add("column"),suggestions.append(suggestionsAction),title&&((topLabel=document.createElement("label")).classList.add("ms-fontSize-s","text-input-label--top"),topLabel.textContent=title,suggestionsAction.append(topLabel)),document.createElement("div")),topLabel=(title.classList.add("ms-TextField","ms-TextField--underlined"),suggestionsAction.append(title),document.createElement("label")),topLabel=(topLabel.classList.add("ms-Label","text-input-label"),title.append(topLabel),document.createElement(_b?"textarea":"input"));return topLabel.classList.add("ms-TextField-field","text-input-input"),topLabel.name=fieldName,topLabel.value=_a,title.append(topLabel),(0,guards_1.isHTMLTextAreaElement)(topLabel)||(topLabel.type="text"),topLabel.addEventListener("keydown",function(event){event instanceof KeyboardEvent&&"Enter"===event.key&&(event.preventDefault(),_this.value+="\r")}),action&&actions_1.ActionStore.bind("focusout",suggestions,action),hint&&((_b=document.createElement("label")).classList.add("ms-fontSize-s","text-input-label--bottom"),_b.textContent=hint,suggestionsAction.append(_b)),new fabric.TextField(title),suggestions},TextInput}(components_1.RenderableComponent);exports.TextInput=require},{"../../../../gas-js/components":2,"../../../../gas-js/stores/actions":83,"../../../../gas-js/utils/guards":91,"../../../../gas-js/utils/strings":98}],60:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextParagraph=void 0,require("../../../../gas-js/components")),html_1=require("../../../../gas-js/utils/html"),require=function(_super){function TextParagraph(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TextParagraph,_super),TextParagraph.prototype.setText=function(text){return this.text=text,this},TextParagraph.prototype.create=function(){var wrapper,contentText,text=this.text;if(text)return(wrapper=document.createElement("div")).classList.add("row"),(contentText=document.createElement("span")).classList.add("ms-font-m-plus"),wrapper.append(contentText),(0,html_1.parseHTMLWidgetContent)(contentText,text),wrapper;throw new Error("TextParagraph must have text set")},TextParagraph}(components_1.RenderableComponent);exports.TextParagraph=require},{"../../../../gas-js/components":2,"../../../../gas-js/utils/html":92}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateDraftBodyType=exports.TextButtonStyle=exports.SwitchControlType=exports.SelectionInputType=exports.OpenAs=exports.OnClose=exports.LoadIndicator=exports.ImageStyle=exports.ImageCropType=exports.Icon=exports.HorizontalAlignment=exports.GridItemLayout=exports.DisplayStyle=exports.ContentType=exports.ComposedEmailType=exports.BorderType=void 0,function(BorderType){BorderType.NO_BORDER="NO_BORDER",BorderType.STROKE="STROKE"}(exports.BorderType||(exports.BorderType={})),function(ComposedEmailType){ComposedEmailType.REPLY_AS_DRAFT="REPLY_AS_DRAFT",ComposedEmailType.STANDALONE_DRAFT="STANDALONE_DRAFT"}(exports.ComposedEmailType||(exports.ComposedEmailType={})),function(ContentType){ContentType.TEXT="TEXT",ContentType.MUTABLE_HTML="MUTABLE_HTML",ContentType.IMMUTABLE_HTML="IMMUTABLE_HTML"}(exports.ContentType||(exports.ContentType={})),function(DisplayStyle){DisplayStyle.REPLACE="REPLACE",DisplayStyle.PEEK="PEEK"}(exports.DisplayStyle||(exports.DisplayStyle={})),function(GridItemLayout){GridItemLayout.TEXT_BELOW="TEXT_BELOW",GridItemLayout.TEXT_ABOVE="TEXT_ABOVE"}(exports.GridItemLayout||(exports.GridItemLayout={})),function(HorizontalAlignment){HorizontalAlignment.START="START",HorizontalAlignment.CENTER="CENTER",HorizontalAlignment.END="END"}(exports.HorizontalAlignment||(exports.HorizontalAlignment={})),function(Icon){Icon.NONE="",Icon.AIRPLANE="AIRPLANE",Icon.BOOKMARK="BOOKMARK",Icon.BUS="BUS",Icon.CAR="CAR",Icon.CLOCK="CLOCK",Icon.CONFIRMATION_NUMBER_ICON="CONFIRMATION_NUMBER_ICON",Icon.DOLLAR="DOLLAR",Icon.DESCRIPTION="DESCRIPTION",Icon.EMAIL="EMAIL",Icon.EVENT_PERFORMER="EVENT_PERFORMER",Icon.EVENT_SEAT="EVENT_SEAT",Icon.FLIGHT_ARRIVAL="FLIGHT_ARRIVAL",Icon.FLIGHT_DEPARTURE="FLIGHT_DEPARTURE",Icon.HOTEL="HOTEL",Icon.HOTEL_ROOM_TYPE="HOTEL_ROOM_TYPE",Icon.INVITE="INVITE",Icon.MAP_PIN="MAP_PIN",Icon.MEMBERSHIP="MEMBERSHIP",Icon.MULTIPLE_PEOPLE="MULTIPLE_PEOPLE",Icon.OFFER="OFFER",Icon.PERSON="PERSON",Icon.PHONE="PHONE",Icon.RESTAURANT_ICON="RESTAURANT_ICON",Icon.SHOPPING_CART="SHOPPING_CART",Icon.STAR="STAR",Icon.STORE="STORE",Icon.TICKET="TICKET",Icon.TRAIN="TRAIN",Icon.VIDEO_CAMERA="VIDEO_CAMERA",Icon.VIDEO_PLAY="VIDEO_PLAY"}(exports.Icon||(exports.Icon={})),function(ImageCropType){ImageCropType.SQUARE="SQUARE",ImageCropType.CIRCLE="CIRCLE",ImageCropType.RECTANGLE_CUSTOM="RECTANGLE_CUSTOM",ImageCropType.RECTANGLE_4_3="RECTANGLE_4_3"}(exports.ImageCropType||(exports.ImageCropType={})),function(ImageStyle){ImageStyle.SQUARE="SQUARE",ImageStyle.CIRCLE="CIRCLE"}(exports.ImageStyle||(exports.ImageStyle={})),function(LoadIndicator){LoadIndicator.SPINNER="SPINNER",LoadIndicator.NONE="NONE"}(exports.LoadIndicator||(exports.LoadIndicator={})),function(OnClose){OnClose.NOTHING="NOTHING",OnClose.RELOAD="RELOAD"}(exports.OnClose||(exports.OnClose={})),function(OpenAs){OpenAs.FULL_SIZE="FULL_SIZE",OpenAs.OVERLAY="OVERLAY"}(exports.OpenAs||(exports.OpenAs={})),function(SelectionInputType){SelectionInputType.CHECK_BOX="CHECK_BOX",SelectionInputType.RADIO_BUTTON="RADIO_BUTTON",SelectionInputType.DROPDOWN="DROPDOWN"}(exports.SelectionInputType||(exports.SelectionInputType={})),function(SwitchControlType){SwitchControlType.SWITCH="SWITCH",SwitchControlType.CHECK_BOX="CHECK_BOX"}(exports.SwitchControlType||(exports.SwitchControlType={})),function(TextButtonStyle){TextButtonStyle.TEXT="TEXT",TextButtonStyle.FILLED="FILLED"}(exports.TextButtonStyle||(exports.TextButtonStyle={})),function(UpdateDraftBodyType){UpdateDraftBodyType.IN_PLACE_INSERT="IN_PLACE_INSERT",UpdateDraftBodyType.INSERT_AT_START="INSERT_AT_START",UpdateDraftBodyType.INSERT_AT_END="INSERT_AT_END"}(exports.UpdateDraftBodyType||(exports.UpdateDraftBodyType={}))},{}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InspectableComponent=void 0;var InspectableComponent=function(){function InspectableComponent(){}return InspectableComponent.prototype.printJson=function(){return JSON.stringify(this)},InspectableComponent}();exports.InspectableComponent=InspectableComponent},{}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardService=exports.CardServiceConfig=void 0;var _a,card_1=require("../../stores/card"),action_1=require("./actions/action"),authorization_1=require("./actions/authorization"),card_2=require("./actions/card"),display_cards_1=require("./actions/display_cards"),open_link_1=require("./actions/open_link"),action_response_1=require("./builders/action_response"),card_3=require("./builders/card"),suggestions_response_1=require("./builders/suggestions_response"),universal_action_response_1=require("./builders/universal_action_response"),attachment_1=require("./components/attachment"),authorization_exception_1=require("./components/authorization_exception"),border_style_1=require("./components/border_style"),button_set_1=require("./components/button_set"),card_4=require("./components/card"),card_header_1=require("./components/card_header"),card_section_1=require("./components/card_section"),decorated_text_1=require("./components/decorated_text"),divider_1=require("./components/divider"),fixed_footer_1=require("./components/fixed_footer"),grid_1=require("./components/grid"),grid_item_1=require("./components/grid_item"),icon_image_1=require("./components/icon_image"),image_button_1=require("./components/image_button"),image_component_1=require("./components/image_component"),image_crop_style_1=require("./components/image_crop_style"),key_value_1=require("./components/key_value"),navigation_1=require("./components/navigation"),notification_1=require("./components/notification"),action_response_2=require("./components/responses/action_response"),suggestions_response_2=require("./components/responses/suggestions_response"),universal_action_response_2=require("./components/responses/universal_action_response"),selection_input_1=require("./components/selection_input"),suggestions_1=require("./components/suggestions"),switch_1=require("./components/switch"),text_button_1=require("./components/text_button"),text_input_1=require("./components/text_input"),text_paragraph_1=require("./components/text_paragraph"),enums_1=require("./enums"),CardServiceConfig=function(){function CardServiceConfig(){}return CardServiceConfig.isInstance=function(instance,className){return instance instanceof this.classes[className]},CardServiceConfig.set=function(name,value){return this[name]=value,this},CardServiceConfig.validate=function(){var _this=this;["menu","primaryColor","secondaryColor"].forEach(function(key){if(!_this[key])throw new Error('CardService config is missing "'.concat(key,'"'))})},CardServiceConfig.CardStore=card_1.CardStore,CardServiceConfig.classes=((_a={})[action_1.Action.name]=action_1.Action,_a[card_4.Card.name]=card_4.Card,_a[display_cards_1.DisplayCardsAction.name]=display_cards_1.DisplayCardsAction,_a[action_response_2.ActionResponse.name]=action_response_2.ActionResponse,_a[open_link_1.OpenLink.name]=open_link_1.OpenLink,_a[suggestions_response_2.SuggestionsResponse.name]=suggestions_response_2.SuggestionsResponse,_a[universal_action_response_2.UniversalActionResponse.name]=universal_action_response_2.UniversalActionResponse,_a),CardServiceConfig}(),require=(exports.CardServiceConfig=CardServiceConfig,function(){function CardService(){this.BorderType=enums_1.BorderType,this.ComposedEmailType=enums_1.ComposedEmailType,this.DisplayStyle=enums_1.DisplayStyle,this.GridItemLayout=enums_1.GridItemLayout,this.HorizontalAlignment=enums_1.HorizontalAlignment,this.Icon=enums_1.Icon,this.ImageCropType=enums_1.ImageCropType,this.LoadIndicator=enums_1.LoadIndicator,this.OnClose=enums_1.OnClose,this.OpenAs=enums_1.OpenAs,this.SelectionInputType=enums_1.SelectionInputType,this.SwitchControlType=enums_1.SwitchControlType,this.TextButtonStyle=enums_1.TextButtonStyle}return CardService.prototype.newAction=function(){return new action_1.Action},CardService.prototype.newActionResponseBuilder=function(){return new action_response_1.ActionResponseBuilder},CardService.prototype.newAttachment=function(){return new attachment_1.Attachment},CardService.prototype.newAuthorizationAction=function(){return new authorization_1.AuthorizationAction},CardService.prototype.newAuthorizationException=function(){return new authorization_exception_1.AuthorizationException},CardService.prototype.newBorderStyle=function(){return new border_style_1.BorderStyle},CardService.prototype.newButtonSet=function(){return new button_set_1.ButtonSet},CardService.prototype.newCalendarEventActionResponseBuilder=function(){},CardService.prototype.newCardAction=function(){return new card_2.CardAction},CardService.prototype.newCardBuilder=function(){return new card_3.CardBuilder(CardServiceConfig.menu)},CardService.prototype.newCardHeader=function(){return new card_header_1.CardHeader},CardService.prototype.newCardSection=function(){return new card_section_1.CardSection},CardService.prototype.newComposeActionResponseBuilder=function(){},CardService.prototype.newDatePicker=function(){},CardService.prototype.newDateTimePicker=function(){},CardService.prototype.newDecoratedText=function(){return new decorated_text_1.DecoratedText},CardService.prototype.newDivider=function(){return new divider_1.Divider},CardService.prototype.newDriveItemsSelectedActionResponseBuilder=function(){},CardService.prototype.newEditorFileScopeActionResponseBuilder=function(){},CardService.prototype.newFixedFooter=function(){return new fixed_footer_1.FixedFooter},CardService.prototype.newGrid=function(){return new grid_1.Grid},CardService.prototype.newGridItem=function(){return new grid_item_1.GridItem},CardService.prototype.newIconImage=function(){return new icon_image_1.IconImage},CardService.prototype.newImage=function(){return new Image(268)},CardService.prototype.newImageButton=function(){return new image_button_1.ImageButton},CardService.prototype.newImageComponent=function(){return new image_component_1.ImageComponent},CardService.prototype.newImageCropStyle=function(){return new image_crop_style_1.ImageCropStyle},CardService.prototype.newKeyValue=function(){return new key_value_1.KeyValue},CardService.prototype.newNavigation=function(){return new navigation_1.Navigation},CardService.prototype.newNotification=function(){return new notification_1.Notification},CardService.prototype.newOpenLink=function(){return new open_link_1.OpenLink},CardService.prototype.newSelectionInput=function(){return new selection_input_1.SelectionInput},CardService.prototype.newSuggestions=function(){return new suggestions_1.Suggestions},CardService.prototype.newSuggestionsResponseBuilder=function(){return new suggestions_response_1.SuggestionsResponseBuilder},CardService.prototype.newSwitch=function(){return new switch_1.Switch},CardService.prototype.newTextButton=function(){return new text_button_1.TextButton(CardServiceConfig.secondaryColor)},CardService.prototype.newTextInput=function(){return new text_input_1.TextInput},CardService.prototype.newTextParagraph=function(){return new text_paragraph_1.TextParagraph},CardService.prototype.newTimePicker=function(){},CardService.prototype.newUniversalActionResponseBuilder=function(){return new universal_action_response_1.UniversalActionResponseBuilder},CardService.prototype.newUpdateDraftActionResponseBuilder=function(){},CardService.prototype.newUpdateDraftBccRecipientsAction=function(){},CardService.prototype.newUpdateDraftBodyAction=function(){},CardService.prototype.newUpdateDraftCcRecipientsAction=function(){},CardService.prototype.newUpdateDraftSubjectAction=function(){},CardService.prototype.newUpdateDraftToRecipientsAction=function(){},CardService}());exports.CardService=require},{"../../stores/card":84,"./actions/action":21,"./actions/authorization":22,"./actions/card":23,"./actions/display_cards":24,"./actions/open_link":25,"./builders/action_response":27,"./builders/card":28,"./builders/suggestions_response":30,"./builders/universal_action_response":31,"./components/attachment":32,"./components/authorization_exception":33,"./components/border_style":34,"./components/button_set":36,"./components/card":37,"./components/card_header":38,"./components/card_section":39,"./components/decorated_text":40,"./components/divider":41,"./components/fixed_footer":42,"./components/grid":43,"./components/grid_item":44,"./components/icon_image":45,"./components/image_button":46,"./components/image_component":47,"./components/image_crop_style":48,"./components/key_value":49,"./components/navigation":50,"./components/notification":51,"./components/responses/action_response":52,"./components/responses/suggestions_response":53,"./components/responses/universal_action_response":54,"./components/selection_input":55,"./components/suggestions":56,"./components/switch":57,"./components/text_button":58,"./components/text_input":59,"./components/text_paragraph":60,"./enums":61}],64:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailAttachment=void 0;require=function(_super){function GmailAttachment(item){var _this=_super.call(this)||this;return _this.item=item,_this}return __extends(GmailAttachment,_super),GmailAttachment.prototype.getSize=function(){return this.item.size},GmailAttachment}(require("../../base/blob").Blob);exports.GmailAttachment=require},{"../../base/blob":16}],65:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},graph_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailDraft=void 0,require("../graph")),message_1=require("./message"),require=function(){function GmailDraft(item){this.item=item}return GmailDraft.prototype.deleteDraft=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.deleteMessage(this.getId())];case 1:return _a.sent(),[2,this]}})})},GmailDraft.prototype.getId=function(){return this.item.id},GmailDraft.prototype.getMessage=function(){return new message_1.GmailMessage(this.item)},GmailDraft.prototype.getMessageId=function(){return this.getMessage().getId()},GmailDraft.prototype.send=function(){return __awaiter(this,void 0,void 0,function(){var id,_a;return __generator(this,function(_b){switch(_b.label){case 0:return id=this.getId(),[4,graph_1.MailboxAPI.sendMessageById(id)];case 1:return _b.sent(),_a=this,[4,graph_1.MailboxAPI.getMessage(id)];case 2:return _a.item=_b.sent(),[2,this.getMessage()]}})})},GmailDraft.prototype.update=function(recipient,subject,body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var cc,from,name,replyTo,htmlBody,bcc;return __generator(this,function(_b){switch(_b.label){case 0:return bcc=options.bcc,cc=options.cc,htmlBody=options.htmlBody,from=options.from,name=options.name,replyTo=options.replyTo,htmlBody={body:{content:htmlBody||body,contentType:"html"},subject:subject,toRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(recipient)},bcc&&(htmlBody.bccRecipients=graph_1.MailboxAPI.mapAddressesToRecipients(bcc)),cc&&(htmlBody.ccRecipients=graph_1.MailboxAPI.mapAddressesToRecipients(cc)),(from||name)&&(htmlBody.from={emailAddress:{address:from||Office.context.mailbox.userProfile.emailAddress,name:name||Office.context.mailbox.userProfile.displayName}}),replyTo&&(htmlBody.replyTo=graph_1.MailboxAPI.mapAddressesToRecipients(replyTo)),bcc=this,[4,graph_1.MailboxAPI.updateMessage(this.getId(),htmlBody)];case 1:return bcc.item=_b.sent(),[2,this]}})})},GmailDraft}();exports.GmailDraft=require},{"../graph":69,"./message":67}],66:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},graph_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailLabel=void 0,require("../graph")),require=function(){function GmailLabel(item){this.item=item}return GmailLabel.prototype.addToThread=function(_thread){return this},GmailLabel.prototype.addToThreads=function(threads){var e_1,_a;try{for(var threads_1=__values(threads),threads_1_1=threads_1.next();!threads_1_1.done;threads_1_1=threads_1.next()){var thread=threads_1_1.value;this.addToThread(thread)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{threads_1_1&&!threads_1_1.done&&(_a=threads_1.return)&&_a.call(threads_1)}finally{if(e_1)throw e_1.error}}return this},GmailLabel.prototype.deleteLabel=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,graph_1.MailboxAPI.deleteCategory(this.item.id)]})})},GmailLabel.prototype.getName=function(){return this.item.displayName},GmailLabel.prototype.getThreads=function(_start,_max){return[]},GmailLabel.prototype.getUnreadCount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listMessages("categories/any(c:c eq '".concat(this.getName(),"') and isRead eq false"))];case 1:return[2,_a.sent().length]}})})},GmailLabel.prototype.removeFromThread=function(_thread){return this},GmailLabel.prototype.removeFromThreads=function(threads){var e_2,_a;try{for(var threads_2=__values(threads),threads_2_1=threads_2.next();!threads_2_1.done;threads_2_1=threads_2.next()){var thread=threads_2_1.value;this.removeFromThread(thread)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{threads_2_1&&!threads_2_1.done&&(_a=threads_2.return)&&_a.call(threads_2)}finally{if(e_2)throw e_2.error}}return this},GmailLabel}();exports.GmailLabel=require},{"../graph":69}],67:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},graph_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailMessage=void 0,require("../graph")),attachment_1=require("./attachment"),draft_1=require("./draft"),thread_1=require("./thread"),require=function(){function GmailMessage(item){this.item=item}return GmailMessage.prototype.createDraftReply=function(body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var _a,_b,_c,_d,htmlBody,_e,id;return __generator(this,function(_f){switch(_f.label){case 0:return[4,graph_1.MailboxAPI.createReply(this.getId())];case 1:return id=_f.sent().id,_a=options.bcc,_a=void 0===_a?"":_a,_b=options.cc,_b=void 0===_b?"":_b,_c=options.from,_c=void 0===_c?Office.context.mailbox.userProfile.emailAddress:_c,_d=options.name,_d=void 0===_d?Office.context.mailbox.userProfile.displayName:_d,htmlBody=options.htmlBody,_e=options.replyTo,_e=void 0===_e?Office.context.mailbox.userProfile.emailAddress:_e,[4,graph_1.MailboxAPI.updateMessage(id,{bccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_a),body:{content:htmlBody||body,contentType:"html"},ccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_b),from:{emailAddress:{address:_c,name:_d}},replyTo:graph_1.MailboxAPI.mapAddressesToRecipients(_e)})];case 2:return id=_f.sent(),[2,new draft_1.GmailDraft(id)]}})})},GmailMessage.prototype.createDraftReplyAll=function(body,options){return __awaiter(this,void 0,void 0,function(){var _a,_b,_c,_d,htmlBody,_e,id;return __generator(this,function(_f){switch(_f.label){case 0:return[4,graph_1.MailboxAPI.createReply(this.getId(),!0)];case 1:return id=_f.sent().id,_a=options.bcc,_a=void 0===_a?"":_a,_b=options.cc,_b=void 0===_b?"":_b,_c=options.from,_c=void 0===_c?Office.context.mailbox.userProfile.emailAddress:_c,_d=options.name,_d=void 0===_d?Office.context.mailbox.userProfile.displayName:_d,htmlBody=options.htmlBody,_e=options.replyTo,_e=void 0===_e?Office.context.mailbox.userProfile.emailAddress:_e,[4,graph_1.MailboxAPI.updateMessage(id,{bccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_a),body:{content:htmlBody||body,contentType:"html"},ccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_b),from:{emailAddress:{address:_c,name:_d}},replyTo:graph_1.MailboxAPI.mapAddressesToRecipients(_e)})];case 2:return id=_f.sent(),[2,new draft_1.GmailDraft(id)]}})})},GmailMessage.prototype.forward=function(recipient,_options){return void 0===_options&&(_options={}),__awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.forwardMessage(this.getId(),recipient)];case 1:return _a.sent(),[2,this]}})})},GmailMessage.prototype.getAttachments=function(options){var items=this.item.attachments||[],_a=(options=void 0===options?{}:options).includeAttachments,includeAttachments=void 0===_a||_a,_a=options.includeInlineImages,includeInlineImages=void 0===_a||_a;return items.filter(function(item){item=item.isInline,item=void 0!==item&&item;return[includeInlineImages&&item,includeAttachments&&!item].some(Boolean)}).map(function(item){return new attachment_1.GmailAttachment(item)})},GmailMessage.prototype.getBcc=function(){return(this.item.bccRecipients||[]).map(function(_a){_a=_a.emailAddress;return null==_a?void 0:_a.address}).join(",")},GmailMessage.prototype.getBody=function(){var _a;return(null==(_a=this.item.body)?void 0:_a.content)||""},GmailMessage.prototype.getCc=function(){return(this.item.ccRecipients||[]).map(function(_a){_a=_a.emailAddress;return null==_a?void 0:_a.address}).join(",")},GmailMessage.prototype.getDate=function(){return new Date(this.item.createdDateTime)},GmailMessage.prototype.getFrom=function(){var _a;return null==(_a=null==(_a=this.item.from)?void 0:_a.emailAddress)?void 0:_a.address},GmailMessage.prototype.getHeader=function(name){var _a;return(null==(_a=null==(_a=this.item.internetMessageHeaders)?void 0:_a.find(function(header){return header.name===name}))?void 0:_a.value)||""},GmailMessage.prototype.getId=function(){return this.item.id},GmailMessage.prototype.getPlainBody=function(){return graph_1.MailboxAPI.getMessagePlainText(this.getId())},GmailMessage.prototype.getRawContent=function(){return graph_1.MailboxAPI.getMessageMIMEcontent(this.getId())},GmailMessage.prototype.getReplyTo=function(){var _a;return null==(_a=__read(this.item.replyTo||[],1)[0].emailAddress)?void 0:_a.address},GmailMessage.prototype.getSubject=function(){return this.item.subject||""},GmailMessage.prototype.getThread=function(){return new thread_1.GmailThread({id:this.item.conversationId})},GmailMessage.prototype.getTo=function(){var to=this.item.toRecipients||[];return graph_1.MailboxAPI.mapRecipientsToAddresses(to)},GmailMessage.prototype.isDraft=function(){return this.item.isDraft||!1},GmailMessage.prototype.isInChats=function(){return!1},GmailMessage.prototype.isInInbox=function(){return"inbox"===this.item.parentFolderId},GmailMessage.prototype.isInPriorityInbox=function(){return!1},GmailMessage.prototype.isInTrash=function(){return"deleteditems"===this.item.parentFolderId},GmailMessage.prototype.isStarred=function(){return"high"===this.item.importance},GmailMessage.prototype.isUnread=function(){return!this.item.isRead},GmailMessage.prototype.markRead=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.updateMessage(this.getId(),{isRead:!0})];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage.prototype.markUnread=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.updateMessage(this.getId(),{isRead:!1})];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage.prototype.moveToTrash=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.moveMessage(this.getId(),"deleteditems")];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage.prototype.refresh=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.getMessage(this.getId())];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage.prototype.reply=function(body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var reply;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.createDraftReply(body,options)];case 1:return reply=_a.sent(),[4,graph_1.MailboxAPI.sendReply(reply.getId())];case 2:return _a.sent(),[2,this]}})})},GmailMessage.prototype.replyAll=function(body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var replyAll;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.createDraftReplyAll(body,options)];case 1:return replyAll=_a.sent(),[4,graph_1.MailboxAPI.sendReply(replyAll.getId(),!0)];case 2:return _a.sent(),[2,this]}})})},GmailMessage.prototype.star=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.updateMessage(this.getId(),{importance:"high"})];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage.prototype.unstar=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return _a=this,[4,graph_1.MailboxAPI.updateMessage(this.getId(),{importance:"normal"})];case 1:return _a.item=_b.sent(),[2,this]}})})},GmailMessage}();exports.GmailMessage=require},{"../graph":69,"./attachment":64,"./draft":65,"./thread":68}],68:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},GmailThread=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailThread=void 0,function(){function GmailThread(item){this.item=item}return GmailThread.prototype.moveToArchive=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread.prototype.moveToInbox=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread.prototype.moveToSpam=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread.prototype.moveToTrash=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread.prototype.refresh=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread.prototype.removeLabel=function(_label){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailThread}());exports.GmailThread=GmailThread},{}],69:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},MailboxAPI=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.MailboxAPI=void 0,function(){function MailboxAPI(){}return MailboxAPI.mapAddressesToRecipients=function(addresses){return addresses.split(",").map(function(address){return{emailAddress:{address:address}}})},MailboxAPI.mapRecipientsToAddresses=function(recipients){return recipients.map(function(_a){_a=_a.emailAddress;return null==_a?void 0:_a.address}).join(",")},MailboxAPI.getToken=function(){return new Promise(function(resolve,reject){Office.context.mailbox.getCallbackTokenAsync({isRest:!0},function(result){var status=result.status,error=result.error,value=result.value;(result={})[Office.AsyncResultStatus.Succeeded]=function(){return resolve(value)},result[Office.AsyncResultStatus.Failed]=function(){return reject(error)},result[status]()})})},MailboxAPI.createCategory=function(category){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,method:"POST",path:"/me/outlook/masterCategories",type:"application/json",data:category})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to create category",{cause:message});case 3:return[2,res.json()]}})})},MailboxAPI.createMessage=function(message){return __awaiter(this,void 0,void 0,function(){var res,message_1;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,headers:{"Content-Length":"0"},method:"POST",path:"/me/messages",type:"application/json",data:message})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message_1=_a.sent().message,new Error("failed to create message",{cause:message_1});case 3:return[2,res.json()]}})})},MailboxAPI.createReply=function(messageId,all){return void 0===all&&(all=!1),__awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,headers:{Prefer:'outlook.timezone="'.concat(Office.context.mailbox.userProfile.timeZone,'"')},method:"POST",path:"/me/messages/".concat(messageId,"/createReply").concat(all?"All":""),type:"application/json"})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to create draft reply",{cause:message});case 3:return[2,res.json()]}})})},MailboxAPI.deleteCategory=function(categoryId){return __awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,method:"DELETE",path:"/me/outlook/masterCategories/".concat(categoryId)})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to delete category",{cause:res});case 3:return[2]}})})},MailboxAPI.deleteMessage=function(messageId){return __awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,method:"DELETE",path:"/me/messages/".concat(messageId)})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to delete message",{cause:res});case 3:return[2]}})})},MailboxAPI.listCategories=function($filter){return __awaiter(this,void 0,void 0,function(){var options,res,parameters;return __generator(this,function(_a){switch(_a.label){case 0:return options={authorize:!0,method:"GET",path:"/me/outlook/masterCategories"},parameters={},$filter&&Object.assign(parameters,{$filter:$filter}),options.parameters=parameters,[4,MailboxAPI.request(options)];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw parameters=_a.sent().message,new Error("failed to list categories",{cause:parameters});case 3:return[4,res.json()];case 4:return[2,_a.sent().value]}})})},MailboxAPI.listMessages=function($filter){return __awaiter(this,void 0,void 0,function(){var options,res,parameters;return __generator(this,function(_a){switch(_a.label){case 0:return options={authorize:!0,headers:{Prefer:'outlook.body-content-type="html"'},method:"GET",path:"/me/messages"},parameters={$top:"1000"},$filter&&Object.assign(parameters,{$filter:$filter}),options.parameters=parameters,[4,MailboxAPI.request(options)];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw parameters=_a.sent().message,new Error("failed to list messages",{cause:parameters});case 3:return[4,res.json()];case 4:return[2,_a.sent().value]}})})},MailboxAPI.getMessagePlainText=function(messageId){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,headers:{Prefer:'outlook.body-content-type="text"'},method:"GET",path:"/me/messages/".concat(messageId,"?$select=body")})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to get message plain text content",{cause:message});case 3:return[4,res.json()];case 4:return[2,(null==(message=_a.sent().body)?void 0:message.content)||""]}})})},MailboxAPI.getMessageMIMEcontent=function(messageId){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,headers:{Prefer:'outlook.body-content-type="html"'},method:"GET",path:"/me/messages/".concat(messageId,"/$value")})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to get message MIME content",{cause:message});case 3:return[2,res.text()]}})})},MailboxAPI.getMessage=function(messageId){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,headers:{Prefer:'outlook.body-content-type="html"'},method:"GET",path:"/me/messages/".concat(messageId)})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to get message",{cause:message});case 3:return[2,res.json()]}})})},MailboxAPI.moveMessage=function(messageId,destinationId){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,data:{destinationId:destinationId},method:"POST",path:"/me/messages/".concat(messageId,"/move"),type:"application/json"})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to move message",{cause:message});case 3:return[2,res.json()]}})})},MailboxAPI.sendMessage=function(message){return __awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,data:{message:message},method:"POST",path:"/me/sendMail",type:"application/json"})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to send message",{cause:res});case 3:return[2]}})})},MailboxAPI.sendMessageById=function(messageId){return __awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,headers:{"Content-Length":"0"},method:"POST",path:"/me/messages/".concat(messageId,"/send")})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to send message",{cause:res});case 3:return[2]}})})},MailboxAPI.sendReply=function(messageId,all){return void 0===all&&(all=!1),__awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,headers:{Prefer:'outlook.timezone="'.concat(Office.context.mailbox.userProfile.timeZone,'"')},method:"POST",path:"/me/messages/".concat(messageId,"/reply").concat(all?"All":""),type:"application/json"})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to reply to message",{cause:res});case 3:return[2]}})})},MailboxAPI.query=function(options){return __awaiter(this,void 0,void 0,function(){var _a,search,type,res,_b;return __generator(this,function(_c){switch(_c.label){case 0:return _a=options.size,_a=void 0===_a?50:_a,_b=options.page,_b=void 0===_b?1:_b,search=options.search,type=options.type,type={entityTypes:[type],from:(_b-1)*_a,size:_a,query:{queryString:search}},[4,this.request({authorize:!0,data:{requests:[type]},method:"POST",path:"/search/query",type:"application/json"})];case 1:return(res=_c.sent()).ok?[3,3]:[4,res.json()];case 2:throw _b=_c.sent().message,new Error("failed to search messages",{cause:_b});case 3:return[4,res.json()];case 4:return[2,(_c.sent().value.hitsContainers||[]).flatMap(function(container){return(container.hits||[]).map(function(_a){return _a.resource})})]}})})},MailboxAPI.forwardMessage=function(messageId,to){return __awaiter(this,void 0,void 0,function(){var res;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.request({authorize:!0,data:{toRecipients:this.mapAddressesToRecipients(to)},method:"POST",path:"/me/messages/".concat(messageId,"/forward"),type:"application/json"})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw res=_a.sent().message,new Error("failed to forward message",{cause:res});case 3:return[2]}})})},MailboxAPI.updateMessage=function(messageId,data){return __awaiter(this,void 0,void 0,function(){var res,message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,MailboxAPI.request({authorize:!0,method:"PATCH",path:"/me/messages/".concat(messageId),type:"application/json",data:data})];case 1:return(res=_a.sent()).ok?[3,3]:[4,res.json()];case 2:throw message=_a.sent().message,new Error("failed to update message",{cause:message});case 3:return[2,res.json()]}})})},MailboxAPI.request=function(config){return __awaiter(this,void 0,void 0,function(){var _a,_b,method,data,type,path,_c,_d,_e,_f,_g;return __generator(this,function(_h){switch(_h.label){case 0:return(_a=config.authorize,_a=void 0!==_a&&_a,_b=config.headers,_b=void 0===_b?{}:_b,method=config.method,path=config.path,data=config.data,_c=config.parameters,_c=void 0===_c?{}:_c,type=config.type,(path=new URL("".concat(this.baseURL).concat(path))).search=new URLSearchParams(_c).toString(),_c=new Headers(_b),_a)?(_e=(_d=_c).set,_f=["Authorization"],_g="Bearer ".concat,[4,this.getToken()]):[3,2];case 1:_e.apply(_d,_f.concat([_g.apply("Bearer ",[_h.sent()])])),_h.label=2;case 2:return type&&_c.set("Content-Type",type),data&&("application/json"===type&&JSON.stringify(data)),[2,fetch(path,{method:method,headers:_c,body:JSON.stringify(data)})]}})})},MailboxAPI.baseURL="https://graph.microsoft.com/v1.0",MailboxAPI}());exports.MailboxAPI=MailboxAPI},{}],70:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},draft_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.GmailApp=void 0,require("./components/draft")),label_1=require("./components/label"),message_1=require("./components/message"),thread_1=require("./components/thread"),graph_1=require("./graph"),require=function(){function GmailApp(){}return GmailApp.prototype.createDraft=function(recipient,subject,body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var _b,_c,_e,_f,_a,_d;return __generator(this,function(_g){switch(_g.label){case 0:return _a=options.bcc,_a=void 0===_a?"":_a,_b=options.cc,_b=void 0===_b?"":_b,_c=options.from,_c=void 0===_c?Office.context.mailbox.userProfile.emailAddress:_c,_d=options.htmlBody,_d=void 0===_d?"":_d,_e=options.name,_e=void 0===_e?Office.context.mailbox.userProfile.displayName:_e,_f=options.replyTo,_f=void 0===_f?Office.context.mailbox.userProfile.emailAddress:_f,_a={bccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_a),body:{content:_d||body,contentType:_d?"html":"text"},ccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_b),from:{emailAddress:{address:_c,name:_e}},isDraft:!0,replyTo:graph_1.MailboxAPI.mapAddressesToRecipients(_f),subject:subject,toRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(recipient)},[4,graph_1.MailboxAPI.createMessage(_a)];case 1:return _d=_g.sent(),[2,new draft_1.GmailDraft(_d)]}})})},GmailApp.prototype.createLabel=function(name){return __awaiter(this,void 0,void 0,function(){var data;return __generator(this,function(_a){switch(_a.label){case 0:return data={displayName:name},[4,graph_1.MailboxAPI.createCategory(data)];case 1:return data=_a.sent(),[2,new label_1.GmailLabel(data)]}})})},GmailApp.prototype.deleteLabel=function(label){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,label.deleteLabel()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.getAliases=function(){return[Office.context.mailbox.userProfile.emailAddress]},GmailApp.prototype.getDraft=function(draftId){return __awaiter(this,void 0,void 0,function(){var message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.getMessage(draftId)];case 1:return message=_a.sent(),[2,new draft_1.GmailDraft(message)]}})})},GmailApp.prototype.getDraftMessages=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listMessages("isDraft eq true")];case 1:return[2,_a.sent().map(function(message){return new message_1.GmailMessage(message)})]}})})},GmailApp.prototype.getDrafts=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listMessages("isDraft eq true")];case 1:return[2,_a.sent().map(function(message){return new draft_1.GmailDraft(message)})]}})})},GmailApp.prototype.getInboxThreads=function(_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getInboxUnreadCount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listMessages("isRead eq false and parentFolderId eq 'inbox'")];case 1:return[2,_a.sent().length]}})})},GmailApp.prototype.getMessageById=function(id){return __awaiter(this,void 0,void 0,function(){var message;return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.getMessage(id)];case 1:return message=_a.sent(),[2,new message_1.GmailMessage(message)]}})})},GmailApp.prototype.getMessagesForThread=function(_thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getMessagesForThreads=function(_threads){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getPriorityInboxThreads=function(_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getPriorityInboxUnreadCount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,0]})})},GmailApp.prototype.getSpamThreads=function(_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getSpamUnreadCount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listMessages("isRead eq false and parentFolderId eq 'junkemail'")];case 1:return[2,_a.sent().length]}})})},GmailApp.prototype.getStarredThreads=function(_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getStarredUnreadCount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,0]})})},GmailApp.prototype.getThreadById=function(id){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new thread_1.GmailThread({id:id})]})})},GmailApp.prototype.getTrashThreads=function(_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.getUserLabelByName=function(name){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:return[4,graph_1.MailboxAPI.listCategories("displayName eq '".concat(name,"'"))];case 1:if(_a=__read.apply(void 0,[_b.sent(),1]),_a=_a[0])return[2,new label_1.GmailLabel(_a)];throw new Error('GmailLabel "'.concat(name,'" does not exist'))}})})},GmailApp.prototype.getUserLabels=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,graph_1.MailboxAPI.listCategories()];case 1:return[2,_a.sent().map(function(category){return new label_1.GmailLabel(category)})]}})})},GmailApp.prototype.markMessageRead=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.markRead()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.markMessageUnread=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.markUnread()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.markMessagesRead=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_1,messages_1_1,message,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_1=__values(messages),messages_1_1=messages_1.next(),_b.label=1;case 1:return messages_1_1.done?[3,4]:(message=messages_1_1.value,[4,this.markMessageRead(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_1_1=messages_1.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_1={error:message},[3,7];case 6:try{messages_1_1&&!messages_1_1.done&&(_a=messages_1.return)&&_a.call(messages_1)}finally{if(e_1)throw e_1.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.markMessagesUnread=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_2,messages_2_1,message,e_2,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_2=__values(messages),messages_2_1=messages_2.next(),_b.label=1;case 1:return messages_2_1.done?[3,4]:(message=messages_2_1.value,[4,this.markMessageUnread(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_2_1=messages_2.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_2={error:message},[3,7];case 6:try{messages_2_1&&!messages_2_1.done&&(_a=messages_2.return)&&_a.call(messages_2)}finally{if(e_2)throw e_2.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.markThreadImportant=function(_thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailApp.prototype.markThreadRead=function(_thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailApp.prototype.markThreadUnimportant=function(_thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailApp.prototype.markThreadUnread=function(_thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this]})})},GmailApp.prototype.markThreadsImportant=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_1,threads_1_1,thread,e_3,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_1=__values(threads),threads_1_1=threads_1.next(),_b.label=1;case 1:return threads_1_1.done?[3,4]:(thread=threads_1_1.value,[4,this.markThreadImportant(thread)]);case 2:_b.sent(),_b.label=3;case 3:return threads_1_1=threads_1.next(),[3,1];case 4:return[3,7];case 5:return thread=_b.sent(),e_3={error:thread},[3,7];case 6:try{threads_1_1&&!threads_1_1.done&&(_a=threads_1.return)&&_a.call(threads_1)}finally{if(e_3)throw e_3.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.markThreadsRead=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_2,threads_2_1,thread,e_4,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_2=__values(threads),threads_2_1=threads_2.next(),_b.label=1;case 1:return threads_2_1.done?[3,4]:(thread=threads_2_1.value,[4,this.markThreadRead(thread)]);case 2:_b.sent(),_b.label=3;case 3:return threads_2_1=threads_2.next(),[3,1];case 4:return[3,7];case 5:return thread=_b.sent(),e_4={error:thread},[3,7];case 6:try{threads_2_1&&!threads_2_1.done&&(_a=threads_2.return)&&_a.call(threads_2)}finally{if(e_4)throw e_4.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.markThreadsUnimportant=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_3,threads_3_1,thread,e_5,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_3=__values(threads),threads_3_1=threads_3.next(),_b.label=1;case 1:return threads_3_1.done?[3,4]:(thread=threads_3_1.value,[4,this.markThreadUnimportant(thread)]);case 2:_b.sent(),_b.label=3;case 3:return threads_3_1=threads_3.next(),[3,1];case 4:return[3,7];case 5:return thread=_b.sent(),e_5={error:thread},[3,7];case 6:try{threads_3_1&&!threads_3_1.done&&(_a=threads_3.return)&&_a.call(threads_3)}finally{if(e_5)throw e_5.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.markThreadsUnread=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_4,threads_4_1,thread,e_6,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_4=__values(threads),threads_4_1=threads_4.next(),_b.label=1;case 1:return threads_4_1.done?[3,4]:(thread=threads_4_1.value,[4,this.markThreadUnread(thread)]);case 2:_b.sent(),_b.label=3;case 3:return threads_4_1=threads_4.next(),[3,1];case 4:return[3,7];case 5:return thread=_b.sent(),e_6={error:thread},[3,7];case 6:try{threads_4_1&&!threads_4_1.done&&(_a=threads_4.return)&&_a.call(threads_4)}finally{if(e_6)throw e_6.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.moveMessageToTrash=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.moveToTrash()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.moveMessagesToTrash=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_3,messages_3_1,message,e_7,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_3=__values(messages),messages_3_1=messages_3.next(),_b.label=1;case 1:return messages_3_1.done?[3,4]:(message=messages_3_1.value,[4,this.moveMessageToTrash(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_3_1=messages_3.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_7={error:message},[3,7];case 6:try{messages_3_1&&!messages_3_1.done&&(_a=messages_3.return)&&_a.call(messages_3)}finally{if(e_7)throw e_7.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.moveThreadToArchive=function(thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,thread.moveToArchive()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.moveThreadToInbox=function(thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,thread.moveToInbox()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.moveThreadToSpam=function(thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,thread.moveToSpam()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.moveThreadToTrash=function(thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,thread.moveToTrash()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.moveThreadsToArchive=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_5,threads_5_1,e_8_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_5=__values(threads),threads_5_1=threads_5.next(),_b.label=1;case 1:return threads_5_1.done?[3,4]:[4,threads_5_1.value.moveToArchive()];case 2:_b.sent(),_b.label=3;case 3:return threads_5_1=threads_5.next(),[3,1];case 4:return[3,7];case 5:return e_8_1=_b.sent(),e_8_1={error:e_8_1},[3,7];case 6:try{threads_5_1&&!threads_5_1.done&&(_a=threads_5.return)&&_a.call(threads_5)}finally{if(e_8_1)throw e_8_1.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.moveThreadsToInbox=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_6,threads_6_1,e_9_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_6=__values(threads),threads_6_1=threads_6.next(),_b.label=1;case 1:return threads_6_1.done?[3,4]:[4,threads_6_1.value.moveToInbox()];case 2:_b.sent(),_b.label=3;case 3:return threads_6_1=threads_6.next(),[3,1];case 4:return[3,7];case 5:return e_9_1=_b.sent(),e_9_1={error:e_9_1},[3,7];case 6:try{threads_6_1&&!threads_6_1.done&&(_a=threads_6.return)&&_a.call(threads_6)}finally{if(e_9_1)throw e_9_1.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.moveThreadsToSpam=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_7,threads_7_1,e_10_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_7=__values(threads),threads_7_1=threads_7.next(),_b.label=1;case 1:return threads_7_1.done?[3,4]:[4,threads_7_1.value.moveToSpam()];case 2:_b.sent(),_b.label=3;case 3:return threads_7_1=threads_7.next(),[3,1];case 4:return[3,7];case 5:return e_10_1=_b.sent(),e_10_1={error:e_10_1},[3,7];case 6:try{threads_7_1&&!threads_7_1.done&&(_a=threads_7.return)&&_a.call(threads_7)}finally{if(e_10_1)throw e_10_1.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.moveThreadsToTrash=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_8,threads_8_1,e_11_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_8=__values(threads),threads_8_1=threads_8.next(),_b.label=1;case 1:return threads_8_1.done?[3,4]:[4,threads_8_1.value.moveToTrash()];case 2:_b.sent(),_b.label=3;case 3:return threads_8_1=threads_8.next(),[3,1];case 4:return[3,7];case 5:return e_11_1=_b.sent(),e_11_1={error:e_11_1},[3,7];case 6:try{threads_8_1&&!threads_8_1.done&&(_a=threads_8.return)&&_a.call(threads_8)}finally{if(e_11_1)throw e_11_1.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.refreshMessage=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.refresh()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.refreshMessages=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_4,messages_4_1,message,e_12,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_4=__values(messages),messages_4_1=messages_4.next(),_b.label=1;case 1:return messages_4_1.done?[3,4]:(message=messages_4_1.value,[4,this.refreshMessage(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_4_1=messages_4.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_12={error:message},[3,7];case 6:try{messages_4_1&&!messages_4_1.done&&(_a=messages_4.return)&&_a.call(messages_4)}finally{if(e_12)throw e_12.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.refreshThread=function(thread){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,thread.refresh()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.refreshThreads=function(threads){return __awaiter(this,void 0,void 0,function(){var threads_9,threads_9_1,thread,e_13,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),threads_9=__values(threads),threads_9_1=threads_9.next(),_b.label=1;case 1:return threads_9_1.done?[3,4]:(thread=threads_9_1.value,[4,this.refreshThread(thread)]);case 2:_b.sent(),_b.label=3;case 3:return threads_9_1=threads_9.next(),[3,1];case 4:return[3,7];case 5:return thread=_b.sent(),e_13={error:thread},[3,7];case 6:try{threads_9_1&&!threads_9_1.done&&(_a=threads_9.return)&&_a.call(threads_9)}finally{if(e_13)throw e_13.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.search=function(_query,_start,_max){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,[]]})})},GmailApp.prototype.sendEmail=function(recipient,subject,body,options){return void 0===options&&(options={}),__awaiter(this,void 0,void 0,function(){var _a,_b,_c,_d,htmlBody,_e;return __generator(this,function(_f){switch(_f.label){case 0:return _a=options.bcc,_a=void 0===_a?"":_a,_b=options.cc,_b=void 0===_b?"":_b,_c=options.from,_c=void 0===_c?Office.context.mailbox.userProfile.emailAddress:_c,_d=options.name,_d=void 0===_d?Office.context.mailbox.userProfile.displayName:_d,htmlBody=options.htmlBody,_e=options.replyTo,_e=void 0===_e?Office.context.mailbox.userProfile.emailAddress:_e,[4,graph_1.MailboxAPI.sendMessage({bccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_a),body:{content:htmlBody||body,contentType:"html"},ccRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(_b),from:{emailAddress:{address:_c,name:_d}},replyTo:graph_1.MailboxAPI.mapAddressesToRecipients(_e),toRecipients:graph_1.MailboxAPI.mapAddressesToRecipients(recipient),subject:subject})];case 1:return _f.sent(),[2,this]}})})},GmailApp.prototype.setCurrentMessageAccessToken=function(_accessToken){return this},GmailApp.prototype.starMessage=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.star()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.starMessages=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_5,messages_5_1,message,e_14,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_5=__values(messages),messages_5_1=messages_5.next(),_b.label=1;case 1:return messages_5_1.done?[3,4]:(message=messages_5_1.value,[4,this.starMessage(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_5_1=messages_5.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_14={error:message},[3,7];case 6:try{messages_5_1&&!messages_5_1.done&&(_a=messages_5.return)&&_a.call(messages_5)}finally{if(e_14)throw e_14.error}return[7];case 7:return[2,this]}})})},GmailApp.prototype.unstarMessage=function(message){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,message.unstar()];case 1:return _a.sent(),[2,this]}})})},GmailApp.prototype.unstarMessages=function(messages){return __awaiter(this,void 0,void 0,function(){var messages_6,messages_6_1,message,e_15,_a;return __generator(this,function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,7]),messages_6=__values(messages),messages_6_1=messages_6.next(),_b.label=1;case 1:return messages_6_1.done?[3,4]:(message=messages_6_1.value,[4,this.unstarMessage(message)]);case 2:_b.sent(),_b.label=3;case 3:return messages_6_1=messages_6.next(),[3,1];case 4:return[3,7];case 5:return message=_b.sent(),e_15={error:message},[3,7];case 6:try{messages_6_1&&!messages_6_1.done&&(_a=messages_6.return)&&_a.call(messages_6)}finally{if(e_15)throw e_15.error}return[7];case 7:return[2,this]}})})},GmailApp}();exports.GmailApp=require},{"./components/draft":65,"./components/label":66,"./components/message":67,"./components/thread":68,"./graph":69}],71:[function(require,module,exports){"use strict";var _a,__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},require=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Lock=void 0,require("../enums")),locks=((_a={})[require.LockType.DOCUMENT]=!1,_a[require.LockType.SCRIPT]=!1,_a[require.LockType.USER]=!1,_a),require=function(){function Lock(type){this.type=type,this.locked=!1}return Lock.prototype.hasLock=function(){return this.locked},Lock.prototype.releaseLock=function(){var type=this.type;return locks[type]=!1,this},Lock.prototype.tryLock=function(timeoutInMillis){var _this=this;return new Promise(function(resolve){return __awaiter(_this,void 0,void 0,function(){var type,interval;return __generator(this,function(_a){switch(_a.label){case 0:return type=this.type,locks[type]||(locks[type]=!0,resolve(!0)),interval=setInterval(function(){locks[type]||(locks[type]=!0,clearInterval(interval),resolve(!0))}),[4,new Promise(function(r){return setTimeout(r,timeoutInMillis)})];case 1:return _a.sent(),resolve(!1),[2]}})})})},Lock.prototype.waitLock=function(timeoutInMillis){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){return[2,new Promise(function(resolve,reject){return __awaiter(_this,void 0,void 0,function(){var type,interval;return __generator(this,function(_a){switch(_a.label){case 0:return type=this.type,locks[type]||(locks[type]=!0,resolve()),interval=setInterval(function(){locks[type]||(locks[type]=!0,clearInterval(interval),resolve())}),[4,new Promise(function(r){return setTimeout(r,timeoutInMillis)})];case 1:return _a.sent(),reject(new Error("failed to acquire the lock")),[2]}})})})]})})},Lock}();exports.Lock=require},{"../enums":72}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LockType=void 0,function(LockType){LockType.DOCUMENT="DOCUMENT",LockType.SCRIPT="SCRIPT",LockType.USER="USER"}(exports.LockType||(exports.LockType={}))},{}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LockService=void 0;var lock_1=require("./components/lock"),enums_1=require("./enums"),require=function(){function LockService(){}return LockService.prototype.getDocumentLock=function(){return new lock_1.Lock(enums_1.LockType.DOCUMENT)},LockService.prototype.getScriptLock=function(){return new lock_1.Lock(enums_1.LockType.SCRIPT)},LockService.prototype.getUserLock=function(){return new lock_1.Lock(enums_1.LockType.USER)},LockService}();exports.LockService=require},{"./components/lock":71,"./enums":72}],74:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},Properties=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Properties=void 0,function(){function Properties(store,type){this.store=store,this.type=type}return Properties.prototype.save=function(){var store=this.store;return new Promise(function(resolve,reject){store.saveAsync(function(result){var _a;(_a={})[Office.AsyncResultStatus.Succeeded]=resolve,_a[Office.AsyncResultStatus.Failed]=reject,_a[result.status]()})})},Object.defineProperty(Properties.prototype,"typedStore",{get:function(){var store=this.store,type=this.type,typedStore=store.get(type);return typedStore||(store.set(type,typedStore={}),this.save(),typedStore)},enumerable:!1,configurable:!0}),Properties.prototype.deleteAllProperties=function(){var store=this.store,type=this.type;return store.set(type,{}),this.save(),this},Properties.prototype.deleteProperty=function(key){var store=this.store,type=this.type,typedStore=this.typedStore;return delete typedStore[key],store.set(type,typedStore),this.save(),this},Properties.prototype.getKeys=function(){var typedStore=this.typedStore;return Object.keys(typedStore)},Properties.prototype.getProperties=function(){var typedStore=this.typedStore;return __assign({},typedStore)},Properties.prototype.getProperty=function(key){var typedStore=this.typedStore;return key in typedStore?typedStore[key]:null},Properties.prototype.setProperties=function(properties,deleteAllOthers){var store=this.store,type=this.type,deleteAllOthers=__assign((deleteAllOthers=void 0===deleteAllOthers?!1:deleteAllOthers)?{}:__assign({},this.typedStore),properties);return store.set(type,deleteAllOthers),this.save(),this},Properties.prototype.setProperty=function(key,value){var store=this.store,type=this.type,typedStore=this.typedStore;return typedStore[key]=value.toString(),store.set(type,typedStore),this.save(),this},Properties}());exports.Properties=Properties},{}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PropertiesStoreType=void 0,function(PropertiesStoreType){PropertiesStoreType.DOCUMENT="DOCUMENT",PropertiesStoreType.SCRIPT="SCRIPT",PropertiesStoreType.USER="USER"}(exports.PropertiesStoreType||(exports.PropertiesStoreType={}))},{}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PropertiesService=void 0;var office_1=require("../../../gas-js/utils/office"),properties_1=require("./components/properties"),enums_1=require("./enums"),require=function(){function PropertiesService(){}return PropertiesService.prototype.getDocumentProperties=function(){return new properties_1.Properties((0,office_1.getSettings)(),enums_1.PropertiesStoreType.DOCUMENT)},PropertiesService.prototype.getScriptProperties=function(){return new properties_1.Properties((0,office_1.getSettings)(),enums_1.PropertiesStoreType.SCRIPT)},PropertiesService.prototype.getUserProperties=function(){return new properties_1.Properties((0,office_1.getSettings)(),enums_1.PropertiesStoreType.USER)},PropertiesService}();exports.PropertiesService=require},{"../../../gas-js/utils/office":97,"./components/properties":74,"./enums":75}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.User=void 0;var User=function(){function User(item){this.item=item}return User.prototype.getEmail=function(){return this.item.emailAddress},User}();exports.User=User},{}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Session=void 0;var office_1=require("../../utils/office"),user_1=require("./components/user"),require=function(){function Session(){}return Session.prototype.getActiveUser=function(){return new user_1.User((0,office_1.getProfile)())},Session.prototype.getActiveUserLocale=function(){return Office.context.displayLanguage||"en"},Session.prototype.getEffectiveUser=function(){return new user_1.User((0,office_1.getProfile)())},Session.prototype.getScriptTimeZone=function(){return(0,office_1.getProfile)().timeZone},Session.prototype.getTemporaryActiveUserKey=function(){var _a=(0,office_1.getProfile)(),displayName=_a.displayName,emailAddress=_a.emailAddress,_a=_a.accountType;return btoa("".concat(displayName,"-").concat(emailAddress,"-").concat(_a))},Session}();exports.Session=require},{"../../utils/office":97,"./components/user":77}],79:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},blob_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.HTTPResponse=void 0,require("../../base/blob")),require=function(){function HTTPResponse(request){this.request=request}return HTTPResponse.prototype.getAllHeaders=function(){var headerLines=this.request.getAllResponseHeaders().trim().split(/[\r\n]+/),headers={};return headerLines.forEach(function(line){var line=__read(line.split(": ")),name=line[0],line=line.slice(1).join(": "),existing=headers[name];headers[name]=existing?"string"==typeof existing?[existing,line]:__spreadArray(__spreadArray([],__read(existing),!1),[line],!1):line}),headers},HTTPResponse.prototype.getAs=function(contentType){var blob=this.getBlob();return blob.setContentType(contentType),blob},HTTPResponse.prototype.getBlob=function(){var response=this.request.response,blob=new blob_1.Blob;return"string"==typeof response&&blob.setDataFromString(response),response instanceof ArrayBuffer&&blob.setBytes(__spreadArray([],__read(new Uint8Array(response)),!1)),response instanceof Document&&blob.setDataFromString(response.documentElement.outerHTML),"object"==typeof response&&blob.setDataFromString(JSON.stringify(response)),blob},HTTPResponse.prototype.getContent=function(){return this.getBlob().getBytes()},HTTPResponse.prototype.getContentText=function(charset){return void 0===charset&&(charset="UTF-8"),this.getBlob().getDataAsString(charset)},HTTPResponse.prototype.getHeaders=function(){var headerLines=this.request.getAllResponseHeaders().trim().split(/[\r\n]+/),headers={};return headerLines.forEach(function(line){var line=__read(line.split(": ")),name=line[0],line=line.slice(1);headers[name]=line.join(": ")}),headers},HTTPResponse.prototype.getResponseCode=function(){return this.request.status},HTTPResponse}();exports.HTTPResponse=require},{"../../base/blob":16}],80:[function(require,module,exports){"use strict";var __rest=this&&this.__rest||function(s,e){var t={};for(p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},http_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UrlFetchApp=void 0,require("./components/http_response")),utils_1=require("./utils"),require=function(){function UrlFetchApp(){}return UrlFetchApp.prototype.fetch=function(url,params){void 0===params&&(params={});var request=new XMLHttpRequest;try{request.timeout=29e3}catch(error){console.log("Using older browser with poor request timeout support (expect timeout to differ from 30s)")}var _a=params.contentType,_a=void 0===_a?"application/x-www-form-urlencoded":_a,_b=params.headers,_b=void 0===_b?{}:_b,_c=params.method,_c=void 0===_c?"get":_c,params=params.payload;if(request.open(_c.toUpperCase(),url,!1),request.setRequestHeader("endpoint",url),request.setRequestHeader("Content-Type",_a),Object.entries(_b).forEach(function(_a){var _a=__read(_a,2),name=_a[0],_a=_a[1];request.setRequestHeader(name,_a)}),request.send("object"==typeof params?(0,utils_1.payloadToFormData)(params):params),500===request.status&&"DNS error"===request.statusText)throw new Error("DNS error: ".concat(url));return new http_response_1.HTTPResponse(request)},UrlFetchApp.prototype.fetchAll=function(requests){var _this=this;return requests.map(function(_a){var url=_a.url,_a=__rest(_a,["url"]);return _this.fetch(url,_a)})},UrlFetchApp.prototype.getRequest=function(url,params){var _a=(params=void 0===params?{}:params).contentType,_b=params.headers,_c=params.method,request={contentType:void 0===_a?"application/x-www-form-urlencoded":_a,headers:void 0===_b?{}:_b,method:void 0===_c?"get":_c,payload:params.payload,url:url};return["escaping","followRedirects","muteHttpExceptions","validateHttpsCertificates"].forEach(function(name){void 0!==params[name]&&(request[name]=params[name])}),request},UrlFetchApp}();exports.UrlFetchApp=require},{"./components/http_response":79,"./utils":81}],81:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};Object.defineProperty(exports,"__esModule",{value:!0}),exports.payloadToFormData=void 0;exports.payloadToFormData=function(payload){var formData=new FormData;return Object.entries(payload).forEach(function(_a){var _a=__read(_a,2),key=_a[0],_a=_a[1];formData.append(key,_a)}),formData}},{}],82:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},blob_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Utilities=void 0,require("../base/blob")),require=function(){function Utilities(){}return Utilities.prototype.newBlob=function(data,contentType,name){var blob=new blob_1.Blob;return contentType&&blob.setContentType(contentType),name&&blob.setName(name),"string"==typeof data?blob.setDataFromString(data):blob.setBytes(data),blob},Utilities.prototype.sleep=function(milliseconds){return __awaiter(this,void 0,void 0,function(){var ms;return __generator(this,function(_a){if(milliseconds<0)throw new RangeError("milliseconds to sleep must be a positive integer, got ".concat(milliseconds));return ms=3e5<milliseconds?3e5:milliseconds,[2,new Promise(function(resolve){setTimeout(resolve,ms)})]})})},Utilities.prototype.base64Decode=function(encoded){return this.newBlob(atob(encoded)).getBytes()},Utilities.prototype.base64Encode=function(input){input=this.newBlob(input);return btoa(input.getDataAsString())},Utilities}();exports.Utilities=require},{"../base/blob":16}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionStore=void 0;var event_1=require("../handlers/event"),identifiers_1=require("../utils/identifiers"),require=function(){function ActionStore(){}return Object.defineProperty(ActionStore,"identifiers",{get:function(){return Object.keys(this.actions)},enumerable:!1,configurable:!0}),ActionStore.bind=function(event,caller,action,target){this.set(caller,action);var eventTarget=target||caller;return eventTarget.addEventListener(event,function(){(0,event_1.handleEvent)(eventTarget)}),this},ActionStore.get=function(guid){return this.actions[guid]},ActionStore.set=function(caller,action){var actions=this.actions,identifiers=this.identifiers,identifiers=(0,identifiers_1.getGuid)(identifiers);return actions[identifiers]=action,caller.classList.add("pointer"),caller.setAttribute("action",identifiers),this},ActionStore.remove=function(guid){return delete this.actions[guid],this},ActionStore.actions={},ActionStore}();exports.ActionStore=require},{"../handlers/event":12,"../utils/identifiers":93}],84:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},CardStore=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardStore=void 0,function(){function CardStore(){}return Object.defineProperty(CardStore,"last",{get:function(){var stack=this.stack;return stack[stack.length-1]},enumerable:!1,configurable:!0}),CardStore.named=function(name){for(var stack=this.stack,i=stack.length-1;0<=i&&stack[i].name!==name;i--)this.pop();return this},CardStore.pop=function(){return this.stack.pop(),this},CardStore.push=function(card){return this.stack.push(card),this},CardStore.render=function(parent){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this.last.render(parent)]})})},CardStore.reset=function(cards){var stack=this.stack;return stack.length=0,stack.push.apply(stack,__spreadArray([],__read(cards),!1)),this},CardStore.teardown=function(){return __awaiter(this,void 0,void 0,function(){var stack;return __generator(this,function(_a){switch(_a.label){case 0:return stack=this.stack,[4,Promise.all(stack.map(function(card){return card.teardown()}))];case 1:return _a.sent(),[2,this]}})})},CardStore.root=function(){for(var length=this.stack.length,i=1;i<length;i++)this.pop();return this},CardStore.stack=[],CardStore}());exports.CardStore=CardStore},{}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RuleStore=void 0;var RuleStore=function(){function RuleStore(rules){this.rules=rules}return RuleStore.prototype.find=function(predicate){return this.rules.find(predicate)||[]},RuleStore}();exports.RuleStore=RuleStore},{}],86:[function(require,module,exports){"use strict";var __values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},ServicesStore=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServicesStore=void 0,function(){function ServicesStore(){}return ServicesStore.expose=function(name){name=this.get(name);return name&&(window[name.constructor.name]=name),name},ServicesStore.exposeAll=function(){var _this=this,services=this.items;return Object.keys(services).map(function(name){return _this.expose(name)})},ServicesStore.unexpose=function(name){return delete window[name],this},ServicesStore.get=function(name){return this.items[name]},ServicesStore.set=function(service){var items=this.items,name=service.constructor.name;return items[name]=service,this.expose(name),this},ServicesStore.setAll=function(services){var e_1,_a,items=this.items;try{for(var services_1=__values(services),services_1_1=services_1.next();!services_1_1.done;services_1_1=services_1.next()){var service=services_1_1.value,name_1=service.constructor.name;items[name_1]=service,this.expose(name_1)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{services_1_1&&!services_1_1.done&&(_a=services_1.return)&&_a.call(services_1)}finally{if(e_1)throw e_1.error}}return this},ServicesStore.remove=function(name){return delete this.items[name],this.unexpose(name),this},ServicesStore.items={},ServicesStore}());exports.ServicesStore=ServicesStore},{}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addTelListener=exports.addAnchorListener=exports.openURL=void 0;var dialogs_1=require("./dialogs"),network_1=require("./network"),url_1=require("./url");exports.openURL=function(href,type,onClose){var url=new URL("".concat((0,url_1.getNormalizedBaseURL)(),"/redirect.html"));return url.searchParams.append("endpoint",(0,network_1.forceHttps)(href)),{browser:function(url){return Office.context.ui.openBrowserWindow(url.toString())},dialog:function(url){Office.context.ui.displayDialogAsync(url.toString(),{width:150,height:250},function(res){res.value.addEventHandler(Office.EventType.DialogEventReceived,function(event){return(0,dialogs_1.dialogCallback)(event,onClose)})})},web:function(url){url=window.open(url);null!=url&&url.addEventListener("close",function(){(0,dialogs_1.dialogCallback)({error:dialogs_1.DialogErrorCode.CLOSED},onClose)})}}[type](url)},exports.addAnchorListener=function(target,href,type){target.addEventListener("click",function(event){return event.preventDefault(),(0,exports.openURL)(href,type),!1})};exports.addTelListener=function(target){target.addEventListener("click",function(event){return event.stopPropagation(),!(target.target="_self")})}},{"./dialogs":89,"./network":96,"./url":99}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUncollapsedHeight=exports.getComputedNumericProperty=void 0;var html_1=require("./html");exports.getComputedNumericProperty=function(element,property){return(0,html_1.parsePixelLength)(window.getComputedStyle(element)[property])};exports.getUncollapsedHeight=function(element,numberOfUncollapsibleWidgets){var fullHeight=0;if(numberOfUncollapsibleWidgets)for(var children=element.children,chLength=children.length,childIndex=0;childIndex<chLength;childIndex++){var child=children[childIndex],child=window.getComputedStyle(child),computedT=(0,html_1.parsePixelLength)(child.marginTop),computedH=(0,html_1.parsePixelLength)(child.height),child=(0,html_1.parsePixelLength)(child.marginBottom);childIndex<numberOfUncollapsibleWidgets&&(fullHeight+=(0===childIndex?computedT:child)+computedH)}return fullHeight}},{"./html":92}],89:[function(require,module,exports){"use strict";var DialogErrorCode,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},log_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.dialogCallback=exports.DialogErrorCode=void 0,require("./log"));(function(DialogErrorCode){DialogErrorCode[DialogErrorCode.CLOSED=12006]="CLOSED",DialogErrorCode[DialogErrorCode.HTTPS_ERROR=12003]="HTTPS_ERROR",DialogErrorCode[DialogErrorCode.LOAD_ERROR=12002]="LOAD_ERROR"})(DialogErrorCode=exports.DialogErrorCode||(exports.DialogErrorCode={}));exports.dialogCallback=function(event,onClose){var error,eventLog={type:"dialog"};return"error"in event?((error=event.error)===DialogErrorCode.CLOSED&&null!=onClose&&onClose(),(onClose={})[DialogErrorCode.LOAD_ERROR]="The dialog box has been directed to a page that it cannot find or load, or the URL syntax is invalid.",onClose[DialogErrorCode.HTTPS_ERROR]="The dialog box has been directed to a URL with the HTTP protocol. HTTPS is required.",onClose[DialogErrorCode.CLOSED]="Dialog closed.",onClose=onClose,(0,log_1.log)("log","dialog event",__assign(__assign({},eventLog),{event:onClose[error]||"Unknown error in dialog box."}))):(onClose=event.message,(0,log_1.log)("log","dialog event",__assign(__assign({},eventLog),{event:onClose})))}},{"./log":94}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.callFunctionFromGlobalScope=void 0;exports.callFunctionFromGlobalScope=function(name,event){name=window[name];return"function"==typeof name?name(event):void 0}},{}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isSelectedStateFormElement=exports.isOfficeJSstateFormElement=exports.isInputLike=exports.isHTMLAnchorElement=exports.isHTMLTextAreaElement=exports.isElementNode=void 0;exports.isElementNode=function(node){return node.nodeType===Node.ELEMENT_NODE},exports.isHTMLTextAreaElement=function(node){return"textarea"===node.nodeName.toLowerCase()},exports.isHTMLAnchorElement=function(node){return"a"===node.nodeName.toLowerCase()},exports.isInputLike=function(element){return"name"in element&&"value"in element},exports.isOfficeJSstateFormElement=function(element){var classList=element.classList;return["ms-Toggle-input","ms-CheckBox-input","ms-RadioButton-input"].some(function(token){return classList.contains(token)})};exports.isSelectedStateFormElement=function(element){return element.classList.contains("is-selected")||element.checked}},{}],92:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},anchors_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindSelfRemovingListener=exports.stripHTMLMarkup=exports.parseHTMLWidgetContent=exports.sanitizeContent=exports.sanitizeAttributes=exports.bindAnchorListener=exports.parsePixelLength=void 0,require("./anchors")),guards_1=require("./guards"),mailbox_1=require("./mailbox");exports.parsePixelLength=function(length){return Math.ceil(+length.replace("px",""))},exports.bindAnchorListener=function(anchor,rules,defaultHandler){var href=anchor.href;(0,__read(rules.find(function(_a){_a=__read(_a,1)[0];return href.startsWith(_a)})||[,defaultHandler],2)[1])(anchor)},exports.sanitizeAttributes=function(element,allowedAttributes){var e_1,_a,attributes=element.attributes,tagName=element.tagName.toLowerCase();try{for(var attributes_1=__values(attributes),attributes_1_1=attributes_1.next();!attributes_1_1.done;attributes_1_1=attributes_1.next()){var attributeName=attributes_1_1.value.name.toLowerCase();allowedAttributes[tagName].includes(attributeName)||attributes.removeNamedItem(attributeName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{attributes_1_1&&!attributes_1_1.done&&(_a=attributes_1.return)&&_a.call(attributes_1)}finally{if(e_1)throw e_1.error}}return element},exports.sanitizeContent=function(node,allowedNodeNames){var nodeName=node.nodeName.toLowerCase();return allowedNodeNames.includes(nodeName)?node:(allowedNodeNames=document.createTextNode((0,guards_1.isElementNode)(node)?node.outerHTML:node.nodeValue||""),null!=(nodeName=node.parentNode)&&nodeName.replaceChild(allowedNodeNames,node),allowedNodeNames)},exports.parseHTMLWidgetContent=function(parent,content){for(var temp=document.createElement("div"),walker=(temp.innerHTML=content,document.createTreeWalker(temp,NodeFilter.SHOW_ALL,{acceptNode:function(node){return node.nodeType===Node.ATTRIBUTE_NODE?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}})),allowedNodeNames=["b","i","u","s","font","a","time","br"],allowedAttributes={font:["color"],a:["href"]},anchorHandlerRules=[["mailto:",function(anchor){(0,mailbox_1.addMailtoListener)(anchor,anchor.href.replace("mailto:",""))}],["tel:",function(anchor){(0,anchors_1.addTelListener)(anchor)}]],defaultAnchorHandler=function(anchor){(0,anchors_1.addAnchorListener)(anchor,anchor.href,"browser")},current=walker.currentNode;current;)(0,exports.sanitizeContent)(current,allowedNodeNames),(0,guards_1.isElementNode)(current)&&(0,exports.sanitizeAttributes)(current,allowedAttributes),(0,guards_1.isHTMLAnchorElement)(current)&&(0,exports.bindAnchorListener)(current,anchorHandlerRules,defaultAnchorHandler),current=walker.nextNode();return parent.append.apply(parent,__spreadArray([],__read(temp.childNodes),!1)),parent},exports.stripHTMLMarkup=function(content){var temp=document.createElement("div");return temp.innerHTML=content,temp.textContent};exports.bindSelfRemovingListener=function(target,type,callback){function listener(event){callback(event),target.removeEventListener(type,listener)}target.addEventListener(type,listener)}},{"./anchors":87,"./guards":91,"./mailbox":95}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGuid=void 0;exports.getGuid=function(store,seed){void 0===seed&&(seed=1e5);var id=btoa((Math.random()*seed).toString());return store.includes(id)?(0,exports.getGuid)(store,seed):(store.unshift(id),id)}},{}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.log=void 0;exports.log=function(level,message,data){var stamp=(new Date).toISOString(),date=stamp.slice(0,10),stamp=stamp.slice(11);console[level].call(console,{message:message,on:date,at:stamp,data:data})}},{}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addMailtoListener=void 0;exports.addMailtoListener=function(target,to){target.addEventListener("click",function(event){return event.preventDefault(),Office.context.mailbox.displayNewMessageForm({toRecipients:[to]}),!1})}},{}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forceHttps=void 0;exports.forceHttps=function(input){var secure=/^https:\/\//.test(input),insecure=/^http:\/\//.test(input);return secure?input:"https://".concat(insecure?input.substring(7):input)}},{}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProfile=exports.getMailbox=exports.getSettings=exports.supportsSet=void 0;exports.supportsSet=function(name,version){return Office.context.requirements.isSetSupported(name,version.toString())},exports.getSettings=function(){return Office.context.roamingSettings||{get:function(name){name=localStorage.getItem(name);return null===name?void 0:JSON.parse(name)},remove:function(name){localStorage.removeItem(name)},saveAsync:function(callback){null!=callback&&callback({asyncContext:void 0,error:{code:0,message:"",name:""},diagnostics:"",status:Office.AsyncResultStatus.Succeeded,value:void 0})},set:function(name,value){localStorage.setItem(name,JSON.stringify(value))}}},exports.getMailbox=function(){return Office.context.mailbox||{getCallbackTokenAsync:function(callback,asyncContext){callback({asyncContext:asyncContext,diagnostics:{},error:{code:0,message:"",name:""},status:Office.AsyncResultStatus.Succeeded,value:""})},userProfile:(0,exports.getProfile)()}};exports.getProfile=function(){var _a;return(null==(_a=Office.context.mailbox)?void 0:_a.userProfile)||{accountType:"office365",displayName:"",emailAddress:"",timeZone:"UTC"}}},{}],98:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};Object.defineProperty(exports,"__esModule",{value:!0}),exports.safeToString=void 0;exports.safeToString=function(item){var rules=[["string"==typeof item,function(item){return item}],["object"==typeof item&&!!item&&"toString"in item,function(item){return item.toString()}]],rules=__read(rules.find(function(_a){return!!__read(_a,1)[0]})||[,function(item){return Object.prototype.toString.call(item)}],2)[1];return null==rules?void 0:rules(item)}},{}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNormalizedBaseURL=void 0;exports.getNormalizedBaseURL=function(){var origin=location.origin,pathname=location.pathname;return"".concat(origin).concat(pathname.replace("index.html","").replace(/\/$/,""))}},{}],100:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},overlay_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialize=void 0,require("./gas-js/components/overlay")),spinner_1=require("./gas-js/components/spinner"),events_1=require("./gas-js/events");exports.initialize=function(homepageTriggerName){return __awaiter(void 0,void 0,void 0,function(){var event,overlayParent,overlay,spinner,homepageTrigger,cards,CardStore;return __generator(this,function(_a){switch(_a.label){case 0:return event=new events_1.EventObject,overlayParent=document.getElementById("app-overlay"),(overlay=new overlay_1.Overlay("app-body")).setColor("white"),[4,overlay.render(overlayParent)];case 1:return _a.sent(),[4,overlay.show()];case 2:return _a.sent(),(spinner=new spinner_1.Spinner).setSize("large"),[4,spinner.render(overlayParent)];case 3:return _a.sent(),[4,spinner.show()];case 4:if(_a.sent(),"function"!=typeof(homepageTrigger=window[homepageTriggerName]))throw new Error('missing homepage trigger "'.concat(homepageTriggerName,'"'));return[4,homepageTrigger(event)];case 5:if(homepageTrigger=_a.sent(),cards=homepageTrigger instanceof Array?homepageTrigger:[homepageTrigger],cards.at(-1))return[4,(CardStore=window.CardServiceConfig.CardStore).teardown()];throw new Error("Add-In must initialize with at least 1 card");case 6:return _a.sent(),CardStore.reset(cards),[4,CardStore.render(document.getElementById("app-body"))];case 7:return _a.sent(),[4,spinner.hide()];case 8:return _a.sent(),[4,overlay.hide()];case 9:return _a.sent(),[2]}})})}},{"./gas-js/components/overlay":4,"./gas-js/components/spinner":5,"./gas-js/events":7}],101:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},menu_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.readyCallback=void 0,require("./gas-js/components/menu")),universal_1=require("./gas-js/services/card/actions/universal"),log_1=require("./gas-js/utils/log"),office_1=require("./gas-js/utils/office"),strings_1=require("./gas-js/utils/strings"),initialize_1=require("./initialize"),url_1=require("./gas-js/utils/url"),showRootElement=function(id){var root=document.getElementById(id);root?root.style.visibility="visible":(0,log_1.log)("error","missing root element",{id:id})};exports.readyCallback=function(info){return __awaiter(void 0,void 0,void 0,function(){var host,res,_a,_b,homepageTrigger,_c,primaryColor,common,menu;return __generator(this,function(_e){switch(_e.label){case 0:return(host=info.host)!==Office.HostType.Outlook&&(0,log_1.log)("log","initialized outside host application",(0,strings_1.safeToString)(host)),[4,fetch("".concat((0,url_1.getNormalizedBaseURL)(),"/appsscript.json"))];case 1:return(res=_e.sent()).ok?[3,3]:(_a=log_1.log,_b=["error","failed to get manifest"],[4,res.text()]);case 2:return _a.apply(void 0,_b.concat([_e.sent()])),[2];case 3:return[4,res.json()];case 4:return _c=_e.sent().addOns,common=_c.common,_c=_c.gmail,homepageTrigger=_c.homepageTrigger,_c=common.universalActions,common=common.layoutProperties,primaryColor=common.primaryColor,common=common.secondaryColor,menu=new menu_1.AddInMenu,window.CardServiceConfig.set("primaryColor",primaryColor).set("secondaryColor",common).set("menu",menu).validate(),host&&(0,office_1.supportsSet)("Mailbox",1.5)&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,function(){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(_a){return(0,office_1.getSettings)().saveAsync(function(){(0,initialize_1.initialize)(homepageTrigger.runFunction)}),[2]})})}),_c.forEach(function(_a){var label=_a.label,_a=_a.runFunction,action=new universal_1.UniversalAction;action.setText(label),action.setRunFunction(_a),menu.addUniversalAction(action)}),[4,menu.render(document.getElementById("app-menu"))];case 5:return _e.sent(),showRootElement("app-body"),[2,(0,initialize_1.initialize)(homepageTrigger.runFunction)]}})})}},{"./gas-js/components/menu":3,"./gas-js/services/card/actions/universal":26,"./gas-js/utils/log":94,"./gas-js/utils/office":97,"./gas-js/utils/strings":98,"./gas-js/utils/url":99,"./initialize":100}]},{},[15]);
</script>
	<script>
function action(config, message) {
    var event = config.event;
    var params = event.parameters;
    var form = event.formInputs;
    var method = config.method;
    var instance = config.instance;
    if (!message) {
        message = getMessage(event);
    }
    var result;
    switch (method) {
        case "add":
            result = instance.add(message, form);
            break;
        case "confirm":
            result = cardConfirm(params);
            break;
        case "update":
            result = instance.update(message, form);
            break;
        case "remove":
            result = instance.remove(message, params.entity);
            break;
        case "next":
            result = instance.run(message, +params.start);
            break;
        case "back":
            result = instance.run(message, +params.start);
            break;
        default: result = instance.run(message);
    }
    return actionResponse({
        event: event,
        reload: {
            card: result
        }
    });
}
function appendOptions_(widget, entities, parser) {
    switch (widget.type) {
        case Type.KEY_VALUE:
            widget.content += parser.text.separate + entities.map(function (entity) {
                return parser.text.props.map(function (p) {
                    return entity[p];
                }).join(parser.text.join);
            }).join(parser.text.separate);
            break;
        default:
            var content = entities.map(function (entity) {
                return {
                    value: parser.value.props.map(function (p) {
                        return entity[p];
                    }).join(parser.value.join),
                    text: parser.text.props.map(function (p) {
                        return entity[p];
                    }).join(parser.text.join)
                };
            });
            widget.content = widget.content.concat(content);
    }
    return widget;
}
function edit(config) {
    var event = config.event || {};
    var auto = toBoolean(config.auto);
    var params = event.parameters || {};
    var form = event.formInputs || {};
    var cardConfig = JSON.parse(params.card);
    cardConfig.sections.forEach((section, s) => {
        var widgets = section.widgets;
        var hasEditable = widgets.some((w) => {
            return w.state === State.EDITABLE;
        });
        if (hasEditable) {
            widgets.forEach(function (widget, w) {
                if ((+params.index === w && +params.section === s) || !params.index) {
                    section.isCollapsible = false;
                    switchToInput_(widgets, widget, w);
                    if (widget.group) {
                        widgets.forEach(function (w, i) {
                            if (widget.group === w.group) {
                                switchToInput_(widgets, w, i);
                                if (i > 0) {
                                    section.max++;
                                }
                            }
                        });
                    }
                }
            });
            widgets.forEach(function (widget) {
                if (widget.state === State.EDITABLE) {
                    if (auto) {
                        section.widgets.forEach(function (widget) {
                            widget.change = {
                                callback: "action",
                                spinner: true,
                                params: {
                                    method: "update"
                                }
                            };
                        });
                    }
                }
            });
            preserve_(form, widgets);
        }
    });
    return actionResponse({
        event: event,
        reload: {
            type: Reload.CARD,
            card: cardConfig
        }
    });
}
function fetchAndReload(config) {
    var { event, instance } = config;
    var params = event.parameters;
    var fetch = JSON.parse(params.fetch);
    var display = JSON.parse(params.display);
    var sindex = +params.section;
    var windex = +params.widget;
    var card = JSON.parse(params.card);
    var section = card.sections[sindex];
    try {
        fetch.params.apply[fetch.params.apply.length - 1] += fetch.params.increment;
        var response = instance[fetch.callback].apply(instance, fetch.params.apply);
        if (windex) {
            var widget = section.widgets[windex];
            try {
                if (response.length > 0) {
                    var wDisplay = widget.more.display;
                    var edit = wDisplay.edit;
                    var show = wDisplay.show;
                    if (show) {
                        appendOptions_(widget, response, show);
                    }
                    if (edit) {
                        widget.map.forEach(function (mapper, m) {
                            if (edit.widgets.indexOf(m) !== -1) {
                                appendOptions_(mapper, response, edit);
                            }
                        });
                    }
                    widget.more.fetch.params.apply[widget.more.fetch.params.apply.length - 1] += widget.more.fetch.params.increment;
                    section.isCollapsible = false;
                }
                else {
                    return actionResponse({
                        event: event,
                        notify: "No more " + (widget.more.entity ? widget.more.entity : "info") + " to display"
                    });
                }
            }
            catch (error) {
                timestamp("failed to add " + (widget.more.entity ? widget.more.entity : "info") + " to widget", error, "warning");
                return actionResponse({
                    event: event,
                    notify: "Failed to display more " + (widget.more.entity ? widget.more.entity : "info")
                });
            }
        }
        else {
            try {
                var fetchWidget = getByProperty(section.widgets, "id", "fetcher");
                fetchWidget.click.params.fetch.params.apply[fetch.params.apply.length - 1] += fetch.params.increment;
                if (response.length > 0) {
                    display.params.apply[display.params.argument || 0] = response;
                    var display = instance[display.callback].apply(instance, display.params.apply);
                    var temp = section.widgets.pop();
                    section.widgets = section.widgets.concat(display);
                    section.widgets.push(temp);
                    section.numUncollapsible = section.widgets.length + 1;
                    fetchWidget.click.params.card.sections[sindex] = copyObject(section);
                }
                else {
                    return actionResponse({
                        event: event,
                        notify: "No more " + (params.entity ? params.entity : "info") + " to display"
                    });
                }
            }
            catch (error) {
                timestamp("failed to display fetched", error, "warning");
                return actionResponse({
                    event: event,
                    notify: "Failed to display more " + (params.entity ? params.entity : "info")
                });
            }
        }
    }
    catch (error) {
        timestamp("failed to fetch", error, "warning");
        return actionResponse({
            event: event,
            notify: "Failed to fetch more " + (params.entity ? params.entity : "info")
        });
    }
    card.sections.forEach(function (section) {
        preserve_(event.formInputs, section.widgets);
    });
    return actionResponse({
        event: event,
        refresh: true,
        reload: {
            card: card
        }
    });
}
function switchToInput_(widgets, widget, index) {
    if (widget.state === State.EDITABLE) {
        if (widget.map) {
            widgets.splice(index, 1);
            widget.map.forEach((el, m) => {
                if (!el.type) {
                    el.type = Type.TEXT_INPUT;
                }
                if ((/\r|\n/g).test(widget.content)) {
                    el.multiline = true;
                }
                widgets.splice(index + m, 0, el);
            });
        }
        else {
            widget.type = Type.TEXT_INPUT;
        }
    }
}
function actionBuilder({ callback, library, params = {}, spinner = false }) {
    const action = CardService.newAction();
    if (!callback) {
        throw new Error("Action should have a callback name");
    }
    action.setFunctionName(library ? `${library}.${callback}` : callback);
    action.setParameters(propertiesToString(params));
    if (spinner) {
        action.setLoadIndicator(CardService.LoadIndicator.SPINNER);
    }
    return action;
}
const errorDecorator = (handler, callback) => (...args) => {
    try {
        return callback(...args);
    }
    catch (error) {
        return handler(error);
    }
};
const actionDecorator = (widget, widgetConfig) => {
    if (!widgetConfig) {
        return widget;
    }
    const common = { widget, ...widgetConfig };
    const strategies = new Map();
    strategies.set("auth", authStrategy);
    strategies.set("change", changeStrategy);
    strategies.set("click", clickStrategy);
    strategies.set("compose", composeStrategy);
    strategies.set("suggest", suggestStrategy);
    strategies.set("link", openLinkStrategy);
    Object.entries(common).forEach(([k, v]) => {
        const strategy = strategies.get(k);
        if (k === "link") {
            return strategy(widget, isStr(v) ? { url: v } : v);
        }
        isFunc(strategy) && strategy(widget, v);
    });
    return widget;
};
const iconDecorator = (widget, { icon }) => {
    if (!icon) {
        return widget;
    }
    const iconEnum = CardService.Icon[icon];
    if ("setStartIcon" in widget) {
        const image = CardService.newIconImage();
        widget.setStartIcon(/^https?:/.test(icon) ? image.setIconUrl(icon) : image.setIcon(iconEnum || icon));
        return widget;
    }
    if (!("setIconUrl" in widget) || !("setIcon" in widget)) {
        return widget;
    }
    if (/^https?:/.test(icon)) {
        widget.setIconUrl(icon);
        return widget;
    }
    widget.setIcon(iconEnum || icon);
    return widget;
};
const labelDecorator = (widget, { title, hint, color, titleColor, hintColor }) => {
    if (color) {
        title = Formatter.colorize(titleColor || color, title);
        hint = Formatter.colorize(hintColor || color, hint);
    }
    if ("setTopLabel" in widget && title) {
        widget.setTopLabel(title);
    }
    if ("setBottomLabel" in widget && hint) {
        widget.setBottomLabel(hint);
    }
    if ("setTitle" in widget && title) {
        widget.setTitle(title);
    }
    if ("setHint" in widget && hint) {
        widget.setHint(hint);
    }
    return widget;
};
const suggestionDecorator = (widget, { suggestions = [] }) => {
    if (!("setSuggestions" in widget) || !suggestions.length) {
        return widget;
    }
    const suggs = CardService.newSuggestions();
    suggestions.forEach((sug) => suggs.addSuggestion(sug));
    widget.setSuggestions(suggs);
    return widget;
};
const buttonDecorator = (widget, options) => {
    if (!("setButton" in widget) || !options) {
        return widget;
    }
    const { type = WidgetType.TEXT_BUTTON } = options;
    const buttonTemplates = {
        [WidgetType.IMAGE_BUTTON]: imageButtonWidget,
        [WidgetType.TEXT_BUTTON]: textButtonWidget,
    };
    const handler = buttonTemplates[type];
    if (typeof handler === "function") {
        widget.setButton(handler(options));
    }
    return widget;
};
var globalEnumReplyDraft = "REPLY_AS_DRAFT";
var globalEnumStandalone = "STANDALONE_DRAFT";
var Auth = Object.freeze({
    API_TOKEN: "api_token",
    BASIC: "basic",
    UC: "user_credentials",
    OAUTH2: "oauth2",
    QUERY: "query",
    SERVICE: "service",
});
var Mime = Object.freeze({
    FORM: "application/x-www-form-urlencoded",
    JSON: "application/json",
    XML: "application/xml",
    TEXT: "text/plain",
});
var Token = Object.freeze({
    ID: "id_token",
    ACCESS: "access_token",
});
var Icon = Object.freeze({
    ACCOUNT: "account_box",
    ADD: "add",
    ACTIVITIES: "assignment",
    BACK_ARROW: "arrow_back",
    BACKGROUND: "description",
    BIRTHDAY: "cake",
    CALL_IN: "call",
    CALL_OUT: "call_made",
    CALL_MISSED: "call_missed",
    CALL_ENDED: "call_end",
    COMPANY: "business",
    CUSTOM: "add_circle",
    DEAL: "fa-solid fa-file",
    DEAL_CLOSED: "fa-solid fa-file-export",
    DEAL_LOST: "fa-solid fa-file-slash",
    DEAL_OPEN: "fa-solid fa-file-import",
    DEAL_QUAL: "fa-solid fa-file-magnifying-glass",
    DEAL_WON: "fa-solid fa-file-check",
    DEPARTMENT: "badge",
    DIALPAD: "dialpad",
    DOWNLOAD: "cloud_download",
    EDIT: "edit",
    EMAIL_DIRECT: "contact_mail",
    EMAIL_HOME: "home",
    EMAIL_MOBILE: "smartphone",
    EMAIL_OFFICE: "alternate_email",
    EURO: "euro_symbol",
    EVENT_RECURRENT: "event_repeat",
    INBOX: "inbox",
    INDUSTRY: "domain",
    FACEBOOK: `fa-brands fa-facebook`,
    FAX: "fax",
    FIRE: "local_fire_department",
    FLAG: "flag",
    FORWARD: "chevron_right",
    FORWARD_ARROW: "arrow_forward",
    JOB_TITLE: "business_center",
    LINK: "link",
    LIST: "list",
    LOST_INFO: "help",
    MAP_BILL: "local_atm",
    MAP_MAIL: "email",
    MAP_SHIP: "local_shipping",
    MEETING_MISSED: "group_off",
    NUMBER: "pin",
    NOTES: "notes",
    OPEN: "open_in_new",
    OVERDUE: "pending_actions",
    PHONE_DIRECT: "phone_forwarded",
    PHONE_HOME: "home",
    PHONE_MOBILE: "smartphone",
    PHONE_WORK: "headset",
    REFRESH: "refresh",
    REMOVE: "delete",
    RESET: "power_settings_new",
    SAVE: "save",
    SEARCH: "search",
    SENT: "send",
    SETTINGS: "settings",
    SKYPE: "fa-brands fa-skype",
    SHOW: "visibility",
    SWITCH: "visibility_off",
    TAB: "tab",
    TASK: "done",
    TASK_DONE: "done_all",
    TASK_FAILED: "remove_done",
    TEXT: "title",
    TIME_RECURRENT: "update",
    TWITTER: `fa-brands fa-twitter`,
    TWITTER_CIRCLE: `fa-brands fa-square-twitter`,
    WARNING: "warning",
    WEB: "public",
    WEBHOOK: "webhook",
    UPLOAD: "cloud_upload",
});
var Reload = Object.freeze({
    ACTION: "action",
    CALLBACK: "callback",
    CONFIG: "config",
});
var Response = Object.freeze({
    UNIVERSAL: "universal",
    COMPOSE: "compose",
    ACTION: "action",
});
var Show = Object.freeze({
    UPDATED: "updated",
    RESET: "reset",
});
var WidgetState = Object.freeze({
    EDITABLE: "EDITABLE",
    HIDDEN: "HIDDEN",
});
var WidgetType = Object.freeze({
    BUTTON_SET: "BUTTON_SET",
    get CHECK_BOX() {
        return CardService.SelectionInputType.CHECK_BOX;
    },
    get DROPDOWN() {
        return CardService.SelectionInputType.DROPDOWN;
    },
    IMAGE: "IMAGE",
    KEY_VALUE: "KEY_VALUE",
    IMAGE_BUTTON: "IMAGE_BUTTON",
    get RADIO() {
        return CardService.SelectionInputType.RADIO_BUTTON;
    },
    TEXT_BUTTON: "TEXT_BUTTON",
    TEXT_INPUT: "TEXT_INPUT",
    TEXT_PAR: "TEXT_PAR",
    GRID: "GRID",
});
var section = errorDecorator((err) => console.warn(`section is misconfigured: ${err}`), (config, sectionIndex = 0) => {
    const section = CardService.newCardSection();
    const { sections = [] } = config;
    var sectionConfig = sections[sectionIndex];
    let { isCollapsible, numUncollapsible = 0 } = sectionConfig;
    const { fetch, header, max, start = 0, widgets = [], more, } = sectionConfig;
    let numSeparators = 0;
    let current = 0;
    const parsedWidgets = [];
    for (let index = start; index < widgets.length; index++) {
        var widget = validateConfig(widgets[index] || {}, sectionIndex, index);
        const { content, state, type } = widget;
        if (state === WidgetState.HIDDEN) {
            continue;
        }
        if (!type) {
            throw new Error(`widget config should have a type`);
        }
        if (index + numSeparators >= start + max) {
            continue;
        }
        current++;
        switch (type) {
            case WidgetType.TEXT_PAR:
                parsedWidgets.push(textWidget(widget));
                break;
            case WidgetType.IMAGE:
                parsedWidgets.push(imageWidget(widget));
                break;
            case WidgetType.BUTTON_SET:
                parsedWidgets.push(getButtonSetWidget(widget));
                break;
            case WidgetType.IMAGE_BUTTON:
                parsedWidgets.push(imageButtonWidget(widget));
                break;
            case WidgetType.GRID:
                parsedWidgets.push(getGridWidget(widget));
                break;
            case WidgetType.TEXT_BUTTON:
                parsedWidgets.push(textButtonWidget(widget));
                break;
            case WidgetType.KEY_VALUE:
                parsedWidgets.push(keyValueWidget(widget));
                break;
            case WidgetType.TEXT_INPUT:
                parsedWidgets.push(textInputWidget(widget));
                break;
            case WidgetType.RADIO:
            case WidgetType.CHECK_BOX:
            case WidgetType.DROPDOWN:
                parsedWidgets.push(selectionInputWidget(widget));
                break;
        }
        pushIf(parsedWidgets, makeFetchMoreWidget(widget, sectionIndex, index));
        if (widget.spaceAfter && index + numSeparators + 2 < start + max && index < widgets.length - 1) {
            parsedWidgets.push(textWidget({ content: "\r" }));
            numSeparators++;
            if (isCollapsible && numUncollapsible) {
                numUncollapsible++;
            }
        }
        pushIf(parsedWidgets, makeMultiplyWidget(config, widget, sectionIndex, index));
    }
    if (!parsedWidgets.length) {
        return;
    }
    parsedWidgets.forEach((w) => section.addWidget(w));
    var fetcher = getByProperty(sectionConfig.widgets, "id", "fetcher");
    if (more && !fetcher) {
        var fetchParams = copyObject(more, {
            card: copyObject(config, {}),
            section: sectionIndex,
        });
        fetcher = {
            icon: Icon.DOWNLOAD,
            state: WidgetState.HIDDEN,
            title: "Load more " + more.entity,
            id: "fetcher",
            click: { callback: "fetch", params: fetchParams },
        };
        fetchParams.card.sections[sectionIndex].widgets.push(copyObject(fetcher, {}));
        section.addWidget(keyValueWidget({ content: "\r" }));
        section.addWidget(keyValueWidget(fetcher));
    }
    else if (more) {
        section.addWidget(keyValueWidget({ content: "\r" }));
        section.addWidget(keyValueWidget(fetcher));
    }
    header && section.setHeader(header);
    const backAndNext = [];
    if (start > 0) {
        isCollapsible = false;
        backAndNext.push(getBackButtonConfig(config, sectionConfig, sectionIndex, start, max));
    }
    if (start + max - numSeparators < widgets.length) {
        backAndNext.push(getNextButtonConfig(config, sectionIndex, start, max, numSeparators));
    }
    if (backAndNext.length > 0) {
        section.addWidget(getButtonSetWidget({ content: backAndNext }));
    }
    if (isCollapsible) {
        section.setCollapsible(isCollapsible);
        section.setNumUncollapsibleWidgets(numUncollapsible);
    }
    return section;
});
var card = errorDecorator((err) => timestamp(`card is misconfigured`, err, "warning"), (config) => {
    const builder = CardService.newCardBuilder();
    const { actions = [], build = true, header, name, sections = [], } = config;
    header && builder.setHeader(cardHeader(header));
    name && builder.setName(name);
    const MAX_WIDGETS = +getGlobal_("MAX_WIDGETS", "12");
    if (!sections.length) {
        throw new Error("Cards should have at least one section");
    }
    const parsedSections = sections.map((s, i) => {
        s.max = s.max || MAX_WIDGETS;
        s.numUncollapsible = s.numUncollapsible || 0;
        return section(config, i);
    });
    parsedSections.filter(Boolean).forEach((s) => builder.addSection(s));
    actions.forEach((action) => builder.addCardAction(cardAction(action)));
    return build ? builder.build() : builder;
});
var deck = (config) => ensureArray(config).map(card);
var Fetcher = class {
    static isSuccess(response) {
        const { code } = response;
        return code >= 200 && code < 300;
    }
};
function fetchAuthorized(config, auth, payload) {
    if (!config || !config.url)
        throw new URIError("no url property or config object provided");
    if (!auth)
        auth = {};
    try {
        var params = {
            method: (config.method || "get").toLowerCase(),
            muteHttpExceptions: true,
            contentType: config.type || Mime.JSON,
        };
        params.headers = config.headers || {};
        if (params.method !== "get" && payload) {
            switch (params.contentType) {
                case Mime.FORM:
                    if (typeof payload === "object")
                        params.payload = JSONtoQuery(payload);
                    break;
                default: params.payload = JSON.stringify(payload);
            }
        }
        var query = JSONtoQuery(config.params);
        var url = config.url + (query.length ? "?" + query : "");
        switch (auth.type) {
            case Auth.QUERY:
                url += (query.length ? "&" : "?") + JSONtoQuery(auth.query);
                break;
            case Auth.API_TOKEN:
                if (auth.query) {
                    url += "&" + auth.query + "=" + auth.token;
                }
                if (auth.basic) {
                    params.headers.Authorization = "Basic " + Utilities.base64Encode(auth.token + auth.basic);
                }
                break;
            case Auth.BASIC:
                params.headers.Authorization = "Basic " + Utilities.base64Encode((auth.id + ":" + auth.pass) || auth.token);
                break;
            case Auth.OAUTH2:
                if (auth.token) {
                    params.headers.Authorization = "Bearer " + auth.token;
                }
                else {
                }
                break;
            case Auth.SERVICE:
                var token = auth.token;
                if (!token) {
                    var serviceSA = serviceAccount(auth);
                    if (serviceSA) {
                        try {
                            if (serviceSA.hasAccess()) {
                                serviceSA.exchangeJwt_();
                                switch (auth.tokenType) {
                                    case Token.ID:
                                        token = serviceSA.getIdToken();
                                        break;
                                    default: token = serviceSA.getAccessToken();
                                }
                            }
                            else {
                                timestamp("service account not authorized", {
                                    error: serviceSA.getLastError(),
                                    name: auth.name || "name not provided",
                                    type: "fetch"
                                }, "warning");
                            }
                        }
                        catch (serviceError) {
                            timestamp("error during service account", {
                                error: serviceError,
                                name: auth.name || "name not provided",
                                type: "fetch"
                            }, "error");
                        }
                    }
                }
                if (token) {
                    params.headers.Authorization = "Bearer " + token;
                }
                break;
            default:
        }
        if (config.encode || config.encode === undefined)
            url = encodeURI(url);
        var response = UrlFetchApp.fetch(url, params);
        var code = response.getResponseCode();
        var heads = response.getAllHeaders();
        if (config.retry && !isNaN(+config.retry) && code > 400) {
            while (+config.retry) {
                response = UrlFetchApp.fetch(url, params);
                +config.retry--;
            }
        }
        if (config.followLocation && code === 201 && heads["Location"]) {
            config.url = heads["Location"];
            return fetchAuthorized(config, auth, payload);
        }
        return handleResponse(response, { config, auth, payload });
    }
    catch (error) {
        return handleRequestError_(error);
    }
}
function handleRequestError_(error) {
    console.warn("HTTP request failed due to: %s", error);
    var card = generateCard(true);
    card.header.title = "Request failed";
    card.sections[0].widgets[0] = {
        type: Type.KEY_VALUE,
        content: "Request to the endpoint failed"
    };
    return {
        code: 0,
        headers: {},
        content: error,
        defaultCard: card
    };
}
function handleResponse(response, request) {
    var code = response.getResponseCode();
    var headers = response.getAllHeaders();
    var content = response.getContentText();
    for (var key in headers) {
        var lcased = key.toLowerCase();
        if (lcased !== key) {
            headers[lcased] = headers[key];
            delete headers[key];
        }
    }
    var card = generateCard(true);
    switch (code) {
        case 201:
            card.header.title = "Created";
            card.sections[0].widgets[0] = {
                content: "The resource was successfully created"
            };
            if (headers["location"])
                card.sections[0].widgets.push({
                    title: "Location available",
                    content: "The newly created resource is available at\n" + headers["location"]
                });
            break;
        case 202:
            card.header.title = "Accepted";
            card.sections[0].widgets[0] = {
                content: "The request was received and is accepted"
            };
            break;
        case 203:
            card.header.title = "Non-Authoritative Information";
            card.sections[0].widgets[0] = {
                content: "The request was successful and the response payload is transformed"
            };
            break;
        case 204:
            card.header.title = "No Content";
            card.sections[0].widgets[0] = {
                content: "The request was successful and nothing is returned by the service"
            };
            break;
        case 205:
            card.header.title = "Reset Content";
            card.sections[0].widgets[0] = {
                content: "The response asked to reset the document view (debug info)"
            };
            break;
        case 206:
            card.header.title = "Partial Content";
            card.sections[0].widgets[0] = {
                content: "The response body contains only partial data"
            };
            break;
        case 400:
            card.header.title = "Bad request";
            card.sections[0].widgets[0] = {
                content: "The request is malformed or the service could not handle it correctly"
            };
            break;
        case 401:
            card.header.title = "Unauthorized";
            if (headers["www-authenticate"]) {
            }
            break;
        case 402:
            card.header.title = "Payment Required";
            break;
        case 403:
            card.header.title = "Forbidden";
            card.sections[0].widgets[0] = {
                content: "The requested service refused to connect"
            };
            break;
        case 404:
            card.header.title = "Not found";
            break;
        case 405:
            card.header.title = "Method Not Allowed";
            card.sections[0].widgets[0] = {
                content: "The request was made with method not allowed by the service"
            };
            if (request) {
                card.sections[0].widgets.push({
                    title: "Current method",
                    content: (request.config.method || "GET").toUpperCase()
                }, {
                    title: "Allowed methods",
                    content: ""
                });
            }
            break;
        case 406:
            card.header.title = "Not Acceptable";
            break;
        case 408:
            card.header.title = "Request Timeout";
            break;
        case 409:
            card.header.title = "Conflict";
            break;
        case 411:
            if (request && request.payload) {
                request.config.headers = request.config.headers || {};
                request.config.headers["Content-Length"] = request.payload;
                response = fetchAuthorized(request.config, request.auth, request.payload);
                return handleResponse(response, request);
            }
            break;
        case 412:
            card.header.title = "Precondition failed";
            if (request && request.config) {
                request.config.headers = request.config.headers || {};
                if (request.config.headers["if-unmodified-since"])
                    card.sections[0].widgets[0] = {
                        content: "The requested resource has been modified after " + new Date(request.config.headers["if-unmodified-since"]).toLocaleString()
                    };
            }
            break;
        case 413:
            card.header.title = "Payload too large";
            card.sections[0].widgets[0] = {
                content: "Request payload is too large for the service to handle"
            };
            break;
        case 414:
            card.header.title = "URI Too long";
            card.sections[0].widgets[0] = {
                content: "Consider shortening the URI provided - the service could not handle it"
            };
            break;
        case 415:
            card.header.title = "Unsupported Media Type";
            card.sections[0].widgets[0] = {
                content: "The payload format is unsupported by the service"
            };
            break;
        case 416:
            card.header.title = "Range Not Satisfiable";
            card.sections[0].widgets[0] = {
                content: "The requested range could not be returned by the service"
            };
            if (headers["content-range"]) {
                var range416 = parseContentRangeHeader(headers["content-range"]);
                card.sections[0].widgets.push({
                    title: "Expected range",
                    content: "Units: " + range416.units + "\rFull: " + range416.full
                });
            }
            break;
        case 417:
            card.header.title = "Expectation Failed";
            card.sections[0].widgets[0] = {
                content: "The service could not meet the request's expectations"
            };
            break;
        case 418:
            card.header.title = "I'm a teapot";
            card.sections[0].widgets[0] = {
                content: "You can't brew coffee in a teapot"
            };
            break;
        case 422:
            card.header.title = "Unprocessable Entity";
            card.sections[0].widgets[0] = {
                content: "The request could not be processed by the service"
            };
            break;
        case 425:
            card.header.title = "Too Early";
            break;
        case 426:
            card.header.title = "Upgrade Required";
            card.sections[0].widgets[0] = {
                content: "The service requires an upgrade to a different protocol"
            };
            if (headers["upgrade"]) {
                card.sections[0].widgets.push({
                    title: "Requested upgrade",
                    content: "The service requested an upgrade to " + (headers["upgrade"].split(/,\s*/).join(", "))
                });
            }
            break;
        case 428:
            card.header.title = "Precondition Required";
            card.sections[0].widgets[0] = {
                content: "The request should be made conditional"
            };
            break;
        case 429:
            card.header.title = "Too many requests";
            card.sections[0].widgets[0] = {
                content: "The request exceeded service's rate or quota limit - try again later"
            };
            if (headers["retry-after"]) {
                var retry429 = headers["retry-after"];
                card.sections[0].widgets.push({
                    title: "Wait estimate",
                    content: "The request should be allowed" + (isNaN(+retry429) ? retry429 = " after \r\n" + new Date(retry429).toLocaleString() : " in " + +retry429 / 3600 + " H")
                });
            }
            break;
        case 451:
            card.header.title = "Unavailable For Legal Reasons";
            card.sections[0].widgets[0] = {
                content: "The requested resource is unavailable due to legal reasons"
            };
            break;
        case 500:
            card.header.title = "Internal Server Error";
            card.sections[0].widgets[0] = {
                content: "The service could not handle the request due to an internal problem"
            };
            break;
        case 501:
            card.header.title = "Not Implemented";
            var method501 = "GET";
            if (request && request.config.method)
                method501 = request.config.method.toUpperCase();
            card.sections[0].widgets[0] = {
                content: "The " + method501 + " method used with the request is not yet implemented by the service"
            };
            if (headers["retry-after"]) {
                var retry501 = headers["retry-after"];
                card.sections[0].widgets.push({
                    title: "Implementation estimate",
                    content: "The method should be implemented" + (isNaN(+retry501) ? retry501 = " after \r\n" + new Date(retry501).toLocaleString() : " in " + +retry501 / 3600 + " H")
                });
            }
            break;
        case 502:
            card.header.title = "Bad Gateway";
            card.sections[0].widgets[0] = {
                content: "The service gateway could not handle the request"
            };
            break;
        case 503:
            card.header.title = "Service Unavailable";
            card.sections[0].widgets[0] = {
                content: "The service is temporarily unavailable - try again later"
            };
            if (headers["retry-after"]) {
                var retry503 = headers["retry-after"];
                card.sections[0].widgets.push({
                    title: "Estimated downtime",
                    content: "The service should be available" + (isNaN(+retry503) ? retry503 = " after \r\n" + new Date(retry503).toLocaleString() : " in " + +retry503 / 3600 + " H")
                });
            }
            break;
        case 504:
            card.header.title = "Gateway Timeout";
            card.sections[0].widgets[0] = {
                content: "The service gateway could not get the response in time"
            };
            break;
        case 505:
            card.header.title = "HTTP Version Not Supported";
            card.sections[0].widgets[0] = {
                content: "The HTTP version used by the request is not supported by the service"
            };
            break;
        case 506:
            card.header.title = "Variant Also Negotiates";
            card.sections[0].widgets[0] = {
                content: "Content negotiation with the service failed due to an internal service problem"
            };
            break;
        case 511:
            card.header.title = "Network Authentication Required";
            card.sections[0].widgets[0] = {
                content: "You are required to authenticate to the network the service uses"
            };
            break;
        default:
            card.header.title = "Success";
            card.sections[0].widgets[0] = {
                content: "The request was successful and returned nothing in response"
            };
    }
    return {
        code: code,
        headers: headers,
        content: content,
        defaultCard: card,
        isFailure: function () {
            return code >= 400 || code === 0;
        },
        isSuccess: function () {
            return code >= 200 && code < 300;
        }
    };
}
function validateMethod(method) {
    if (!method || typeof method !== "string")
        return false;
    var mRegExp = /(^connect$)|(^get$)|(^head$)|(^put$)|(^post$)|(^delete$)|(^options$)|(^trace$)|(^patch$)/i;
    return mRegExp.test(method);
}
function parseAuthenticateHeader(header) {
    var authenticate = {
        schema: null,
        realm: null
    };
    if (!header || typeof header !== "string")
        return authenticate;
    var aRegExp = /(?:WWW-Authenticate|Proxy-Authenticate)\s+(Basic|Bearer|Digest|HOBA|Mutual|OAuth)(?=\s+realm="(.+)"|\s*$)/;
    var matched = header.match(aRegExp);
    if (!matched)
        return authenticate;
    authenticate.schema = matched[1] || null;
    authenticate.realm = matched[2] || null;
    return authenticate;
}
function parseContentRangeHeader(header) {
    var range = {
        units: null,
        start: null,
        end: null,
        full: null
    };
    if (!header || typeof header !== "string")
        return range;
    var rRegExp = /(\w+)\s+(?:(\d+)\-(\d+)|(\*))(?=\/(?:(\d+)|(\*)))/;
    var matched = header.match(rRegExp);
    range.units = matched[1] || "bytes";
    range.start = +matched[2] || null;
    range.end = +matched[3] || null;
    range.full = +matched[5] || null;
    return range;
}
function acceptsPayload(method) {
    if (!validateMethod(method))
        return false;
    switch (method.toUpperCase()) {
        case "GET":
        case "CONNECT":
        case "OPTIONS":
        case "TRACE":
        case "HEAD":
            return false;
            break;
        default: return true;
    }
}
function getGlobal_(key, def) {
    const props = PropertiesService.getScriptProperties();
    const value = props.getProperty(key);
    if (value === null && def !== void 0) {
        return def;
    }
    try {
        return JSON.parse(value);
    }
    catch (e) {
    }
    return value;
}
function getProperty(key) {
    var props = PropertiesService.getUserProperties();
    var value = props.getProperty(key);
    try {
        value = JSON.parse(value);
    }
    catch (e) {
    }
    return value;
}
function getProperties() {
    var props = PropertiesService.getUserProperties();
    var values = props.getProperties();
    try {
        values = JSON.parse(values);
    }
    catch (e) {
    }
    return values;
}
function setProperty(key, value) {
    var props = PropertiesService.getUserProperties();
    try {
        value = JSON.stringify(value);
    }
    catch (e) {
    }
    props.setProperty(key, value);
}
function getFromStore(store, key) {
    var value = store.getProperty(key);
    try {
        value = JSON.parse(value);
    }
    catch (error) {
    }
    return value;
}
function setToStore(store, key, value) {
    try {
        value = JSON.stringify(value);
    }
    catch (error) {
    }
    store.setProperty(key, value);
}
function clearStore(store) {
    store.deleteAllProperties();
}
function setProperties(properties) {
    var props = PropertiesService.getUserProperties();
    for (var key in properties) {
        var value = properties[key];
        try {
            properties[key] = JSON.stringify(value);
        }
        catch (e) {
        }
    }
    props.setProperties(properties);
}
function deleteProperty(key) {
    var props = PropertiesService.getUserProperties();
    props.deleteProperty(key);
}
function deleteAllProperties() {
    var props = PropertiesService.getUserProperties();
    props.deleteAllProperties();
}
function initialize(g, identifier) {
    if (!g.paginate) {
        g.paginate = function (e) {
            var params = e.parameters;
            return this[identifier].actionResponse({
                event: e,
                reload: {
                    card: JSON.parse(params.card)
                }
            });
        };
    }
    if (!g.MULTIPLY) {
        g.MULTIPLY = function (e) {
            try {
                var params = e.parameters;
                var card = JSON.parse(params.card);
                var sIdx = +params.section;
                var wIdx = +params.widget;
                var multiplied = card.sections[sIdx].widgets[wIdx];
                if (multiplied) {
                    card.sections[sIdx].widgets.splice(wIdx + 1, 0, copyObject(multiplied, {}));
                }
                return this[identifier].actionResponse({
                    event: e,
                    reload: {
                        card: card
                    }
                });
            }
            catch (error) {
                timestamp("failed to add widget", {
                    error: error,
                    type: "multiply"
                }, "warning");
                return this[identifier].actionResponse({
                    event: e,
                    notify: "Failed to add another widget"
                });
            }
        };
    }
}
function mute(onerror, muted, context) {
    if (!typeof muted === "function")
        throw new Error("Only functions can be muted");
    (context || this)[muted.name] = function () {
        try {
            return muted.apply(context || null, Array.prototype.slice.call(arguments));
        }
        catch (error) {
            if (onerror) {
                return onerror.bind(context || this, error).call();
            }
            else {
                console.log(error);
            }
        }
    };
}
function save(config) {
    var data = config.data;
    data.timestamp = [new Date().toUTCString()];
    var loaded = getProperty(config.name);
    if (loaded) {
        for (var key in data) {
            loaded[key] = data[key];
        }
        if (!config.keep) {
            if (config.fields) {
                if (typeof config.fields === "string") {
                    config.fields = config.fields.split(",");
                }
                config.fields.forEach(function (field) {
                    if (!data[field]) {
                        delete loaded[field];
                    }
                });
            }
            else {
                for (var key in loaded) {
                    if (!data[key]) {
                        delete loaded[key];
                    }
                }
            }
        }
        else if (config.current) {
            if (!data[config.current])
                delete loaded[config.current];
        }
        setProperty(config.name, loaded);
    }
    else {
        setProperty(config.name, data);
    }
    if (config.respond) {
        return actionResponse(config.respond);
    }
}
function load(config) {
    var saved = getProperty(config.name);
    if (saved) {
        var tstamp = new Date(saved.timestamp[0]);
        if (config.sections) {
            config.sections.forEach(function (i) {
                preserve_(saved, i.widgets, true);
            });
            var show = config.show || [];
            if (show.length > 0) {
                var utility = {
                    widgets: []
                };
                show.forEach(function (sh) {
                    switch (sh) {
                        case Show.UPDATED:
                            utility.widgets.push({
                                type: Type.KEY_VALUE,
                                icon: "CLOCK",
                                title: "Last updated",
                                content: tstamp.toLocaleString()
                            });
                            break;
                        case Show.RESET:
                            utility.widgets.push({
                                type: Type.KEY_VALUE,
                                icon: Icon.RESET,
                                content: "Reset all settings",
                                click: { callback: "reset" },
                                spaceBefore: true
                            });
                            break;
                    }
                });
                config.sections.push(utility);
            }
            saved.sections = config.sections;
        }
    }
    return saved;
}
function reset(config) {
    deleteAllProperties();
    if (config.respond) {
        return actionResponse(config.respond);
    }
}
const authStrategy = (widget, { url }) => {
    if (!("setAuthorizationAction" in widget)) {
        return widget;
    }
    const auc = CardService.newAuthorizationAction();
    auc.setAuthorizationUrl(url);
    widget.setAuthorizationAction(auc);
    return widget;
};
const changeStrategy = (widget, { ...config }) => {
    if (!("setOnChangeAction" in widget)) {
        return widget;
    }
    widget.setOnChangeAction(actionBuilder(config));
    return widget;
};
const clickStrategy = (widget, { ...config }) => {
    if (!("setOnClickAction" in widget)) {
        return widget;
    }
    widget.setOnClickAction(actionBuilder(config));
    return widget;
};
const composeStrategy = (widget, { standalone, ...config }) => {
    if (!("setComposeAction" in widget)) {
        return widget;
    }
    const { ComposedEmailType: { REPLY_AS_DRAFT, STANDALONE_DRAFT } } = CardService;
    const etype = standalone ? STANDALONE_DRAFT : REPLY_AS_DRAFT;
    widget.setComposeAction(actionBuilder(config), etype);
    return widget;
};
const suggestStrategy = (widget, { ...config }) => {
    if (!("setSuggestionsAction" in widget)) {
        return widget;
    }
    widget.setSuggestionsAction(actionBuilder(config));
    return widget;
};
const openLinkStrategy = (widget, { ...config }) => {
    if (!("setOpenLink" in widget)) {
        return widget;
    }
    const { url, callback } = config;
    if (!url && !callback) {
        throw new Error("Link config should have callback name or Url set");
    }
    if (url) {
        widget.setOpenLink(openLink(config));
    }
    if (callback) {
        widget.setOnClickOpenLinkAction(actionBuilder(config));
    }
    return widget;
};
function initialize_() {
    var sp = PropertiesService.getScriptProperties();
    sp.setProperties({
        MAX_WIDGETS: "12",
    });
}
function cardConfirm(params, build) {
    const { cancel, confirm, prompt } = params;
    var confirmParams = JSON.parse(confirm);
    var cancelParams = JSON.parse(cancel);
    var confirmer = {
        build,
        header: {
            title: "Confirm action",
        },
        sections: [
            {
                widgets: [
                    {
                        icon: Icon.WARNING,
                        content: prompt || "You are about to perform a sensitive action. Please, confirm",
                    },
                    {
                        type: WidgetType.BUTTON_SET,
                        content: [
                            {
                                type: WidgetType.TEXT_BUTTON,
                                text: "Confirm",
                                click: confirmParams,
                            },
                            {
                                type: WidgetType.TEXT_BUTTON,
                                text: "Cancel",
                                click: cancelParams,
                            },
                        ],
                    },
                ],
            },
        ],
    };
    return card(confirmer);
}
function paginate() { }
const validateKeyValueConfig = (widgetConfig, validType) => {
    const { name, state, type } = widgetConfig;
    if (type || name || state === WidgetState.EDITABLE) {
        return widgetConfig;
    }
    widgetConfig.type = validType;
    return widgetConfig;
};
const validateTextInputConfig = (widgetConfig, validType) => {
    const { type, name } = widgetConfig;
    if (type || !name) {
        return widgetConfig;
    }
    widgetConfig.type = validType;
    return widgetConfig;
};
const validateEditableConfig = (config, sectionIdx = 0, widgetIdx = 0) => {
    const { state } = config;
    if (state !== WidgetState.EDITABLE) {
        return config;
    }
    return {
        ...config,
        click: {
            callback: "edit",
            params: propertiesToString({
                card: config,
                section: sectionIdx,
                index: widgetIdx,
            }),
        },
    };
};
const validateConfig = (widgetConfig, sectionIndex, widgetIndex) => {
    const kvValid = validateKeyValueConfig(widgetConfig, WidgetType.KEY_VALUE);
    const tiValid = validateTextInputConfig(kvValid, WidgetType.TEXT_INPUT);
    return validateEditableConfig(tiValid, sectionIndex, widgetIndex);
};
const makeFetchMoreWidget = (config, sectionIndex = 0, widgetIndex = 0) => {
    const { more } = config;
    if (!more) {
        return;
    }
    const moreParams = copyObject(more, {
        card: copyObject(config, {}),
        section: sectionIndex,
        widget: widgetIndex,
    });
    const { entity } = more;
    return keyValueWidget({
        title: `Load more ${entity || "info"}`,
        click: {
            callback: "fetch",
            params: moreParams,
        },
    });
};
const makeMultiplyWidget = (cardConfig, widgetConfig, sectionIdx = 0, widgetIdx = 0) => {
    const { multiply } = widgetConfig;
    if (!multiply) {
        return;
    }
    return keyValueWidget({
        title: "add more",
        click: {
            callback: "MULTIPLY",
            params: {
                card: copyObject(cardConfig, {}),
                section: sectionIdx,
                widget: widgetIdx,
            },
        },
    });
};
const defineIfNot = (obj, prop, value) => {
    if (!(prop in obj)) {
        obj[prop] = value;
    }
    return obj;
};
const getBackButtonConfig = (cardConfig, sectionConfig, index, start, max) => {
    const { separators } = sectionConfig;
    const prevSeparators = separators[separators.length - 1];
    const decrement = start - max + prevSeparators;
    const backCopy = copyObject(cardConfig, {});
    const section = backCopy.sections[index];
    section.start = decrement > 0 ? decrement : 0;
    defineIfNot(section, "separators", []);
    section.separators.pop();
    return {
        text: "back",
        click: {
            callback: "paginate",
            params: {
                card: JSON.stringify(backCopy),
            },
        },
    };
};
const getNextButtonConfig = (cardConfig, index, start, max, numSeparators) => {
    const increment = start + max - numSeparators;
    const nextCopy = copyObject(cardConfig, {});
    const section = nextCopy.sections[index];
    section.start = increment;
    defineIfNot(section, "separators", []);
    section.separators.push(numSeparators);
    return {
        text: "next",
        click: {
            callback: "paginate",
            params: { card: JSON.stringify(nextCopy) },
        },
    };
};
function cardHeader(config) {
    const header = CardService.newCardHeader();
    const { alt, crop, image, subtitle, title } = config;
    if (!title) {
        throw new Error("Title is required for Card headers");
    }
    header.setTitle(title);
    subtitle && header.setSubtitle(subtitle);
    if (image) {
        header.setImageUrl(image);
        crop && header.setImageStyle(CardService.ImageStyle.CIRCLE);
        header.setImageAltText(alt || title.toLowerCase());
    }
    return header;
}
function navigation(sequence = []) {
    const navigation = CardService.newNavigation();
    const actionMap = {
        named: (value) => navigation.popToNamedCard(value),
        pop: () => navigation.popCard(),
        push: (card) => navigation.pushCard(card),
        root: () => navigation.popToRoot(),
        update: (card) => navigation.updateCard(card),
    };
    sequence.forEach((action) => {
        switch (action) {
            case "root":
                actionMap.root();
                break;
            case "pop":
                actionMap.pop();
                break;
            default:
                if (is.str(action)) {
                    return;
                }
                const { apply } = action;
                Object.entries(action).forEach(errorDecorator((err) => console.warn(`something went wrong during nav: ${err}`), ([type, value]) => {
                    const built = convertToCard_(value, apply);
                    const card = is.arr(built) ? built[0] : built;
                    actionMap[type](card || value);
                }));
        }
    });
    return navigation;
}
function convertToCard_(input, args = []) {
    let output;
    switch (typeof input) {
        case "function":
            output = input.apply(null, args);
            break;
        case "object":
            if (!("printJson" in input) && input.sections) {
                output = card(input);
            }
            break;
    }
    return output || input;
}
const notification = (text = "") => {
    const msg = CardService.newNotification();
    msg.setText(text);
    return msg;
};
const verifyAction = ({ auth, change, click, link, compose }) => {
    if ([auth, change, click, compose, link].every((a) => !a)) {
        throw new Error("must have an action set");
    }
};
function cardAction(config) {
    const cardAction = CardService.newCardAction();
    const { text = "" } = config;
    verifyAction(config);
    cardAction.setText(text);
    actionDecorator(cardAction, config);
    return cardAction;
}
var Responder = (() => {
    return {
        notify(text) {
            const builder = CardService.newActionResponseBuilder();
            builder.setNotification(notification(text));
            return builder.build();
        },
    };
})();
const reloadStrategy = (builder, reload, event) => {
    const { type, callback, card: cardConfig, apply = [] } = reload;
    let nav;
    switch (type) {
        case Reload.ACTION:
            if (!event) {
                throw new Error("Response with card reload via action should be passed an event object");
            }
            nav = navigation([{ update: reload.card(event) }]);
            break;
        case Reload.CALLBACK:
            const result = callback.apply(null, apply);
            const update = "printJson" in result ? result : card(result);
            nav = navigation([{ update }]);
            break;
        default: nav = navigation([{ update: card(cardConfig) }]);
    }
    builder.setNavigation(nav);
    return builder;
};
function actionResponse(config) {
    const { display, event, link, navigate, notify, refresh, reload, type } = config;
    let builder;
    switch (type) {
        case Response.UNIVERSAL:
            builder = CardService.newUniversalActionResponseBuilder();
            if (!display && !link) {
                throw new Error("Universal Action response should either display cards or open a link");
            }
            builder.displayAddOnCards(display);
            break;
        case Response.COMPOSE:
            builder = CardService.newComposeActionResponseBuilder();
            break;
        default:
            builder = CardService.newActionResponseBuilder();
            if (!navigate && !notify && !reload) {
                throw new Error("Action response should result in notification or navigation");
            }
            if (reload) {
                reloadStrategy(builder, reload, event);
            }
            if (navigate) {
                builder.setNavigation(navigation(navigate));
            }
            if (notify) {
                builder.setNotification(notification(notify));
            }
            if (refresh) {
                builder.setStateChanged(true);
            }
    }
    return builder.build();
}
function openLink(config) {
    const open = CardService.newOpenLink();
    if (isStr(config)) {
        config = { url: config };
    }
    const { reload = false, tab = true, url } = config;
    if (!url) {
        throw new Error("Open link should have a Url set");
    }
    const { OpenAs: { FULL_SIZE, OVERLAY }, OnClose: { RELOAD_ADD_ON, NOTHING }, } = CardService;
    open.setUrl(url);
    open.setOpenAs(tab ? OVERLAY : FULL_SIZE);
    open.setOnClose(reload ? RELOAD_ADD_ON : NOTHING);
    return open;
}
const textWidget = (config) => {
    const widget = CardService.newTextParagraph();
    widget.setText(validateContent_(config));
    return widget;
};
function selectionInputWidget(config = {}) {
    const { content = [], name, select, title, type = WidgetType.CHECK_BOX, } = config;
    const widget = CardService.newSelectionInput();
    widget.setFieldName(name);
    widget.setType(CardService.SelectionInputType[type]);
    title && widget.setTitle(title);
    actionDecorator(widget, config);
    const selected = content.map((o) => {
        const { value } = o;
        return {
            ...o,
            selected: select !== void 0 ? select === value : o.selected,
        };
    });
    if (!selected.some((o) => o.selected) && type !== WidgetType.CHECK_BOX) {
        selected[0].selected = true;
    }
    selected.forEach(({ selected = false, text, value }) => widget.addItem(text, value, selected));
    return widget;
}
const validateContent_ = ({ content = "" }) => is.date(content) ? content.toLocaleDateString() : is.arr(content) ? content.join(",") : is.obj(content) ? JSON.stringify(content) : content;
function textInputWidget(config) {
    const widget = CardService.newTextInput();
    const { name, multiline = false } = config;
    widget.setFieldName(name);
    widget.setMultiline(multiline);
    labelDecorator(widget, config);
    widget.setValue(validateContent_(config));
    actionDecorator(widget, config);
    suggestionDecorator(widget, config);
    return widget;
}
const getButtonSetWidget = (config) => {
    const { content } = config;
    const buttons = content.map((btn) => {
        const { type } = btn;
        return type === WidgetType.IMAGE_BUTTON ? imageButtonWidget(btn) : textButtonWidget(btn);
    });
    const widget = CardService.newButtonSet();
    for (const button of buttons) {
        widget.addButton(button);
    }
    return widget;
};
const textButtonWidget = errorDecorator((err) => console.warn(`failed to create TextButton: ${err}`), (config) => {
    const { background, color, colour, disabled = false, filled = false, text, } = config;
    const widget = CardService.newTextButton();
    const locColor = colour || color;
    const validatedText = text || validateContent_(config);
    widget.setText(locColor ? Formatter.colorize(locColor, validatedText) : validatedText);
    widget.setDisabled(disabled);
    if (filled) {
        widget.setTextButtonStyle(CardService.TextButtonStyle.FILLED);
        widget.setBackgroundColor(background || locColor);
    }
    return actionDecorator(widget, config);
});
const imageButtonWidget = errorDecorator((err) => console.warn(`failed to create ImageButton: ${err}`), (config) => {
    const widget = CardService.newImageButton();
    const { alt } = config;
    if (!alt) {
        throw new Error("ImageButton should have alt text set");
    }
    widget.setAltText(alt);
    iconDecorator(widget, config);
    actionDecorator(widget, config);
    return widget;
});
const imageWidget = errorDecorator((err) => console.warn(`failed to create ImageWidget: ${err}`), (config) => {
    const widget = CardService.newImage();
    const { alt, content, src } = config;
    if (!src && !content) {
        throw new Error("Image widget should have an image set");
    }
    widget.setImageUrl(src || validateContent_(config));
    if (!alt) {
        throw new Error("Image widget should have alt text set");
    }
    widget.setAltText(alt);
    actionDecorator(widget, config);
    return widget;
});
const getSwitchWidget = (config) => {
    const { name, selected = false, value = "" } = config;
    const toggle = CardService.newSwitch();
    toggle.setFieldName(name);
    toggle.setSelected(selected);
    toggle.setValue(value);
    actionDecorator(toggle, config);
    return toggle;
};
const getGridItemWidget = (config) => {
    const { subtitle, id, valign = "below" } = config;
    const item = CardService.newGridItem();
    item.setIdentifier(id.toString());
    item.setLayout(CardService.GridItemLayout[`TEXT_${valign.toUpperCase()}`]);
    if (subtitle)
        item.setSubtitle(subtitle.toString());
    return labelDecorator(item, config);
};
const getGridWidget = (config) => {
    const { columns = 1, content } = config;
    const grid = CardService.newGrid();
    grid.setNumColumns(columns);
    content.forEach((c) => grid.addItem(getGridItemWidget(c)));
    labelDecorator(grid, config);
    return actionDecorator(grid, config);
};
const getDecoratedTextWidget = (config) => {
    const { lines = [], switchConfig, buttonConfig, label, multiline = true, } = config;
    if (buttonConfig && switchConfig) {
        throw new Error("KeyValue widgets cannot have both Button and Switch set");
    }
    const widget = CardService.newDecoratedText();
    widget.setWrapText(multiline);
    const validContent = validateContent_(config);
    const text = (validContent ? [validContent, ...lines] : lines).join("\n");
    widget.setText(text);
    if (label) {
        buttonDecorator(widget, {
            text: label,
            disabled: true,
            click: {
                callback: label,
            },
        });
    }
    buttonDecorator(widget, buttonConfig);
    switchConfig && widget.setSwitchControl(getSwitchWidget(switchConfig));
    actionDecorator(widget, config);
    iconDecorator(widget, config);
    labelDecorator(widget, config);
    return widget;
};
const keyValueWidget = errorDecorator((err) => console.warn(`failed to create KeyValue: ${err}`), (config) => getDecoratedTextWidget(config));
const hasAction = ({ suggest, click, change, auth, link }) => ({
    action: !!(suggest || click || change || auth || link),
});
function passesTests() {
    var suite = new TestSuite_("Library");
    var test1 = new Test_("Call with no parameters").whenTesting(fetchAuthorized).shouldFail(URIError);
    var test2 = new Test_("Call with empty params").whenTesting(fetchAuthorized).withParams({}).shouldFail(URIError);
    var test3 = new Test_("Query from JSON").whenTesting(JSONtoQuery).withParams({
        nullable: null,
        undefinable: undefined,
        emptyObject: {},
        emptyArray: [],
        simpleObject: { a: 1, b: 2 },
        simpleArray: [1, 2],
        string: "sample"
    }).shouldInclude("sample", /simpleObject\[\w\]/, /simpleArray\[\d\]/, "string");
    var test4 = new Test_("WWW-Authenticate | Proxy-Authenticate parsing").whenTesting(parseAuthenticateHeader).withParams("WWW-Authenticate Basic realm=\"Shire\"").shouldEqual({
        schema: "Basic",
        realm: "Shire"
    });
    var test5 = new Test_("Partial WWW-Authenticate").whenTesting(parseAuthenticateHeader).withParams("WWW-Authenticate Bearer").shouldEqual({
        schema: "Bearer",
        realm: null
    });
    var test6 = new Test_("unit start-end/full Content-Range").whenTesting(parseContentRangeHeader).withParams("bytes 200-1000/67589").shouldEqual({
        units: "bytes",
        start: 200,
        end: 1000,
        full: 67589
    });
    var test7 = new Test_("unit */full Content-Range").whenTesting(parseContentRangeHeader).withParams("bytes */10000").shouldEqual({
        units: "bytes",
        start: null,
        end: null,
        full: 10000
    });
    suite.addTest(test1, test2, test3, test4, test5, test6, test7);
    suite.testAll();
}
function serviceAccount(auth) {
    try {
        var serviceSA = OA2.createService(Auth.SERVICE + ":" + (auth.name || ""));
        serviceSA.setTokenUrl(auth.tokenUrl || "https://oauth2.googleapis.com/token");
        serviceSA.setPrivateKey(auth.key);
        serviceSA.setIssuer(auth.issuer);
        serviceSA.setScope(auth.scopes || []);
        serviceSA.setPropertyStore(auth.store);
        serviceSA.setCache(auth.cache);
        Logger.log(auth.store);
        auth.store.setProperty("library", "works");
        var claims = {};
        for (var key in auth) {
            switch (key) {
                case "audience":
                    claims.target_audience = auth[key];
                    break;
            }
        }
        if (Object.keys(claims).length > 0) {
            serviceSA.setAdditionalClaims(claims);
        }
        return serviceSA;
    }
    catch (serviceError) {
        timestamp("error during service account", {
            error: serviceError,
            name: auth.name || "name not provided",
            type: "fetch",
        }, "error");
    }
}
function resetSA(auth) {
    var service = serviceAccount(auth);
    if (service) {
        service.reset();
    }
}
function compare() {
    var args = Array.prototype.slice.call(arguments);
    return args.every(function (arg, a) {
        if (a) {
            var previous = args[a - 1];
            if (typeof arg !== typeof previous && !(arg instanceof RegExp) && !(previous instanceof RegExp))
                return false;
            switch (typeof arg) {
                case "function": return (Function.prototype.toString.call(arg) === Function.prototype.toString.call(previous));
                case "object":
                    if (arg === null || previous === null)
                        return arg === previous;
                    if (arg instanceof RegExp && (typeof previous === "string" || typeof previous === "number"))
                        return arg.test(previous.toString());
                    var isOK = true;
                    for (var key in arg) {
                        isOK = previous.hasOwnProperty(key) && compare(arg[key], previous[key]);
                        if (!isOK)
                            return false;
                    }
                    for (var key in previous) {
                        isOK = arg.hasOwnProperty(key) && compare(arg[key], previous[key]);
                        if (!isOK)
                            return false;
                    }
                    return isOK;
                default:
                    if ((typeof arg === "string" || typeof arg === "number") && previous instanceof RegExp)
                        return previous.test(arg.toString());
                    return arg === previous;
            }
        }
        else {
            return true;
        }
    });
}
var Formatter = class {
    static anchor(link = "", text = link) {
        return link ? `<a href="${link}">${text}</a>` : text;
    }
    static mailto(email = "", text = email) {
        return email ? `<a href="mailto:${email}">${text}</a>` : text;
    }
    static boldify(text = "") {
        return text && `<b>${text}</b>`;
    }
    static colorize(color = "#000000", text = "") {
        return text && `<font color="${color}">${text}</font>`;
    }
    static format({ anchor, bold, color, email, text } = {}) {
        const maybeColored = color ? Formatter.colorize(color, text) : text;
        const maybeBold = bold ? Formatter.boldify(maybeColored) : maybeColored;
        if (anchor && email) {
            throw new RangeError("cannot set anchor and mailto simultaneously");
        }
        return Formatter.mailto(email, Formatter.anchor(anchor, maybeBold));
    }
};
function concatInPlace(params) {
    var args = Array.prototype.slice.call(arguments);
    Array.prototype.push.apply(args[0], args.slice(1).reduce(function (red, cur) {
        return (red || [red]).concat(cur);
    }));
}
function copyObject(source, target, override) {
    if (!source) {
        return source;
    }
    var transport = {};
    if (source.constructor) {
        transport = new source.constructor();
    }
    for (var key in source) {
        transport[key] = source[key];
    }
    for (var key in target) {
        if (!override && source[key]) {
            transport[key] = target[key];
        }
    }
    return transport;
}
function endsOnOne(input) {
    var result = false;
    var isNum = typeof input === "number";
    var isStr = typeof input === "string";
    if (isNum) {
        var arr = input.toString().split("");
        var li = arr.lastIndexOf("1");
        if (li === arr.length - 1) {
            result = true;
        }
    }
    else if (isStr) {
        return input.lastIndexOf("1") === input.length - 1;
    }
    return result;
}
function flatten(input, depth) {
    depth = depth || 1;
    var f = [];
    input.forEach(function (el) {
        if (el instanceof Array && depth > 1) {
            f = f.concat(flatten(el, depth - 1));
        }
        else if (el instanceof Array) {
            f = f.concat(el);
        }
        else {
            f.push(el);
        }
    });
    return f;
}
function generateCard(addHeader, numSections, numWidgets) {
    var card = {
        sections: [],
    };
    if (addHeader)
        card.header = { title: "" };
    if (!isNaN(+numSections) && numSections) {
        while (numSections) {
            card.sections.push(generateSection(false, numWidgets));
            numSections--;
        }
    }
    else {
        card.sections.push(generateSection(false, numWidgets));
    }
    return card;
}
function generateSection(addHeader, numWidgets) {
    var section = {
        widgets: [],
    };
    if (addHeader)
        section.header = "";
    if (!isNaN(numWidgets) && numWidgets) {
        while (numWidgets) {
            section.widgets.push({});
            numWidgets--;
        }
    }
    else {
        section.widgets.push({});
    }
    return section;
}
function getByProperty(input, name, value) {
    return (input || []).filter(function (element) {
        return compare(element[name], value);
    })[0];
}
function getDeepLastIndex(arr, elem) {
    var lidx = -1;
    for (var curr = 0; curr < arr.length; curr++) {
        var same = compare(arr[curr], elem);
        if (same)
            lidx = curr;
    }
    return lidx;
}
function frost(obj) {
    if (!obj || typeof obj !== "object")
        return obj;
    for (var key in obj) {
        var value = obj[key];
        if (value && typeof value === "object")
            frost(obj[key]);
    }
    return Object.freeze(obj);
}
function indexByProperty(input, name, value) {
    return (input || []).map(function (element, i) {
        if (element[name] === value) {
            return i;
        }
    }).filter(function (f) {
        return f || f === 0;
    })[0];
}
function JSONtoQuery(json, options) {
    if (!options) {
        options = {
            indexed: true,
        };
    }
    function deep(obj, seq) {
        var output = [];
        for (var key in obj) {
            if (typeof obj[key] === "object") {
                output.push(deep(obj[key], (seq ? seq + "[" : "") + key + (seq ? "]" : "")));
            }
            else if (obj[key] !== undefined) {
                output.push((seq ? seq + "[" : "") + key + (seq ? "]" : "") + "=" + obj[key]);
            }
        }
        return output.reduce(function (r, c) {
            return r.concat(c);
        }, []);
    }
    return deep(json).join("&");
}
function nest(obj, subs, depth) {
    depth = depth || 0;
    var sub = subs[depth];
    var nsub = subs[depth + 1];
    if (nsub === undefined) {
        obj[sub] = undefined;
        return;
    }
    while (depth < subs.length) {
        if (isNaN(parseInt(nsub))) {
            obj[sub] = obj[sub] || {};
        }
        else {
            obj[sub] = obj[sub] || [];
        }
        return nest(obj[sub], subs, ++depth);
    }
}
function traverseNested(obj, props, value) {
    var depth = 0;
    return (function t(o, p, d, v) {
        while (d < p.length) {
            if ((v !== undefined) & (d === p.length - 1)) {
                o[p[d]] = v;
            }
            return t(o[p[d]], p, ++d, v);
        }
        return o;
    })(obj, props, depth++, value);
}
function queryToJSON(query) {
    var parameters = {};
    if (query && typeof query === "string") {
        query.split("&").forEach(function (param) {
            var split = param.split("=");
            if (split[0] !== undefined && split[1] !== undefined) {
                parameters[split[0]] = split[1];
            }
        });
    }
    return parameters;
}
function getMessage({ messageMetadata = {} } = {}) {
    const { accessToken, messageId } = messageMetadata;
    if (!messageId) {
        return null;
    }
    GmailApp.setCurrentMessageAccessToken(accessToken);
    return GmailApp.getMessageById(messageId);
}
function handleError(error, cardConfig) {
    timestamp(error.message, error, "error");
    var defCard = {
        header: {
            title: "Issue with the Add-on",
            image: Icon.WARNING,
        },
        sections: [
            {
                widgets: [{ content: error.message }],
            },
        ],
    };
    if (!cardConfig) {
        return card(defCard);
    }
    try {
        return card(cardConfig);
    }
    catch (err) {
        return card(defCard);
    }
}
function order_(A, B, reverse) {
    toBoolean(reverse);
    var areStrings = typeof A === "string" && typeof B === "string";
    var areDates = A instanceof Date && B instanceof Date;
    var areNumbers = typeof A === "number" && typeof B === "number";
    switch (true) {
        case areStrings:
            A = A.toLowerCase();
            B = B.toLowerCase();
            if (reverse) {
                if (A > B) {
                    return -1;
                }
                else if (A < B) {
                    return 1;
                }
            }
            else {
                if (A > B) {
                    return 1;
                }
                else if (A < B) {
                    return -1;
                }
            }
            break;
        case areNumbers:
            if (reverse) {
                return B - A;
            }
            else {
                return A - B;
            }
            break;
        case areDates:
            A = A.valueOf();
            B = B.valueOf();
            if (reverse) {
                return B - A;
            }
            else {
                return A - B;
            }
            break;
        default: return 0;
    }
}
function preserve_(form, widgets, remove) {
    if (widgets.length > 0) {
        widgets.forEach(function (widget) {
            var type = widget.type;
            var content = widget.content;
            var sw = widget.switchConfig || {};
            var name = widget.name || sw.name;
            if (name) {
                if (remove) {
                    if (!form.hasOwnProperty(name)) {
                        switch (type) {
                            case WidgetType.KEY_VALUE:
                                sw.selected = false;
                                break;
                            case WidgetType.CHECK_BOX: content.forEach(function (option) {
                                option.selected = false;
                            });
                        }
                    }
                }
                for (var key in form) {
                    var field = form[key];
                    if (key === name) {
                        switch (type) {
                            case WidgetType.KEY_VALUE:
                                if (field[0]) {
                                    sw.selected = true;
                                }
                                break;
                            case WidgetType.TEXT_INPUT:
                                widget.content = field[0];
                                break;
                            default: content.forEach(function (option) {
                                if (field.indexOf(option.value) !== -1) {
                                    option.selected = true;
                                }
                                else {
                                    option.selected = false;
                                }
                            });
                        }
                    }
                }
            }
        });
    }
}
function sort(array, property, invert) {
    try {
        return array.sort(function (a, b) {
            if (property) {
                return order_(a[property], b[property], invert);
            }
            else {
                return order_(a, b, invert);
            }
        });
    }
    catch (error) {
        timestamp("array sorting error", error, "warning");
        return array;
    }
}
const is = (() => {
    const instOf = (out, cls) => out.constructor.name === cls.name;
    return {
        arr(maybeArr) {
            return Array.isArray(maybeArr);
        },
        bool(maybeBool) {
            return instOf(maybeBool, Boolean);
        },
        date(maybeDate) {
            return instOf(maybeDate, Date);
        },
        nan(maybeNaN) {
            return Number.isNaN(maybeNaN);
        },
        numerable(maybe) {
            return !Number.isNaN(maybe);
        },
        number(maybeNum) {
            return instOf(maybeNum, Number);
        },
        null(maybeNull) {
            return maybeNull === null;
        },
        obj(maybeObj) {
            return typeof maybeObj === "object" && maybeObj;
        },
        str(maybeStr) {
            return instOf(maybeStr, String);
        },
        undef(maybeDef) {
            return maybeDef === void 0;
        },
    };
})();
function propertiesToString(object) {
    for (const key in object) {
        const value = object[key];
        if (is.undef(value)) {
            object[key] = "";
            continue;
        }
        if (is.obj(value) || is.null(value)) {
            object[key] = JSON.stringify(value || {});
            continue;
        }
        if (is.bool(value) || is.numerable(value)) {
            object[key] = value.toString();
            continue;
        }
    }
    return object;
}
function timestamp(label, content, type) {
    var current = new Date();
    var date = current.toLocaleDateString();
    var time = current.toLocaleTimeString();
    var log = {
        message: label,
        on: date,
        at: time,
        happened: content,
    };
    switch (type) {
        case "log":
            console.log(log);
            break;
        case "warning":
            console.warn(log);
            break;
        case "error":
            console.error(log);
            break;
        default: console.log(log);
    }
}
function toSentenceCase(input) {
    if (!input || input === "") {
        return "";
    }
    input = input.toLowerCase();
    input = input[0].toUpperCase() + input.substring(1, input.length);
    return input;
}
function toCamelCase(input) {
    if (!input || input === "") {
        return "";
    }
    return input.split(" ").map((word) => {
        return toSentenceCase(word);
    }).join(" ");
}
function trimMessage(message) {
    const date = message.getDate();
    const subject = message.getSubject();
    const body = message.getBody();
    const from = message.getFrom();
    var to = message.getTo().split(", ");
    var cc = message.getCc().split(", ");
    var me = Session.getEffectiveUser().getEmail();
    var toTrim = from;
    if (trimFrom(to[0]) !== me && trimFrom(from) === me) {
        toTrim = to[0];
    }
    var trimmed = {
        to,
        cc,
        body,
        date,
        subject,
    };
    var domains = toTrim.match(/\w+(?=\..+(?=$))/g) || [];
    trimmed.domain = toSentenceCase(domains[domains.length - 1]);
    trimmed.email = trimFrom(toTrim).toLowerCase();
    trimmed.name = trimSender(toTrim);
    var split = trimmed.name.split(" ");
    var first = split[0];
    var lwd = first.toLowerCase();
    var start = 0;
    if (lwd === "the" || lwd === "a") {
        first += " " + split[1];
        start = 1;
    }
    trimmed.first = first;
    trimmed.last = "";
    if (split.length > 1) {
        split.forEach((part, idx) => {
            var spacer = "";
            if (idx !== start + 1) {
                spacer = " ";
            }
            if (idx > start) {
                trimmed.last += spacer + part;
            }
        });
    }
    if (!first && !trimmed.last) {
        trimmed.name = trimmed.first = toSentenceCase(trimmed.email.split("@")[0]);
    }
    trimmed.entities = extractEntities_(trimmed);
    return trimmed;
}
const emailRegex = /([-+\w.]+@[-+\w.]+\w+(?:\.\w+)+)/gi;
function extractEntities_(message) {
    const { cc, domain, email, name, to } = message;
    var entities = {
        names: [name],
        emails: [email],
        domains: [domain],
    };
    if (!message) {
        return entities;
    }
    var emails = to.concat(cc);
    emails = emails.concat(message.body.match(/\w+?@\w+\.\w+?\b/g) || []);
    var rNames = emails.map((r) => trimSender(r)).filter((r) => r !== "");
    var rEmails = emails.map((c) => trimFrom(c).toLowerCase()).filter((c) => c !== "");
    entities.names = entities.names.concat(rNames).filter((name, n, nms) => {
        return nms.lastIndexOf(name) === n;
    }).sort((a, b) => order_(a, b));
    entities.emails = entities.emails.concat(rEmails).filter((email, m, ems) => {
        return ems.lastIndexOf(email) === m;
    });
    return entities;
}
const trimFrom = (input) => {
    try {
        const [[email]] = input.matchAll(emailRegex) || [[input]];
        return email || input;
    }
    catch (error) {
        console.warn(error);
        return input;
    }
};
function trimSender(input) {
    try {
        var index = input.indexOf(" <");
        if (index === -1)
            return "";
        input = input.replace(input.slice(index), "");
        input = input.replace(/^\"|\"+(?=$)/g, "");
        input = input.replace(/^\'|\'$/g, "");
        return toCamelCase(input);
    }
    catch (e) {
        return "";
    }
}
function toBoolean(input) {
    if (!input) {
        return false;
    }
    var isBoolean = typeof input === "boolean";
    if (isBoolean) {
        return input;
    }
    var isString = typeof input === "string";
    return isString ? input === "true" : false;
}
const isFunc = (maybeFunc) => typeof maybeFunc === "function";
const isStr = (maybeStr) => typeof maybeStr === "string";
const ensureArray = (maybeArray) => Array.isArray(maybeArray) ? maybeArray : [maybeArray];
const compose_ = (...f) => f.reduce((x, y) => (...args) => y(x(...args)));
const pushIf = (arr, maybeEl) => !!maybeEl && arr.push(maybeEl);
const putToCache = (key, value) => {
    const ucache = CacheService.getUserCache();
    ucache.put(key, value.toString());
};
const getFromCache = (key) => {
    const ucache = CacheService.getUserCache();
    return ucache.get(key) || "";
};
const isSuccess = ({ res }) => res.getResponseCode() === 200;
const processImageURI = ({ uri, width = -1, height = -1 }) => {
    const commonParams = { muteHttpExceptions: true };
    const res = UrlFetchApp.fetch(uri, commonParams);
    if (!isSuccess({ res })) {
        return "";
    }
    const base64 = Utilities.base64Encode(res.getContent());
    const cacheName = "resized_image";
    const selfURI = `${ScriptApp.getService().getUrl()}?resize:width=${width}&height=${height}&cache=${cacheName}`;
    const resizedRes = UrlFetchApp.fetch(selfURI, {
        ...commonParams,
        method: "post",
        payload: base64,
    });
    if (!isSuccess({ res: resizedRes })) {
        return "";
    }
    const cached = getFromCache(cacheName);
    if (!cached) {
        return "";
    }
    return `data:image/jpeg;base64,${cached}`;
};
var Cardin = {
    action,
    edit,
    fetchAndReload,
    actionBuilder,
    errorDecorator,
    actionDecorator,
    iconDecorator,
    labelDecorator,
    suggestionDecorator,
    buttonDecorator,
    globalEnumReplyDraft,
    globalEnumStandalone,
    Auth,
    Mime,
    Token,
    Icon,
    Reload,
    Response,
    Show,
    WidgetState,
    WidgetType,
    section,
    card,
    deck,
    Fetcher,
    fetchAuthorized,
    handleResponse,
    validateMethod,
    parseAuthenticateHeader,
    parseContentRangeHeader,
    acceptsPayload,
    getProperty,
    getProperties,
    setProperty,
    getFromStore,
    setToStore,
    clearStore,
    setProperties,
    deleteProperty,
    deleteAllProperties,
    initialize,
    mute,
    save,
    load,
    reset,
    authStrategy,
    changeStrategy,
    clickStrategy,
    composeStrategy,
    suggestStrategy,
    openLinkStrategy,
    cardConfirm,
    paginate,
    validateKeyValueConfig,
    validateTextInputConfig,
    validateEditableConfig,
    validateConfig,
    makeFetchMoreWidget,
    makeMultiplyWidget,
    defineIfNot,
    getBackButtonConfig,
    getNextButtonConfig,
    cardHeader,
    navigation,
    notification,
    verifyAction,
    cardAction,
    Responder,
    reloadStrategy,
    actionResponse,
    openLink,
    textWidget,
    selectionInputWidget,
    textInputWidget,
    getButtonSetWidget,
    textButtonWidget,
    imageButtonWidget,
    imageWidget,
    getSwitchWidget,
    getGridItemWidget,
    getGridWidget,
    getDecoratedTextWidget,
    keyValueWidget,
    hasAction,
    passesTests,
    serviceAccount,
    resetSA,
    compare,
    Formatter,
    concatInPlace,
    copyObject,
    endsOnOne,
    flatten,
    generateCard,
    generateSection,
    getByProperty,
    getDeepLastIndex,
    frost,
    indexByProperty,
    JSONtoQuery,
    nest,
    traverseNested,
    queryToJSON,
    getMessage,
    handleError,
    sort,
    is,
    propertiesToString,
    timestamp,
    toSentenceCase,
    toCamelCase,
    trimMessage,
    emailRegex,
    trimFrom,
    trimSender,
    toBoolean,
    isFunc,
    isStr,
    ensureArray,
    pushIf,
    putToCache,
    getFromCache,
    isSuccess,
    processImageURI
};

</script>
	<script>
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var getKeelaIcon = function () { return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAsxSURBVHgB5Z1dbhtHEsere4aSsUCwvEGox+yHRZ7AlC0F+xbtATYSTyAJsGXlSdRTnNiGrBNIdrDPkt8CSI7pE4iSjWTfRN+ACyNAJHK6UtUkFX6T09MzbDI/QBA4IofU/KequqqrmwKmgFfLF5uAYjEIgr1CKVeBGUbCFIAIWRCw7vne1asHl4eH+fMMzChTIYgU8vPbB01hflh+vwszyFQIQqS7DyBg8dXK5dWsWct0uCzA7IA/ZLQb4xgzIzgvCFlAdvSzxH7cLuzp8nn+OcUviBnnBfE9LzPO87QLi/GCCZD7KHCdhInVGp0XRAHmx34yBfw4RPn+/vk6/co23kLus7VATDgvCI2wFkO9gEVZvtwHi3ie3O36TIf7+fM0xIDzgmAYC/mDTVsx5fnyxS7lQZn2Y/xY+V4sMUuAwxySa/DAewuGBBAsFc5yJTDkWxpSp3x5NejvCGrpUYTz98NpC/HQW4MIeMLjrN7Ytcyl5NCbQYB9K3HbZUnIQxQaeYrRRevnqvq8Qb4Z8K3hrMuK6q7aCeu6vntwvuoJeTzm06teXS1slXJVsICzFhLVXXWcK4Rr4bjhSxlmlJau+9JabuKkhXB9iksiYJFxrKRI8eazlDwf7ap6sGYlTlqI7/vWrKPFOFbymecdGojBpGsSVsECTgrCJQqwT/5wSIb9nJJJel/jiyqlHRfrnCA6oTO7S0dCGXbfC65HVIAR4wDmbZRUnBKEY0dM1qERKHru4qf3zzeRwgdYQAwQPAxOCeJ5XmzW0STd47ZsXgGEyG7LGUH0zB8VBiFmut0W1qEE9khHdVvOCOKl7CSBoyC31VE93i7lynRnW0nq9Pkjui0nBIkzkPehdwZSQAUsQYndVxCBiQvyw4PLVZ7tg+RI//f+z5+3H0BUF2AJzmOedZ0/DBMVRI+qJFidTBoHJeq5jgMWLUSfH66XwJCJCaLLIxw3knNVt9Bd3FGSl5YFkZ4cozFjwGthAvAcBZVHjichBoMSMxAnCPfAkMQFaYrxdmCv1QRAZW+U1SQDhiQqiItiMCisC5I2DeyJCcIxw0Ux4gLl9QIY4EMCHC6/p9k/PCYxYmmdiQoF9QwFequQG8yAAbFbyMsHH9ZIDM7CnRGDkrcOF6XQ/mcT0kFBOAMXQh2BY1D5pNJ1yJmbJTZBXq6830g4Ax+bugwq7Y8FeuG6I8eARHcnqLObEogvwFEKp1RQbEeo2bUQHk2Rm3JWDKLUcwSFMyM/q4LclkMc8snd0IxkRyHxe15/ImY0htCM3/6kyiHjolCdtD8WfsTuSMtYE4SDON1pVlphYqTa3ZtFAd247jQUKf4PBlgRRMcNdHNE1QHCSc+xCK0/Q98KlVE5xoogujnB4bjRIhDBy/bHthulu5iMIIc045dEc0JUELHS7a6k8CJNtw6Dsv8KGBBZEG8CM34mUKK21/74W93lgrHFPCqdVMCASIK8un+57vqoimHr+Pqnu0ftx+a8eJaktUjVJiCIkMJ6U3QcSBBb7Y+1dUijtYvjUjbthDcWRDcoQKz/lB0Qjv7z5m7H6GrO9zYwRstGUB/BEOP5EC9mk7cBuyoVqJ7YEb2xeiRlMMTcZUm3Mtx+cCDv3l9rLpkbqQSGGAmiG5YdD+ZkBXvdgZzzjji761tEWSptJIhE6XSJBAW8XDtbLLYfY1fVvSNDPIgSRMBMECHjqf9YgCyjvHZ6d737eMqXx5iAVSvVWQ0IS2hBuJXH1c4RmisvqbrqaePkFVLQr8k6BgIVbXlD+FGWD06KwW7q6z6W0ViuZmeF1GhE6ZuIm3QauCzpoCC41c9NPVu52EhOjOjuigltIZL9sCOr23WeIVSh3/pzFoMCSqJTyVHdFRPaQtbeLG7ykBImDA1fDyjpy/UTQ8eMhMWgu+PoGwt7Chvf61w6kZ4sCpFsPYsDd70ebBVKuZ5sWO/E4Hu7CWTiPdTqamGigrRIQhgarlalICEgOBi0PUZzbyveMCb5GEfW8fBNtgAWsBYNdMeJ9PJcAbZVdGRroHO9DurqqDCkesrxQiAUcUKzlrasgwktCC/7HVUa0JuGeZCXIPO8Z6JCzIpRrTYCKnRRK/TcCxK1HNSCk8KIEjZ/lsYmYhOsOlu0Dia0IM+WLyieiqObINgLc1c0d3ZL07guc3uwrued9U8hxPyBE0I0sWkdjJEgbS8nlxLs2d53cBAuCaERcPDwdNHqACJ8ps6L7G/dD9IFkvnnKxcVGoeecFfH9mnOeC6gHyyCBJ9qZ2qzESMsL+QwhN3rp7oqgmVCWwhd/KthRTqKFRVEUSbLeUcPy7/WoVwc0x3xsPUvKcjQP5vnHRdo5LaKjrYXKaUK2z/ljsAyBi6r/JZelg/zmqZIFf0AVaXzj5Lv+gwHfZyChglNDK6qRWiXReWKj3TnhnwNX+jmUuSe12LrOVNBP1e1w9PC/vy5duWCbjxE8ghCe4XvTr8ItYlA+OKiAKsxYpogMao3gVrqdsGYunN4G1dR33hZPfAQ4ddUhhZEoN1dD6YJKmT2DPW3v/xlyKgPQ3efhBbEC6zuLzU1kEfl4X1HwXJnRJM5qvDTuaEF4QYwIf5kVkJB/FHXHL2OG6n5oXt8SQhCu3ejOXVU6jX8WaCZyH4jKhKDC5mZIa+sPjn7ZwlCYiaI6LPOYhZpiLHeffjxlz9zg/nwqrLAd2CAkSC6VILW9wdxiwFi6CCOMDIHodhidNNGaLZWkeePXYUD+CAxxlwpVv2tVktWkFl0W5xnIKit7gDOhBCDz3TyIunu90aFF0swI3B+FQT6G3N65uLDiUHn8sC45yDS+hAXmh2sQP7+U6By233m6TmAh1rQilB68uMXFTAk8hSuSbHRFdhF1UEVHr/J9bjfTao8z6fuHIedexEYLJkMd1tEXmM4tVZCyR5ZxUI/MR6tfMjOp6hYGHoiTBxFEaPxsSwwXVaC3DgxcJbz8cr/NijzLZpstyE8sRDFXTFWdpSr1bGQ8sUVOM1wIRqlEKragsqb3KYUZ/ae/Pi3CkTEysYBXAGl4aKjrouFUEsPz7JLw6xCz2eYztVTbe+3+o2VTkmrXbo0/12UKNcoR8nABOFgTaXyA5o+fjFs+vgh7wUp/MhNEzZc1e25IAa4MYFmAFelEPfoLRLpJOQKdEBFT/p9MqoLpuGe5kgIsQ5R35dd1dnfi2CJ2PvY9VIyCXm6UPTDXxURXSCdUQvkprp3nvTKn2rByTiNFFqIufmNcWpRY36SI5qitdYkp88IE4A3DRO+HsWwONzckJYg/grtrg5vm+i40/2jFF4FVVCtBVAO25hmyzV1Ub6uXS+9sPSFki0cWelhH07s5ubucM9v3npjHbe9SrFkK250nnqGIBEyc/78KrnGr2LrboxRjMbpY2bnX79klMIsoqo8Pf2H1Y4VzqjpV1aCd4/+k3yz4yNOyjSi+ndcYjCJWMj28odNIeR+ow1VlCkqV1Ehd21X6HhVUWygu7paq9U6/HEqlaL4gmn6W4Yfcyc9BRRurMtCY2ldcl2NCCfX9euC7ZjRTWIui+9myd/APC3diW3YHtoOI7FvR2B3xb6XZuOmZ6ZRr1nh6m0yYjTecgLsrHxYRyF3HbeWAxrWFuN2Ud1MbJSlg32ARfoAbm2CRhNMAoK9qGV0UyY+7HVGmAkL0cKZPORWGAH3EnVljgjRwsnEcJu3npX+avNbM+0PbZFX98Lrm/r1UdIxYhTOZ+o7VIdSIPMCBCd/uvYF4aiSAJT7wAWqeukmCEquidDO1JVOuEZ1x/cbFWNKGBXqFVhNkURVisYW3wFl1R4lmk8srpBNgt8BgoLlpIy7Gd4AAAAASUVORK5CYII="; };
var getPersonIcon = function () { return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAB50lEQVR4Ae3ZA4xcURSA4b8aB2uHdbgba6ONNs429kS7sTUx6zao7Ta2a9u2EdSj4NRczbz73pw7yfn+2I9XGGOMMcYYY0yoUgyxjws8oUiep1xkDwtIUBda2EAeGaM8G2jBa9PJ8QmZoE/kmI6nGjiOVNBxGvDQLB4iFfaQWXimmWdIFT2jDY8kOY9U2RXSeGMxEqBFeKKLAhKgAt14YQMSsI14IEYeCVieGOoGEYcGUbcWcWgd6g4hDh1C3R3EoTuo+4w49Al1HxGHPqLuLuLQXdQdQRw6Yr9RG8hifK7vqQSsRwK2AS+0BZ5Ot9b3gmYx3khyGamy8yTxSDtPq1zUN+OZ2dzX31Zx08AppILO0ICnYuTIIxOUJ0cMr7VNuLnbRl1I/rW9Xvi5vT5EAq8ZY4wxMXrJspgdHOD2X+PxZ+5wgF0sIksvMbzTyQhbuEgZqaASF9nCCJ2oizPAMq4iAbvKMgaIoaKP1XxAcO8dq+mjhpJkOYuE3FmyJIjcNIZ5g0TUa4aZRoT6uYFE3A36iUSKrUiN2kqKkHVyFalhV+kkRN08QmrcQ3oISYZ7iEL3yOifALi1FtzNQxSbj7OViGIrcXYFUewyzgqIYgWciXJ2AXYBdgF2AVFkF2CMMcYYY4wxXwDcGirAWk0QHQAAAABJRU5ErkJggg=="; };
var getLockIcon = function () { return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAA2FJREFUWIXFlz1sHEUUx39vZnfvfD4ftokjAlICKChKmhBAEImIIlIQFdS4QHwUCCrSgKKkikKBhBA0FHw0IIUCiiQdRKJJgfIBFLGcAoMQQUT4jCMT3+3t1wzFnc1mc7cfhyz+0kr73r597zczb2e0QkpvHVmkQHPAPPAU8BgwM/D7wA/AFeALIDfRO+f3bd47RRVTOg4cAyaHPJsCnhlcJ4DTwBtAuyipKlG4CVwETo0oPkzzwBJwqCiwzAycBx7P+OIB1J+AAVrAw8D2VEwL+BZ4EPh9XIA3gYMZ3/vAe8D1jH8CeAn4IJXXBc4Cj44qkLcELeBkxvcqcHRIceg34ofAfmAt5X+EOwdRCuAQUEvZnwEf5cRvaBF4PeN7bhyAhzL2pyWKb+gc/d7Y0BPjAGT7Y7UCwDrwS8qujQrMA4gzdrcCAMAfqftwHICsdEWAUptcFYCqkv8boJTyAG5k7J8q5k73TGdUUHadNPAC/ek7knl2fABV1At2cN2f8u0GXh68e4bUIZUF+AY4PCLxqYLCedrDv/vIUWDzPM4CjCp+uwRMYDGJRQREBFUr1XMAe9NGFmAF2FZUPO4a9JT+bXqH+7FAb30lno9W4wNOXZXp/Zt5AIVKfEN9u3u5ua/+pCsSERncnd67naXgdPfX4Hk9Ue3DqhRtjQUR7tvfeOWee71I9SwSWmZnHXYeaLzoTOqOiezWARgDuq6s58o1HVma05rWnItrwdGEbkMtm3gLAbQWkp6R9nL0dDexGCAMLd2uYWU53hX8He/SXulmrA6AgCj4a9H/PF5Ndte14CWQrCVz7avdr22EEqcaQOUmVK5gfDPbvhE+cPNuZ6mHJfFN3XbMHuXQ34Kq5KsKYGOLntRRfc655NUEL7E0Guq6N+1cMdkDfCsASEA15MeetWudwOAqwRPBOlyzpvj1/wxgEouuqYXmjIuHEBhIphXOlF6Qass/HoCIoGf093Fg6C74hFd9nJ7F3aYviGaLe8CA01QYw5erF9eJbhkS39K+sE50y3zntLRvk2oEw47j0ZL+AMOfg08ktIFM9CddBdaGS4HBFYMuXIfbBp0FmCFP0v8KrOVZ8WRzuqUmJLGFBEosw115AG8Dr9H/pRre0wJ3NJsF2Rj56OJq8PSrtPMfHfMQdWzNGlwAAAAASUVORK5CYII="; };
var getHouseIcon = function () { return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAAdhJREFUWIXt1k+IjVEYBvDf+FtT7LCws1QTC/8yDNEUypqVEklTUkpkZSNRSmrSZMyanWwkkn8bUlJSkxo7moXNTJOJGWPxnW/ucfvuN/c795Jyn7rd93nfc57zdM73ft+hg/8dXfWJc/0fqswfxA5sqDLpyqP18/GSKhPrcAEDIX4ZjORYhT0hnsN9TBeJpBo4j0sR78Vz9AW+FXei+lp8LhJalLD4WVwO8Ve8CvFOPA1x/TnONhKrauAMrka8F9vwOvBduIXlmAm5uTLBKgZO41rE+zAa4u14E+Ljsp0oXbiqgVO4HvHdeBHx2WDibeCrsbRdBgZwI+J78axg3A/ZcbwrqI2nGjgh6/Uc/XhSMv57MPE+ynXhZIqBYxiK+D48LhmfYxpb/N4JN4Ne0waOYjjiB/CwicVzfAsmRqPccNBd0MBFjET8IB5UWDzHFDbjY5QbCfrzKHoTfsER2Xl+UuvxFExiE/YHvgzdCxkYKsi1ggncbVRM+RZ0Y3FJfQo/mxVLMXBP1mqNsBFjf9LAGqxol2aKgcnwP6HWHT3IbxlNbz9pn+McYzgcfrdTRVox0Ba0ciVbp3br6fmbBvIHcCUOFdQr7WqKgXG1B7EIMyW1Djr49/ALJmFP7ZFhsA0AAAAASUVORK5CYII="; };
var getWebIcon = function () { return "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAA4VWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMjAtMTAtMDdUMTM6MjI6MzIrMDM6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAyMC0xMC0wN1QxMzoyMzowMSswMzowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMjAtMTAtMDdUMTM6MjM6MDErMDM6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjM8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6YTQ1MDQ2ZGQtMzUzNi01MjRlLWJkN2MtNzVkMTAwM2NmYjFmPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOmE0NTA0NmRkLTM1MzYtNTI0ZS1iZDdjLTc1ZDEwMDNjZmIxZjwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD54bXAuZGlkOmE0NTA0NmRkLTM1MzYtNTI0ZS1iZDdjLTc1ZDEwMDNjZmIxZjwveG1wTU06T3JpZ2luYWxEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6YTQ1MDQ2ZGQtMzUzNi01MjRlLWJkN2MtNzVkMTAwM2NmYjFmPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDIwLTEwLTA3VDEzOjIzOjAxKzAzOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjk2PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg" +
    "ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA" +
    "gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz7NqD8BAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAqUSURBVHja7J19UBTnHcefe3+TO24POA4OOE+Fgx4SVEQ6mCpRQU0DVhKJ7TR2Os40WqttYtRReTFa0Th5mVqd6eSl6TQJjVolo4JWIY00vsuLCIiKvN8d3Asc3uveS/+oVMcxt7t3e3e73H5n+IO93z77PL/PPm+7z/4emtfrBZTCJzrlAgoABYASBYACQIkCQAGgFHoxkQy2L+sMW+bGbYMfme2aODtsFjvcj6JhlzU6O+n1NKTz2jW1VzmMaWNcltAk5CboRLzELeEqQ/X59MAAhFJOt3Xv8HirSgHlrQYAABFPDkQ8OeZ01LLi3GcObW4bOtEs4iU+kAkzu9lMwU7S1IBQyGDpOSIRKN9kM/hAAeUF5RqzE1dnAwCyAQDg9vDJZQmirOsSgXJDxPYBbg9c1We8cgwA4JUIlG+G8tqZCavmPb6mt9d4+bjbA1dFDAA7bN7fpatvYNBZ5SnQgtJw34EKKG81g84q79LVN9hh8/4p2wR5vZ6Kh8bvs5WS/GKVtIhwoxGVtGgxAGBxj6EpfTr042YajV41ZQAYrb2HIb5io1KST/hhoVKSXwwAKDZae2MhvuK3pG+CBkzXv4L4io1kG59DfMXGAdP1r0gLwOv1VHRoz/w7SZxTRtZJUpI4p6xDe+Y7r9dTQaomyOVx7GkbOrFmTtLaVLLPVDPiVy4EACx0eRwMJp1TTvgaYINNB5h0zm6iOr9Ld67BrzuVztkdjFESrgDMds0HPJb4HSLf0Spp4Uuw2773/mhjHdZzuSzhdrNd8wEhAVic+veEXNkWMjQrLAZ398zYxSs8XnfVvdGGeiznCrmyLRan/j1CAbDBpgMCdszbZGvf6TRG5azYguUGS89RLOcJ2DFv22DTAUIAcHkce4je7EyqQ3u66XnHJQLlBtht33t7+OQNtGnxWOJ3XB7HnrAD6NLWFZJoWHnNV7OUmbAqp8fQVBvKsgcEQDN++6/qhJL5ZHD+7eGTN6M40rdQzIRLeo2XT6BJU51QMn94vO3zsACwwWPVMlHmG2S5+9PjV5xFa6uA8koHTTdRzYITRLN/aYPHqkMOoHvkX0VkcHzzYE2n023dh3USJRfPXYsWAo8VvS2kALTm9k+zEl/NIrLju0cunJ9w6N7PlpdlsBn8Xf6kIRfPXXtXd/4iqubY3P5ZSAB4vO7KeKH6V2H0LQ3NX2rckkI0bT6S0qTLlrQMfn0HyU4mVK/z58UOZgAP9ZfmgQiTOqH4n2jseg3/mRtUAB6vu3JG7KKVkQaASeeUm6z9h5HsZsQuWunxuiuDBqDPeDkLRKjE/ORN7Zraq3j7CBOA6ZL8EhDBSo1dchFvH6EGoDW3fwoiXGymYGeP/tI3SHY6c8cnuAPQTXTOAZRACrSgBfFmnbgzF1cATrd1L9HH/aESg86quKP55rIvm6zEV7Ocbute3ABoze0zKdc/UWJ09g28fIYKgNmuUVBuf6JoXtLv8PIZKgDPWewaFtlhczVRINwfbTyLh8/oKAq9nwgFtjj1h7gs4Q7izAtS+vDwHSIAk7VPFuSyoHq2I2DHbCVSMwTxFTo8fIcIwOo0xCDZPBj99nSk9QM0Gr3q5sAXDwL1HSIAm2tc4uv3Du3pphmxi34aiRAEbEl/IL5DBcDpeuSTIp8FjQAAQCRC4LHEeoSOeEHAAOYk/dzneFbAifl/JiINApvBtwaaBh2HTNif/j+SILCZgvADYDH4jmePRQoENlNgIySASQhYl/2RTVymKPw1gE5jeH7ot1mxBctRQPCG4s/qNB7EG4CvsocMgNNt4fj6HSWEoIvPhrbitZ4TbdlDAgB22xAzQRQI3SMXcF1GiabsQQfgcE3w0dgRAQLe7zQcLrMg7AAsToMErS1RagJesjh8l/3WwBf3AwaAtBLADo9DWDI9K7Zg+d2R8xemAgAbPCbxPUydpg8YAJcpNCBkIh5rxtPili2dChDS41f8xOejCqbIEDAAPlvik2K2vCzdn8xPFQg+AbChwAGI+ckaJBuDpedIpEEwWh7+GckmZtrMgYAB8FjR25FsRh/dS/O3IGSFoLfcn4X4qALFqmxUoyCkjlglLSwIpDBkhJAat3RpID7DBEDIlfUiVklr7+FAIXRq674lg/NN1v4/4eEz1ADihWrE8ezwWEtO4KOK5YvJAGBw7GYuHj5DDYDN4O9qHTre4stGnVAy3+my7ANTXHbYvD8zYZXPm6116HgL2q9yUM+E46MybiHZ9Bq/z5nqAPqMV3Lw8BVmAFJhxq/RdExEWUcUpJlvdZp02Ut4+AozAAAAeGhoOoVkc1/fSPR2/LnvC272//0BUoAmNF9DovGR3wBSoLxWJBu1rDh39NHdv5Dt7p6b/AtlkjinrHmwpuN5K5vRfgWJxkd+A6DTGJVIayIBACB2Wtp6fzvkH4rnECply8vS2Qz+Tthtf3fymNVpPCgTqtch1v7RxrN0GqMyaAAAAGC6JB9VQIt2Ta1fISnl0fOuE6FGdGhPvwzA/z5M5LMhVMsilTEvYs47ZgAMOqtiZKLrYyS7OUlrU7t05y5iTV/Ijf8DlqglwVJWYukLesuDo+3Dp15BYz8y0fUx1rvfLwAAABAXpVrfOnQMsa1TSQsLHkfHxTghW1FHhFoQI5jxm8chj4Hvcf+x1rgo1Xp/ruH3G7HUuKWo3mylQAtK+03XarCkzaRzyp1u677mwZpOQAKh9QWuAHis6O3D421/Q2ObLJ6/BmtNYDP4u7LlZRkTDt373SMXzhPV+Zrx25+jeWKMOwAAAEgQzX6jffjUNbQ1oUd/qRbrNaI40rdS45YUgiffChBG7cOnrslEmesCSSPgl/Kq+OXn0NoqYxa+0q6pvfL0EI/MwlL2oAFg0jnlNngM9YIntaw4l8Xg7vI3vAuBHkscwCOQKy5RE3ms6O0Wp/4QlnNkQvW6lsGv24KxZDDYsjj1hwJp93EHAAAAAnbMVrNd8yGWc16Qv5bJZ0Nbu3T1DQ7XxB/J4Pxx29BHeH6vhmvkXCFX9nsbbMJ8R6ukRYs5zKgdHdrTl8ZtQx8S1fk22HQQ7w2BcI8dzWOJt7k8Dr862Yz4l/NFvMTNAADvvdGGOjQrD0KhWwNfdrs8jnd5LPE2vNMOSvR0Jp1T7vV63J26uoKM+" +
    "JUv+pPGrNiCyaCAG5oHazq5TOEIny0ZSYFC+814h/bMd9nysoZg7ahBQ9pPONB9xPqNV/+RDOW+RsaRzoDpek2SOOf1QNJA2kcs6DtoJEO5a9CE+yKaTNb+w4E6Pyx9wPMk5idv8no9lVjCAodLPYamWq/XUynmJ28KxfVCto0VjUavUkryS+ywubpLV99INMd36eob7bC5WinJLwnVDkpB64R9icsS7lBJi4DbA1cNjN340eS2heFSr/HyiaToeXdU0qKKcFw/bDvpMeisCgWUVwoAoBksPUdD/RLGaHl4BABAU0B5pQw6qyJcfiDEXpISgXKDRKAETpdl37C5Lc1s00yfnfgz3GPU9RmvHJ/czBMSTCdE00eo3VTZTMHOpzfzfHY7WzRBkG4NfNnNZgpMT7azlY2IePLNAACQAi0ARBPiPIDSFO0DKFEAKACUKAAUAAoAJQpAJOu/AwAlVi4urt5buwAAAABJRU5ErkJggg=="; };
var getConfig = function () { return ({
    Colors: {
        Primary: "#7745D6",
        Secondary: "#F5E2FF",
        Disabled: "#AFAFAF"
    },
    Links: {
        Base: "keela.co",
        addInCRM: "https://www.keela.co",
        API: "keela.co/api/v1",
        Help: "https://keelahelpcenter.zendesk.com/hc/en-us",
        Settings: "https://www.keela.co",
        Support: "https://keela.zendesk.com/hc/en-us/requests/new",
        SupportBeforeJan: "https://keela.zendesk.com/hc/en-us",
        SupportAfterJan: "https://keelahelpcenter.zendesk.com/hc/en-us"
    },
    Properties: {
        State: "application_state"
    },
    Strings: {
        Cards: {
            Error: {
                Title: "Add-on Issue",
                Reason: {
                    Long: "Something went wrong"
                }
            },
            Forbidden: {
                Title: "No access",
                Reason: {
                    Long: "We couldn't query your account due to invalid or expired token",
                    Short: "Invalid token"
                }
            },
            Help: {
                Title: "Help & Support",
                Action: "Submit",
                Prompt: "Submit a request (please provide detailed description of the issue)",
                Before2020: "For signed up before Jan 22, 2020",
                After2020: "For signed up after Jan 22, 2020"
            },
            Home: {
                Title: "Keela Home",
                Prompt: "Open an email to start browsing your contacts"
            },
            Missing: {
                Action: "Add in Keela",
                Prompt: "No contact matched the open email"
            },
            Region: {
                Title: "Region",
                Prompt: "Please, choose your organization region (it should match the one you chose for the account)"
            },
            Unavailable: {
                Title: "Keela Unavailable",
                Prompt: "We are sorry, but Keela seems to be unavailable.\nTry again later or contact support"
            },
            Display: {
                Header: {
                    Missing: "Unnamed",
                    Alt: "Picture"
                }
            }
        },
        FTE: {
            Action: "Get Started",
            Auth: {
                Action: "Choose Region",
                Button: "Take me there",
                Checkups: {
                    NeverShare: "Never share it with others",
                    StoreSecure: "Store it in a secure location"
                },
                Title: "Authorize Keela",
                Token: "Access to your account is granted via token. You can get one in account settings"
            },
            Finish: {
                Action: "Start Browsing"
            },
            Welcome: "Keela for Gmail allows you to view and edit contacts while browsing your email",
            Tasks: {
                Highlights: "View contact highlights & insights",
                Transactions: "View latest transactions & total donations"
            },
            Title: "Welcome to Keela"
        },
        Settings: {
            Title: "Settings",
            Token: {
                Action: "Get Token",
                Required: "The token is required to continue",
                Example: "e.g. 744707f029a249.efs24Sof9Ag4",
                Label: "Token",
                Prompt: "Token can be obtained from your account settings",
                Warning: "Token gives access to sensitive data, please, treat it as password:"
            }
        },
        Notifications: {
            Save: {
                RegionSuccess: "Region Saved!",
                Success: "Successfully Saved!",
                Unauthorized: "Invalid token/region pair!",
                InvalidToken: "Invalid token!"
            }
        }
    }
}); };
/* global onMessageOpen, getState */
/**
 * @summary builds home card
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildHome(e) {
    return onMessageOpen(e);
}
/**
 * @typedef {object} HomepageEventObject
 * @property {CommonEventObject} commonEventObject
 *
 * @param {HomepageEventObject} e add-on action event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildHomepage(e) {
    var settings = getState().settings;
    if (settings.firstTime) {
        return welcomeCard();
    }
    return homepageCard();
}
/**
 * @summary builds settings card
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildSettings(e) {
    var settings = getSettings();
    return settingsCard(settings);
}
/**
 * @summary builds authorization FTE card
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildAuthFTE(e) {
    var settings = getSettings();
    var page = getParameters(e).page;
    return authFTEcard(settings, page);
}
/**
 * @summary builds help card
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildHelp(e) {
    return helpCard();
}
/**
 * @summary builds welcome card
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildWelcome() {
    return welcomeCard();
}
/**
 * @summary pre-setup completion check (to avoid reseting to welcome)
 * @param {gmailEventObject} e Gmail add-on-specific event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function onSetupCompletion(e) {
    var settings = getSettings();
    if (settings.firstTime) {
        settings.save();
    }
    return onMessageOpen(e);
}
/**
 * @enum
 * @type {{
 *  BUTTON : string,
 *  IMAGE  : string
 * }}
 */
var WidgetTypes = (function (e) {
    e[e.IMAGE = "Image"] = 0;
    e[e.BUTTON = "TextButton"] = 1;
    return e;
})({});
/**
 * @fileoverview contains build steps for first-time user experience
 */
/**
 * @summary Build FTE card;
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function buildFTE(e) {
    var params = getParameters(e);
    var page = +(params.page || 0);
    var pageMap = new Map([
        [0, buildWelcome],
        [1, buildAuthFTE]
    ]);
    return Cardin.actionResponse({
        event: e,
        reload: {
            type: Cardin.Response.ACTION,
            card: pageMap.get(page) || buildWelcome
        }
    });
}
/**
 * @typedef {object} InputsWrapper
 * @property {stringInputs} [stringInputs]
 * @property {dateInput} [dateInput]
 * @property {dateTimeInput} [dateTimeInput]
 * @property {timeInput} [timeInput]
 *
 * @typedef {object} stringInputs
 * @property {string[]} value
 *
 * @typedef {object} dateInput
 * @property {string} msSinceEpoch
 *
 * @typedef {object} timeInput
 * @property {number} hours
 * @property {number} minutes
 *
 * @typedef {object} dateTimeInput
 * @property {boolean} hasDate
 * @property {boolean} hasTime
 * @property {string} msSinceEpoch
 */
/**
 * @typedef {object} commonEventObject
 * @property {("GMAIL" | "CALENDAR" | "DRIVE")} hostApp
 * @property {("WEB"|"IOS"|"ANDROID")} platform
 * @property {Object.<string, InputsWrapper>} formInputs
 * @property {object} parameters
 * @property {string} [timeZone]
 * @property {string} [timeZone.id]
 * @property {string} [timeZone.offset]
 * @property {string} [userLocale]
 */
/**
 * @summary Calendar event object
 * @typedef {object} calendarEventObject
 */
/**
 * @summary Drive event object
 * @typedef {object} driveEventObject
 */
/**
 * @summary Gmail event object
 * @typedef {object} gmailEventObject
 * @property {string} accessToken
 * @property {string[]} [bccRecipients] iff addOns.gmail.composeTrigger.draftAccess = "METADATA"
 * @property {string[]} [ccRecipients] iff addOns.gmail.composeTrigger.draftAccess = "METADATA"
 * @property {string} messageId
 * @property {string} threadId
 * @property {string[]} [toRecipients] iff addOns.gmail.composeTrigger.draftAccess = "METADATA"
 */
/**
 * @typedef {object} EventObject
 * @property {commonEventObject} commonEventObject
 * @property {calendarEventObject} calendar
 * @property {driveEventObject} drive
 * @property {gmailEventObject} gmail
 */
/**
 * @typedef {object} ParsedMessage
 * @property {string} body
 * @property {string[]} cc
 * @property {string} domain
 * @property {string} email
 * @property {string} first
 * @property {string} last
 * @property {string} name
 * @property {string} subject
 * @property {string[]} to
 */
/**
 * @typedef {Object} SectionConfig
 * @property {String} [header] section header line
 * @property {Boolean} isCollapsible render collapsed or expanded
 * @property {Number} [numUncollapsible=0] number of widgets uncollapsed
 * @property {WidgetConfig[]} widgets collection of widget configurations
 */
/**
 * @typedef {Object} CardHeaderConfig
 * @property {String} title header title line
 * @property {String} [subtitle] header subtitle line
 * @property {String} [image] image URL to set on the left of the header
 * @property {Boolean} [crop=false] square or circle image style
 * @property {String} [alt] alternative text on image load failure
 * @throws {Error} if no title provided
 */
/**
 * @typedef {Object} CardConfig
 * @property {CardHeaderConfig} header header of the card
 * @property {String} [name] name uniquely identifying card
 * @property {SectionConfig[]} sections section configurations
 * @property {ActionConfig[]} [actions] actions to add to menu
 */
/**
 * @typedef {Object} ProcessedResponse
 * @property {Number} code
 * @property {Object} headers
 * @property {String} content
 */
/**
 * @typedef {UserSettings} KeelaSettings
 */
/**
 * @summary runs on each message open
 * @param {gmailEventObject} e Gmail add-on event object
 */
function onMessageOpen(e) {
    var instance = getState();
    var settings = instance.settings;
    if (settings.firstTime) {
        return welcomeCard();
    }
    settings.reload();
    var message = Cardin.getMessage(e);
    if (!message) {
        return homepageCard();
    }
    /** @type {ParsedMessage} */
    var parsedMessage = Cardin.trimMessage(message);
    return homeCard(instance, parsedMessage);
}
/* global Cardin, Objects */
/**
 * @typedef {object} ConnectorConfig
 * @property {string} base
 * @property {string} endpoints
 */
var Connector = /** @class */ (function () {
    /**
     * @param {ConnectorConfig} config
     * @param {UserSettings} settings
     */
    function Connector(config, settings) {
        var _this = this;
        Object.entries(config).forEach(function (_a) {
            var _b = __read(_a, 2), k = _b[0], v = _b[1];
            return _this[k] = v;
        });
        this.settings = settings;
    }
    Object.defineProperty(Connector.prototype, "token", {
        get: function () {
            var token = this.settings.token;
            return token;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * @summary builds error Card
     * @returns {CardConfig}
     */
    Connector.prototype.buildError = function () {
        return {
            header: {
                image: Cardin.Icon.WARNING,
                title: "Add-on failure"
            },
            sections: [{
                    widgets: [getSupportWidgetConfg({
                            text: "Something went wrong. Please contact support"
                        })]
                }]
        };
    };
    /**
     * @summary constructs full URL
     * @param {string[]} subdomains
     * @param {string} domain
     * @param {string[]} [paths]
     * @param {object} [query]
     * @returns {string}
     */
    Connector.prototype.buildFullURL = function (subdomains, domain, paths, query) {
        subdomains.push(domain);
        var base = subdomains.join(".");
        var path = (paths || []).length ? "/".concat(paths.join("/")) : "";
        var builtQuery = query ? "?".concat(JSONtoQuery(query)) : "";
        var protocol = (/^https:\/\//).test(base) ? "" : "https://";
        return "".concat(protocol).concat(base).concat(path).concat(builtQuery);
    };
    /**
     * @returns {boolean}
     */
    Connector.prototype.isBearer = function () {
        var authType = this.settings.authType;
        return authType === "BEARER";
    };
    /**
     * @returns {boolean}
     */
    Connector.prototype.isBasic = function () {
        var authType = this.settings.authType;
        return authType === "BASIC";
    };
    return Connector;
}());
/**
 * @typedef {{ title: string, subtitle ?: string, image ?: string, crop ?: boolean, alt ?: string }} HeaderConfig
 */
/**
 * @typedef {{ type : string }} BaseWidgetConfig
 * @typedef {BaseWidgetConfig & {
 *  title   ?: string,
 *  text    ?: string,
 *  state   ?: string,
 *  src     ?: string,
 *  content ?: string,
 *  action  ?: "change"|"click"|"link"
 * }} PossibleWidgetConfig
 */
/**
 * @summary checks widget validity
 * @param {PossibleWidgetConfig}
 * @returns {boolean}
 */
var widgetValidityChecker = function (_a) {
    var type = _a.type, src = _a.src, content = _a.content;
    if (type === WidgetTypes.IMAGE) {
        return !!(src || content);
    }
    return true;
};
/**
 * @summary validates config type
 * @param {PossibleWidgetConfig} config
 * @returns {PossibleWidgetConfig}
 */
var configTypeValidator = function (config) {
    var type = config.type;
    if (!type) {
        return config;
    }
    var maybeLib = type.split(".");
    if (maybeLib.length === 1) {
        return config;
    }
    var _a = __read(maybeLib, 3), enumerator = _a[1], val = _a[2];
    config.type = Cardin[enumerator][val];
    return config;
};
/**
 * @summary main config validator
 * @param {PossibleWidgetConfig} config
 * @returns {PossibleWidgetConfig}
 */
var configValidator = function (config, cf) {
    if (cf === void 0) { cf = getConfig(); }
    var valid = configTypeValidator(config);
    var action = valid.action, color = valid.color, colour = valid.colour, content = valid.content, text = valid.text, title = valid.title, type = valid.type;
    if (!type && !content) {
        valid.state = Cardin.WidgetState.HIDDEN;
    }
    if (type === WidgetTypes.BUTTON) {
        valid.type = Cardin.WidgetType.TEXT_BUTTON;
        valid.text = text || title || content;
        valid.color = color || colour || cf.Colors.Primary;
    }
    if (type === WidgetTypes.IMAGE) {
        valid.type = Cardin.WidgetType.IMAGE;
    }
    if (action === "link") {
        valid.link = { url: content, tab: true };
    }
    return valid;
};
/**
 * @summary card header validator
 * @param {HeaderConfig} header
 * @returns {HeaderConfig}
 */
var headerValidator = function (header, cf) {
    if (cf === void 0) { cf = getConfig(); }
    return assignToEmpty(header, {
        title: cf.Strings.Cards.Display.Header.Missing,
        alt: header.image ? header.alt || cf.Strings.Cards.Display.Header.Alt : "",
        crop: true
    });
};
var Keela = /** @class */ (function (_super) {
    __extends(Keela, _super);
    /**
     * @param {ConnectorConfig} config
     * @param {UserSettings} settings
     */
    function Keela(config, settings) {
        return _super.call(this, config, settings) || this;
    }
    Object.defineProperty(Keela.prototype, "apiURI", {
        /**
         * @summary returns Keela API URI (region-aware)
         * @returns {string}
         */
        get: function () {
            var _a = this, base = _a.base, region = _a.settings.region;
            return "https://".concat(isDev() ? "dev" : region, ".").concat(base);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Keela.prototype, "queryContactConfig", {
        /**
         * @summary returns API request configuration
         * @returns {object}
         */
        get: function () {
            var apiURI = this.apiURI;
            var config = FetchApp.getConfig({
                domain: apiURI,
                paths: ["contacts"],
                mute: true
            });
            return config;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * @summary gets regional-based Keela URI
     * @param {object} [cf] add-on configuration
     * @returns {string}
     */
    Keela.prototype.getKeelaURI = function (cf) {
        if (cf === void 0) { cf = getConfig(); }
        var region = this.settings.region;
        return region ? "https://".concat(isDev() ? "dev" : region, ".").concat(cf.Links.Base) : cf.Links.Settings;
    };
    /**
     * @summary builds add-on view cards
     * @param {string} content view JSON content
     * @returns {CardConfig[]}
     */
    Keela.prototype.buildDisplay = function (content) {
        var cardConfigs = JSON.parse(content);
        var cf = getConfig();
        return cardConfigs.map(function (_a) {
            var header = _a.header, sections = _a.sections;
            var validHeader = headerValidator(header, cf);
            sections.forEach(function (section) {
                var _a = section.widgets, widgets = _a === void 0 ? [] : _a;
                var correctedWidgets = widgets
                    .filter(function (c) { return widgetValidityChecker(c); })
                    .map(function (c) { return configValidator(c, cf); });
                section.widgets = correctedWidgets;
            });
            return { header: validHeader, sections: sections };
        });
    };
    /**
     * @summary builds an "unavailable" Card
     * @returns {CardConfig}
     */
    Keela.prototype.buildUnavailable = function () {
        var cf = getConfig();
        return {
            header: {
                image: Cardin.Icon.WARNING,
                title: cf.Strings.Cards.Unavailable.Title
            },
            sections: [{
                    widgets: [getSupportWidgetConfg({
                            text: cf.Strings.Cards.Unavailable.Prompt
                        })]
                }]
        };
    };
    /**
     * @summary builds a "no access" Card
     * @returns {CardConfig}
     */
    Keela.prototype.buildNoAccess = function () {
        var token = this.token;
        var cf = getConfig();
        return {
            header: {
                image: getLockIcon(),
                title: cf.Strings.Cards.Forbidden.Title
            },
            sections: [{
                    header: cf.Strings.Cards.Forbidden.Reason.Short,
                    widgets: [{
                            content: cf.Strings.Cards.Forbidden.Reason.Long
                        },
                        {
                            content: cf.Strings.Settings.Token.Prompt,
                            buttonConfig: {
                                type: Cardin.WidgetType.TEXT_BUTTON,
                                icon: Cardin.Icon.TAB,
                                text: Cardin.Formatter.colorize(cf.Colors.Primary, cf.Strings.Settings.Token.Action),
                                link: {
                                    url: this.getKeelaURI(cf),
                                    tab: true
                                }
                            }
                        },
                        {
                            change: {
                                callback: saveWithPing.name,
                                params: {
                                    builderName: onMessageOpen.name,
                                    message: cf.Strings.Notifications.Save.InvalidToken
                                },
                                spinner: true
                            },
                            name: "token",
                            content: token,
                            title: cf.Strings.Settings.Token.Label,
                            hint: cf.Strings.Settings.Token.Example
                        }]
                }]
        };
    };
    /**
     * @summary builds contact not found card
     * @param {ParsedMessage} message Gmail message
     * @returns {CardConfig}
     */
    Keela.prototype.buildNotFound = function (message) {
        var email = message.email, name = message.name, domain = message.domain;
        var cf = getConfig();
        return {
            header: {
                image: getPersonIcon(),
                title: name,
                subtitle: email
            },
            sections: [{
                    widgets: [{
                            content: cf.Strings.Cards.Missing.Prompt
                        },
                        { icon: "PERSON", content: name },
                        { icon: "EMAIL", content: email },
                        {
                            icon: Cardin.Icon.COMPANY,
                            content: domain
                        },
                        {
                            colour: cf.Colors.Primary,
                            type: Cardin.WidgetType.TEXT_BUTTON,
                            text: cf.Strings.Cards.Missing.Action,
                            link: {
                                url: "".concat(this.getKeelaURI(cf), "/contacts"),
                                tab: true,
                                reload: true
                            }
                        }]
                }]
        };
    };
    /**
     * @summary runs instance against API
     * @param {ParsedMessage} message Gmail message
     * @returns {CardConfig|CardConfig[]}
     */
    Keela.prototype.run = function (message) {
        var _this = this;
        var email = message.email;
        var _a = this, queryContactConfig = _a.queryContactConfig, token = _a.token;
        if (!token)
            return this.buildNoAccess();
        queryContactConfig.addParam("email", email);
        queryContactConfig.addHeader("apiToken", token);
        var params = queryContactConfig.json({
            "mute": "muteHttpExceptions"
        }, {
            include: ["url", "headers", "mute"]
        });
        var _b = __read(batchFetch([params]), 1), mainResponse = _b[0];
        if (isDev()) {
            console.log(mainResponse);
            console.log(params);
        }
        var reponseHandlerMap = new Map()
            .set(200, function (content) { return _this.buildDisplay(content); })
            .set(400, function () { return _this.buildError(); })
            .set(401, function () { return _this.buildNoAccess(); })
            .set(404, function () { return _this.buildNotFound(message); })
            .set(500, function () { return _this.buildUnavailable(); });
        var code = mainResponse.code, content = mainResponse.content;
        var defaultHandler = reponseHandlerMap.get(500);
        return (reponseHandlerMap.get(code) || defaultHandler)(content);
    };
    /**
     * @summary pings Keela endpoint for access
     * @param {UserSettings} settings user settings
     * @returns {boolean}
     */
    Keela.ping = function (settings) {
        var region = settings.region, token = settings.token;
        var API = getConfig().Links.API;
        var _a = __read(batchFetch([
            {
                url: "https://".concat(isDev() ? "dev" : region, ".").concat(API, "/contacts?email="),
                headers: {
                    "apiToken": token
                }
            }
        ], true), 1), response = _a[0];
        if (isDev()) {
            console.log(response);
        }
        var code = response.code;
        return code;
    };
    /**
     * @summary checks if a token / region combination is valid
     * @param {UserSettings} settings user settings
     * @returns {boolean}
     */
    Keela.isAuthorized = function (settings) {
        var token = settings.token;
        if (isFalsyOrEmptyStr(token)) {
            return false;
        }
        return Keela.ping(settings) !== 401;
    };
    return Keela;
}(Connector));
/**
 * @fileoverview Array utilities
 * @author Oleg Valter
 * @module
 */
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        define([], factory);
    }
    else if (typeof module === 'object' && module.exports) {
        module.exports = factory();
    }
    else {
        root.Arrays = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    /**
     * Combines filter() and map() in O(n)
     * @param {any[]} [array]
     * @returns {function(function):function(function):any[]}
     */
    var filterMap = function (array) {
        if (array === void 0) { array = []; }
        return function (filter) {
            if (filter === void 0) { filter = function (e) { return true; }; }
            return function (mapper) {
                var e_1, _a;
                if (mapper === void 0) { mapper = function (e) { return e; }; }
                var mappedArr = [];
                var initialIndex = 0, filteredIndex = 0;
                try {
                    for (var array_1 = __values(array), array_1_1 = array_1.next(); !array_1_1.done; array_1_1 = array_1.next()) {
                        var elem = array_1_1.value;
                        filter(elem, initialIndex++) &&
                            mappedArr.push(mapper(elem, filteredIndex++));
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (array_1_1 && !array_1_1.done && (_a = array_1.return)) _a.call(array_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                return mappedArr;
            };
        };
    };
    /**
     * Combines filter() and map() in reverse in O(n)
     * @param {any[]} [array]
     * @returns {function(function):function(function):any[]}
     */
    var filterMapped = function (array) {
        if (array === void 0) { array = []; }
        return function (mapper) {
            if (mapper === void 0) { mapper = function (e) { return e; }; }
            return function (filter) {
                var e_2, _a;
                if (filter === void 0) { filter = function (e) { return true; }; }
                var filteredArr = [];
                var initialIndex = 0, filteredIndex = 0;
                try {
                    for (var array_2 = __values(array), array_2_1 = array_2.next(); !array_2_1.done; array_2_1 = array_2.next()) {
                        var elem = array_2_1.value;
                        var mappedElem = mapper(elem, initialIndex++);
                        filter(mappedElem, filteredIndex++) &&
                            filteredArr.push(mappedElem);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (array_2_1 && !array_2_1.done && (_a = array_2.return)) _a.call(array_2);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                return filteredArr;
            };
        };
    };
    /**
     * Executes a callback for each element
     * (same as forEach, but in FP style + faster)
     * @param {any[]} [array]
     * @returns {function(function):void}
     */
    var forAll = function (array) {
        if (array === void 0) { array = []; }
        return function (callback) {
            var e_3, _a;
            var index = 0;
            try {
                for (var array_3 = __values(array), array_3_1 = array_3.next(); !array_3_1.done; array_3_1 = array_3.next()) {
                    var elem = array_3_1.value;
                    callback(elem, index++);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (array_3_1 && !array_3_1.done && (_a = array_3.return)) _a.call(array_3);
                }
                finally { if (e_3) throw e_3.error; }
            }
            return;
        };
    };
    /**
     * Maps array to values of
     * property by key
     * @param {any[]} [array]
     * @returns {function(string):any[]}
     */
    var keyMap = function (array) {
        if (array === void 0) { array = []; }
        return function (key) {
            return !key ? array : array.map(function (elem) { return elem[key]; });
        };
    };
    /**
     * @summary merges arrays
     * @param {any[]} source
     * @param  {...any[]} [targets]
     * @returns {any[]}
     */
    var mergeOnto = function (source) {
        var e_4, _a;
        var targets = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            targets[_i - 1] = arguments[_i];
        }
        var output = [];
        for (var index = 0; index < source.length; index++) {
            var item = source[index];
            if (typeof item === "undefined") {
                var finalValue = item;
                try {
                    for (var targets_1 = (e_4 = void 0, __values(targets)), targets_1_1 = targets_1.next(); !targets_1_1.done; targets_1_1 = targets_1.next()) {
                        var target = targets_1_1.value;
                        finalValue = target[index];
                    }
                }
                catch (e_4_1) { e_4 = { error: e_4_1 }; }
                finally {
                    try {
                        if (targets_1_1 && !targets_1_1.done && (_a = targets_1.return)) _a.call(targets_1);
                    }
                    finally { if (e_4) throw e_4.error; }
                }
                output.push(finalValue);
                continue;
            }
            output.push(item);
        }
        return output;
    };
    /**
     *
     * @param {any[]} source
     * @param {...any[]} targets
     * @returns {any[]}
     */
    var spliceInto = function (source) {
        var e_5, _a;
        var targets = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            targets[_i - 1] = arguments[_i];
        }
        var output = source.map(function (item) { return item; }); //shallow copy;
        try {
            for (var targets_2 = __values(targets), targets_2_1 = targets_2.next(); !targets_2_1.done; targets_2_1 = targets_2.next()) {
                var target = targets_2_1.value;
                target.forEach(function (item, index) {
                    if (typeof item !== "undefined") {
                        output.splice(index, 0, item);
                    }
                });
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (targets_2_1 && !targets_2_1.done && (_a = targets_2.return)) _a.call(targets_2);
            }
            finally { if (e_5) throw e_5.error; }
        }
        return output;
    };
    return {
        filterMap: filterMap,
        filterMapped: filterMapped,
        forAll: forAll,
        keyMap: keyMap,
        mergeOnto: mergeOnto,
        spliceInto: spliceInto
    };
}));
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        define([], factory);
    }
    else if (typeof module === 'object' && module.exports) {
        module.exports = factory();
    }
    else {
        root.utilJSON = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    /**
     * @summary converts object to query
     * @param {object} json parameters
     * @returns {string} query string
     */
    function JSONtoQuery(json) {
        /**
         * @summary recursive parser
         * @param {object} obj
         * @param {string} seq
         * @returns {string[]}
         */
        var deep = function (obj, seq) {
            var output = [];
            for (var key in obj) {
                if (typeof obj[key] === "object") {
                    output.push(deep(obj[key], "".concat(seq ? seq + '[' : '').concat(key).concat(seq ? ']' : '')));
                }
                else if (obj[key] !== undefined) {
                    output.push("".concat(seq ? seq + '[' : '').concat(key).concat(seq ? ']' : '', "=").concat(obj[key]));
                }
            }
            return output.reduce(function (r, c) { return r.concat(c); }, []);
        };
        return deep(json).join('&');
    }
    return {
        JSONtoQuery: JSONtoQuery
    };
}));
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        define([], factory);
    }
    else if (typeof module === 'object' && module.exports) {
        module.exports = factory();
    }
    else {
        root.Objects = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    /**
     * @summary checks if an object is a valid object
     * @param {object} obj
     * @returns {boolean}
     */
    var isObject = function (obj) { return typeof obj === 'object' && obj !== null && !Array.isArray(obj); };
    /**
     * @summary pushes value in or inits array with value
     * @param {object} obj
     * @param {string} key
     * @param {*} value
     * @returns {object}
     */
    var pushOrInitProp = function (obj, key, value) {
        if (key in obj) {
            var temp = obj[key];
            if (Array.isArray(temp)) {
                temp.push(value);
                return obj;
            }
            obj[key] = [temp, value];
            return obj;
        }
        obj[key] = [value];
        return obj;
    };
    /**
     * @typedef {object} SetOptions
     * @property {string} [coerce]
     *
     *
     * @summary copies property if it exists
     * @param {object} source
     * @param {string} key
     * @param {object} [target]
     * @param {SetOptions} [options]
     * @returns {object}
     */
    var setIf = function (source, key, target, options) {
        if (target === void 0) { target = {}; }
        if (options === void 0) { options = {}; }
        if (typeof key !== "string") {
            return target;
        }
        /** @type {Map<string, function>} */
        var coercionMap = new Map()
            .set("string", function (val) {
            if (typeof val === "string") {
                return val;
            }
            if (typeof val === "number") {
                return Number.prototype.toString.call(val);
            }
            return val;
        });
        var coerce = options.coerce;
        if (key in source) {
            var value = source[key];
            target[key] = coerce ? (coercionMap.get(coerce))(value) : value;
        }
        return target;
    };
    /**
     * @summary defines a smart (memoizable) getter
     * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get}
     * @param {object} context
     * @param {string} propName
     * @param {function} callback
     * @returns {object}
     */
    var smartGetter = function (context, propName, callback) {
        return Object.defineProperty(context, propName, {
            configurable: true,
            get: function () {
                var temp = callback(context);
                Object.defineProperty(context, propName, {
                    value: temp
                });
                return temp;
            }
        });
    };
    /**
     * @summary returns one of the object props equal
     * @param {object} [target] first object to compare
     * @param {string} propName property name
     */
    var switchIfDiffProp = function (target, propName) {
        /**
         * @param {object} [source] second object to compare
         * @returns {object}
         */
        return function (source) {
            if (!target) {
                return source || {};
            }
            if (!source) {
                return target || {};
            }
            return target[propName] === source[propName] ?
                target :
                source;
        };
    };
    /**
     * @summary makes a union of object
     * @param {object} target
     * @param  {...object} sources
     * @returns {object}
     */
    var union = function (target) {
        var e_6, _a;
        var sources = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            sources[_i - 1] = arguments[_i];
        }
        var union = Object.assign({}, target);
        var assignedKeys = {};
        try {
            for (var sources_1 = __values(sources), sources_1_1 = sources_1.next(); !sources_1_1.done; sources_1_1 = sources_1.next()) {
                var source = sources_1_1.value;
                for (var key in source) {
                    if (!assignedKeys[key] && !(key in union)) {
                        assignedKeys[key] |= 1;
                        union[key] = source[key];
                    }
                }
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (sources_1_1 && !sources_1_1.done && (_a = sources_1.return)) _a.call(sources_1);
            }
            finally { if (e_6) throw e_6.error; }
        }
        return union;
    };
    /**
     * @summary checks which key is set on object
     * @param {object} obj
     * @param  {...string} keys
     * @returns {string[]}
     */
    var whichKeysAreSet = function (obj) {
        var keys = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            keys[_i - 1] = arguments[_i];
        }
        return keys.filter(function (key) { return obj.hasOwnProperty(key); });
    };
    return {
        isObject: isObject,
        pushOrInitProp: pushOrInitProp,
        setIf: setIf,
        smartGetter: smartGetter,
        switchIfDiffProp: switchIfDiffProp,
        union: union,
        whichKeysAreSet: whichKeysAreSet
    };
}));
/**
 * @summary HTTPResponse -> ProcessedResponse map
 * @param {GoogleAppsScript.URL_Fetch.HTTPResponse} response
 * @returns {ProcessedResponse}
 */
var responseToJSON = function (response) { return ({
    code: response.getResponseCode(),
    headers: response.getHeaders(),
    content: response.getContentText()
}); };
/**
 * @summary adds mute option to configuration
 * @param {GoogleAppsScript.URL_Fetch.URLFetchRequest} config
 * @returns {GoogleAppsScript.URL_Fetch.URLFetchRequest}
 */
var addMute = function (config) { return (__assign(__assign({}, config), { muteHttpExceptions: true })); };
/**
 * @summary issues requests in batch
 * @param {GoogleAppsScript.URL_Fetch.URLFetchRequest[]} configs
 * @returns {ProcessedResponse[]}
 */
var batchFetch = function (configs, mute) {
    if (mute === void 0) { mute = false; }
    try {
        var responses = UrlFetchApp.fetchAll(mute ? configs.map(addMute) : configs);
        return responses.map(responseToJSON);
    }
    catch (_a) {
        var message = _a.message;
        return [{
                code: 0,
                headers: {},
                content: message
            }];
    }
};
/* global Cardin, getState, getParameters, getInputValues */
var UserSettings = /** @class */ (function () {
    /**
     * @param {object} config user settings configuration
     * @param {("BASIC"|"BEARER")} [config.authType="BASIC"] authorization type
     * @param {boolean} [config.firstTime=true] first-time user state
     * @param {number} [config.lastUpdated] timestamp of the last update
     * @param {string} [config.token] access token
     * @param {string} [config.region] user region
     */
    function UserSettings(_a) {
        var _b = _a.authType, authType = _b === void 0 ? "BEARER" : _b, _c = _a.firstTime, firstTime = _c === void 0 ? true : _c, _d = _a.lastUpdated, lastUpdated = _d === void 0 ? Date.now() : _d, _e = _a.token, token = _e === void 0 ? "" : _e, _f = _a.region, region = _f === void 0 ? "usa" : _f;
        this.authType = authType;
        this.firstTime = firstTime;
        this.lastUpdated = lastUpdated;
        this.region = region;
        this.token = token;
    }
    Object.defineProperty(UserSettings.prototype, "canAuth", {
        /**
         * @summary checks if there is any point to authorize
         * @returns {boolean}
         */
        get: function () {
            var _a = this, firstTime = _a.firstTime, token = _a.token;
            return !firstTime && token !== "";
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(UserSettings.prototype, "localeTimestamp", {
        /**
         * @summary locale-formats a timestamp
         * @returns {string}
         */
        get: function () {
            var lastUpdated = this.lastUpdated;
            return new Date(lastUpdated).toLocaleString();
        },
        enumerable: false,
        configurable: true
    });
    /**
     * @summary internal toJSON override
     * @param {string} key current object key
     * @returns {object}
     */
    UserSettings.prototype.toJSON = function (_key) {
        var e_7, _a;
        var ignore = [
            "constructor",
            "toString",
            "canAuth",
            "localeTimestamp"
        ];
        var temp = {};
        /**
         *
         * @param {object} obj
         * @returns {string[]}
         */
        var getAllNames = function (obj) {
            var protoNames = Object.getOwnPropertyNames(Object.getPrototypeOf(obj || {}));
            var ownNames = Object.getOwnPropertyNames(obj);
            return __spreadArray(__spreadArray([], __read(protoNames), false), __read(ownNames), false);
        };
        try {
            for (var _b = __values(getAllNames(this)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                if (!ignore.includes(key)) {
                    temp[key] = this[key];
                }
            }
        }
        catch (e_7_1) { e_7 = { error: e_7_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_7) throw e_7.error; }
        }
        return temp;
    };
    /**
     * @summary reloads settings for use with updated data
     * @returns {UserSettings}
     */
    UserSettings.prototype.reload = function () {
        var _this = this;
        var store = PropertiesService.getUserProperties();
        var saved = store.getProperty("settings");
        var parsed = JSON.parse(saved);
        Object.entries(parsed).forEach(function (_a) {
            var _b = __read(_a, 2), k = _b[0], v = _b[1];
            return _this[k] = v;
        });
        return this;
    };
    /**
     * @summary resets all user settings
     * @returns {UserSettings}
     */
    UserSettings.prototype.reset = function () {
        var store = PropertiesService.getUserProperties();
        store.deleteProperty("settings");
        this.authType = "BEARER";
        this.firstTime = true;
        this.token = "";
        this.lastUpdated = Date.now();
        return this;
    };
    /**
     * @summary saves all user settings
     * @returns {UserSettings}
     */
    UserSettings.prototype.save = function () {
        this.firstTime = false;
        var store = PropertiesService.getUserProperties();
        var prepared = JSON.stringify(this);
        store.setProperty("settings", prepared);
        return this;
    };
    return UserSettings;
}());
/**
 * @summary updates settings
 * @param {EventObject} e add-on event object
 * @returns {UserSettings}
 */
var updateSettings = function (e) {
    var newValues = getInputValues(e);
    var settings = getState().settings;
    Object.entries(newValues).forEach(function (_a) {
        var _b = __read(_a, 2), k = _b[0], _c = __read(_b[1], 1), v = _c[0];
        return settings[k] = v;
    });
    settings.save();
    settings.reload();
    return settings;
};
/**
 * @summary saves settings in background
 * @param {EventObject} e add-on event object
 * @returns {?GoogleAppsScript.Card_Service.ActionResponse}
 */
function backgroundSave(e) {
    updateSettings(e);
    var notify = getParameters(e).notify;
    if (notify) {
        return Cardin.actionResponse({ event: e, notify: notify });
    }
}
/**
 * @summary saves settings with a UI action
 * @param {GoogleAppsScript.Events.AppsScriptEvent} e Apps Script event object
 * @returns {GoogleAppsScript.Card_Service.ActionResponse}
 */
function foregroundSave(e) {
    var builderName = getParameters(e).builderName;
    updateSettings(e);
    var cf = getConfig();
    return Cardin.actionResponse({
        event: e,
        notify: cf.Strings.Notifications.Save.Success,
        navigate: ['root', { update: this[builderName](e) }]
    });
}
/**
 * @summary updates settings with
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.ActionResponse | null}
 */
var saveWithPing = function (e) {
    var _a = defaultProps(getInputValues(e), ["region", "token"], [""]), _b = __read(_a.region, 1), region = _b[0], _c = __read(_a.token, 1), token = _c[0];
    var _d = getParameters(e), builderName = _d.builderName, message = _d.message;
    var isValid = Keela.isAuthorized({ region: region, token: token });
    var cf = getConfig();
    if (!isValid) {
        return Cardin.actionResponse({
            event: e,
            notify: message || cf.Strings.Notifications.Save.Unauthorized
        });
    }
    return builderName ? foregroundSave(e) : backgroundSave(e);
};
/**
 * @summary resets all settings
 * @param {EventObject} e add-on event object
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function reset(e) {
    var settings = getState().settings;
    settings.reset();
    return buildSettings(e);
}
/**
 * @summary loads settings
 * @returns {UserSettings}
 */
function getSettings() {
    var store = PropertiesService.getUserProperties();
    var stored = store.getProperty("settings");
    return new UserSettings(stored ? JSON.parse(stored) : { firstTime: true });
}
/* global getState, getSettings, Keela */
/**
 * @summary "sigleton"-ish instance getter
 * @returns {Keela}
 */
function getState() {
    var cf = getConfig();
    var stateKey = cf.Properties.State;
    /** @type {Keela} */
    var state = this[stateKey];
    if (state) {
        return state;
    }
    var settings = getSettings();
    var created = new Keela({
        base: cf.Links.API,
        endpoints: ["contacts"]
    }, settings);
    this[stateKey] = created;
    return created;
}
/**
 * @summary Builds settings card;
 * @param {UserSettings} [settings]
 * @param {number} [page]
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function authFTEcard(settings, page) {
    if (settings === void 0) { settings = getSettings(); }
    var _a = settings.region, region = _a === void 0 ? "usa" : _a, _b = settings.token, token = _b === void 0 ? "" : _b;
    var cf = getConfig();
    var hasAccess = Keela.isAuthorized(settings);
    var startBrowsingDefaultConfig = {
        icon: Cardin.Icon.FORWARD,
        content: Cardin.Formatter.format({
            text: cf.Strings.FTE.Finish.Action,
            color: hasAccess ? cf.Colors.Primary : cf.Colors.Disabled,
            bold: hasAccess
        }),
        spaceBefore: true
    };
    if (hasAccess) { //disabled unless token is valid
        startBrowsingDefaultConfig.click = {
            callback: onSetupCompletion.name
        };
    }
    var config = {
        header: {
            image: getKeelaIcon(),
            title: cf.Strings.FTE.Auth.Title
        },
        sections: [
            makeRegionSection(cf, {
                region: region,
                page: page,
                builderName: buildAuthFTE.name,
            }),
            {
                widgets: __spreadArray(__spreadArray([
                    {
                        content: cf.Strings.FTE.Auth.Token,
                        spaceBefore: true
                    },
                    {
                        content: Cardin.Formatter.format({
                            text: cf.Strings.FTE.Auth.Button,
                            color: cf.Colors.Primary,
                            bold: true
                        }),
                        link: {
                            url: region ? "".concat(region, ".").concat(cf.Links.Base) : cf.Links.Base,
                            tab: true
                        }
                    },
                    {
                        content: cf.Strings.Settings.Token.Warning,
                        spaceBefore: true
                    }
                ], __read(getTaskListConfig(cf.Strings.FTE.Auth.Checkups.NeverShare, cf.Strings.FTE.Auth.Checkups.StoreSecure)), false), [
                    {
                        name: "token",
                        content: token,
                        title: cf.Strings.Settings.Token.Label,
                        hint: cf.Strings.Settings.Token.Required,
                        spaceAfter: true,
                        change: {
                            callback: saveWithPing.name,
                            params: {
                                page: page,
                                builderName: buildAuthFTE.name
                            },
                            spinner: true
                        },
                        hintColor: cf.Colors.Primary
                    },
                    startBrowsingDefaultConfig
                ], false)
            }
        ]
    };
    return Cardin.card(config);
}
/**
 * @summary builds help Card
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function helpCard() {
    var cf = getConfig();
    var config = {
        header: {
            title: cf.Strings.Cards.Help.Title
        },
        sections: [{
                header: "Contact Us",
                widgets: [getSupportWidgetConfg({
                        text: cf.Strings.Cards.Help.Prompt,
                        url: cf.Links.Support,
                        buttonText: "Submit"
                    })]
            },
            {
                header: "Resources",
                widgets: [{
                        icon: Cardin.Icon.WEB,
                        content: cf.Strings.Cards.Help.Before2020,
                        link: {
                            url: cf.Links.SupportBeforeJan,
                            tab: true
                        }
                    },
                    {
                        icon: Cardin.Icon.WEB,
                        content: cf.Strings.Cards.Help.After2020,
                        link: {
                            url: cf.Links.SupportAfterJan,
                            tab: true
                        }
                    }]
            }]
    };
    return Cardin.card(config);
}
/**
 * @summary builds home card
 * @param {Keela} keela
 * @param {ParsedMessage} message
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function homeCard(keela, message) {
    try {
        var configs = keela.run(message);
        return Cardin.deck(configs);
    }
    catch (error) {
        console.warn("failed to build home card: ".concat(error, ", region: ").concat(keela.settings.region));
        return Cardin.handleError(error, getErrorCardConfig());
    }
}
/**
 * @summary builds contextless homepage Card
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function homepageCard() {
    try {
        var cf = getConfig();
        /** @type {CardConfig} */
        var home = {
            header: {
                image: getHouseIcon(),
                title: cf.Strings.Cards.Home.Title
            },
            sections: [{
                    widgets: [{
                            content: cf.Strings.Cards.Home.Prompt
                        }]
                }]
        };
        return Cardin.deck([home]);
    }
    catch (error) {
        console.warn("failed to build homepage card: ".concat(error));
        return Cardin.handleError(error);
    }
}
/**
 * @summary Builds settings card;
 * @param {UserSettings} settings
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function settingsCard(settings) {
    var token = settings.token, region = settings.region;
    var cf = getConfig();
    /** @type {CardConfig} */
    var card = {
        header: {
            title: cf.Strings.Settings.Title
        },
        sections: [
            makeRegionSection(cf, { region: region, builderName: buildSettings.name }),
            {
                isCollapsible: true,
                numUncollapsible: 1,
                widgets: [{
                        content: cf.Strings.Settings.Token.Prompt,
                        buttonConfig: {
                            type: Cardin.WidgetType.TEXT_BUTTON,
                            icon: Cardin.Icon.TAB,
                            text: Cardin.Formatter.colorize(cf.Colors.Primary, cf.Strings.Settings.Token.Action),
                            link: {
                                url: region ? "https://".concat(region, ".").concat(cf.Links.Base) : cf.Links.Settings,
                                tab: true
                            }
                        }
                    },
                    {
                        change: {
                            callback: saveWithPing.name,
                            params: {
                                builderName: buildSettings.name
                            },
                            spinner: true
                        },
                        name: "token",
                        content: token,
                        title: cf.Strings.Settings.Token.Label,
                        hint: cf.Strings.Settings.Token.Example
                    }]
            },
            {
                header: "Manage",
                widgets: [{
                        icon: "CLOCK",
                        title: "Last updated",
                        content: settings.localeTimestamp
                    },
                    {
                        icon: Cardin.Icon.RESET,
                        content: "Reset all settings",
                        click: {
                            callback: "reset"
                        }
                    }]
            }
        ]
    };
    return Cardin.card(card);
}
/**
 * @summary makes a region section
 * @param {ReturnType<getConfig>} cf
 * @param {{
 *  builderName ?: string,
 *  page ?: number,
 *  region ?: "usa"|"can"|"aus"|"ca",
 *  ping ?: boolean
 * }}
 */
var makeRegionSection = function (cf, _a) {
    if (cf === void 0) { cf = getConfig(); }
    var _b = _a === void 0 ? {} : _a, _c = _b.region, region = _c === void 0 ? "usa" : _c, builderName = _b.builderName, _d = _b.ping, ping = _d === void 0 ? false : _d, page = _b.page;
    var options = [
        { text: "Australia", value: "aus" },
        { text: "Canada", value: "can" },
        { text: "USA", value: "usa" }
    ];
    if (region === "ca")
        region = "can"; //fixup for region change
    options.forEach(function (option) { return option.selected = (option.value === region); });
    var actionParams = {
        notify: cf.Strings.Notifications.Save.RegionSuccess,
    };
    if (builderName !== void 0) {
        actionParams.builderName = builderName;
    }
    if (page !== void 0) {
        actionParams.page = page;
    }
    var action = {
        callback: (ping ? saveWithPing : builderName ? foregroundSave : backgroundSave).name,
        params: actionParams,
        spinner: true
    };
    return {
        widgets: [{
                content: cf.Strings.Cards.Region.Prompt
            }, {
                type: Cardin.WidgetType.DROPDOWN,
                name: "region",
                content: options,
                change: action,
                spaceAfter: true
            }]
    };
};
/**
 * @summary builds region card
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function regionCard() {
    var cf = getConfig();
    var settingSection = makeRegionSection(cf);
    settingSection.widgets.push({
        icon: Cardin.Icon.FORWARD,
        content: Cardin.Formatter.format({
            text: cf.Strings.FTE.Finish.Action,
            color: cf.Colors.Primary,
            bold: true
        }),
        click: {
            callback: 'onMessageOpen'
        }
    });
    var region = {
        header: {
            image: getWebIcon(),
            title: cf.Strings.Cards.Region.Title
        },
        sections: [settingSection]
    };
    return Cardin.card(region);
}
/**
 * @summary Builds welcome card;
 * @returns {GoogleAppsScript.Card_Service.Card}
 */
function welcomeCard() {
    var cf = getConfig();
    var welcome = {
        header: {
            image: getKeelaIcon(),
            title: cf.Strings.FTE.Title
        },
        sections: [{
                widgets: [{
                        content: cf.Strings.FTE.Welcome,
                        spaceBefore: true
                    },
                    {
                        icon: Cardin.Icon.TASK,
                        content: cf.Strings.FTE.Tasks.Highlights
                    },
                    {
                        icon: Cardin.Icon.TASK,
                        content: cf.Strings.FTE.Tasks.Transactions
                    },
                    {
                        icon: Cardin.Icon.FORWARD,
                        content: Cardin.Formatter.format({
                            text: cf.Strings.FTE.Action,
                            color: cf.Colors.Primary,
                            bold: true
                        }),
                        spaceBefore: true,
                        click: {
                            callback: buildFTE.name,
                            params: { page: 1 }
                        }
                    }]
            }]
    };
    return Cardin.card(welcome);
}
/**
 * @summary gets a task list widget config
 * @param {...string} tasks task names
 * @returns {Array<{
 *  icon    : string,
 *  content : string
 * }>}
 */
var getTaskListConfig = function () {
    var tasks = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        tasks[_i] = arguments[_i];
    }
    return tasks.map(function (line) { return ({
        icon: Cardin.Icon.TASK,
        content: line
    }); });
};
/**
 * @summary gets a support widget config
 * @param {{
 *  text       ?: string,
 *  tab        ?: boolean,
 *  url        ?: string,
 *  callback   ?: string,
 *  buttonText ?: string
 * }}
 */
var getSupportWidgetConfg = function (_a) {
    var _b = _a === void 0 ? {} : _a, _c = _b.text, text = _c === void 0 ? "Please contact support" : _c, url = _b.url, _d = _b.callback, callback = _d === void 0 ? "buildHelp" : _d, _e = _b.buttonText, buttonText = _e === void 0 ? "Get Help" : _e, _f = _b.tab, tab = _f === void 0 ? true : _f;
    var cf = getConfig();
    var config = {
        content: text,
        buttonConfig: {
            type: Cardin.WidgetType.TEXT_BUTTON,
            icon: Cardin.Icon.TAB,
            text: Cardin.Formatter.colorize(cf.Colors.Primary, buttonText)
        }
    };
    var buttonConfig = config.buttonConfig;
    if (url) {
        buttonConfig.link = { url: url, tab: tab };
        return config;
    }
    buttonConfig.click = { callback: callback };
    return config;
};
/**
 * @summary general error card template
 * @param {object} [cf] add-on configuration
 * @returns {CardConfig}
 */
var getErrorCardConfig = function (cf) {
    if (cf === void 0) { cf = getConfig(); }
    return {
        header: {
            image: Cardin.Icon.WARNING,
            title: cf.Strings.Cards.Error.Title
        },
        sections: [
            {
                widgets: [
                    {
                        content: cf.Strings.Cards.Error.Reason.Long
                    },
                    getSupportWidgetConfg({
                        text: cf.Strings.Cards.Help.Prompt,
                        url: cf.Links.Support,
                        buttonText: "Submit"
                    })
                ]
            }
        ]
    };
};
/**
 * @summary checks if value is falsy or empty string
 * @param {undefined|null|""} [val] possibly falsy value
 * @returns {boolean}
 */
var isFalsyOrEmptyStr = function (val) { return val === void 0 || val === null || val === ""; };
/**
 * @summary defaults props to specified value if not found
 * @param {(Object.<string, any>|any[])} obj object to default
 * @param  {Object.<string, any>|string[]} props props to default
 * @param {any} [globalDefault] shared default value
 * @returns {object}
 */
var defaultProps = function (obj, props, globalDefault) {
    var pArr = Array.isArray(props);
    var output = Object.assign({}, obj);
    var hasGlobalDefault = globalDefault !== void 0;
    Object.entries(props).forEach(function (_a) {
        var _b = __read(_a, 2), name = _b[0], defaultOrName = _b[1];
        var propName = pArr ? defaultOrName : name;
        if (obj.hasOwnProperty(propName)) {
            output[propName] = obj[propName];
            return;
        }
        if (pArr) {
            output[propName] = globalDefault;
            return;
        }
        output[name] = defaultOrName === void 0 && hasGlobalDefault ? globalDefault : defaultOrName;
    });
    return output;
};
/**
 * @summary parses object properties
 * @param {object} obj object to parse
 * @returns {object}
 */
var propsFromString = function (obj) {
    var output = {};
    Object.entries(obj).forEach(function (_a) {
        var _b = __read(_a, 2), k = _b[0], v = _b[1];
        try {
            output[k] = JSON.parse(v);
        }
        catch (error) {
            output[k] = v;
        }
    });
    return output;
};
/**
 * @summary extracts event object params
 * @param {EventObject} e add-on event object
 * @returns {object}
 */
function getParameters(e) {
    var _a = e.commonEventObject, commonEventObject = _a === void 0 ? {} : _a;
    return propsFromString(commonEventObject.parameters || {});
}
/**
 * @summary formInputs parser
 * @param {EventObject} e add-on event object
 * @returns {Record<string, string[]>}
 */
function getInputValues(e) {
    var commonEventObject = e.commonEventObject;
    var formInputs = commonEventObject.formInputs;
    var temp = {};
    for (var key in formInputs) {
        var inputWrapper = formInputs[key];
        var dateInput = inputWrapper.dateInput, dateTimeInput = inputWrapper.dateTimeInput, stringInputs = inputWrapper.stringInputs, timeInput = inputWrapper.timeInput;
        var inputObject = dateInput || timeInput || dateTimeInput || stringInputs;
        var value = inputObject.value;
        //TODO: expand parser if needed
        temp[key] = value;
    }
    return temp;
}
/**
 * @summary overrides empty string props
 * @param {object} tgt target object
 * @param {object} src source object
 * @param {boolean} [missingAsEmpty] whether to set missing props
 * @returns {object}
 */
var assignToEmpty = function (tgt, src, missingAsEmpty) {
    if (missingAsEmpty === void 0) { missingAsEmpty = true; }
    var output = __assign({}, tgt);
    Object.keys(src).forEach(function (key) {
        if (tgt[key] === "" || missingAsEmpty && !(src.hasOwnProperty(key))) {
            output[key] = src[key];
        }
    });
    return output;
};
/**
 * @summary checks which environment the add-on is running in
 * @returns {boolean}
 */
var isDev = function () {
    try {
        var email = Session.getEffectiveUser().getEmail();
        return /@cardinsoft/.test(email);
    }
    catch (error) {
        console.warn(error);
        return false;
    }
};
/**
 * @template {unknown} T
 *
 * @summary gets last element of the array
 * @param {T[]} arr array to lookup
 * @returns {T|undefined}
 */
var last = function (arr) { return arr[arr.length - 1]; };

</script>
	<script>
!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1})}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var key,source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),_setPrototypeOf(subClass.prototype.constructor=subClass,superClass)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o})(o,p)}function _construct(Parent,args,Class){return(_construct=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),1}catch(e){}}}()?Reflect.construct.bind():function(Parent,args,Class){var a=[null];a.push.apply(a,args);args=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(args,Class.prototype),args}).apply(null,arguments)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return function(Class){if(null===Class||-1===Function.toString.call(Class).indexOf("[native code]"))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)}(Class)}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};for(var key,target={},sourceKeys=Object.keys(source),i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var i,it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=function(o,minLen){var n;if(o)return"string"==typeof o?_arrayLikeToArray(o,minLen):"Map"===(n="Object"===(n=Object.prototype.toString.call(o).slice(8,-1))&&o.constructor?o.constructor.name:n)||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}(o))||allowArrayLike&&o&&"number"==typeof o.length)return it&&(o=it),i=0,function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(exports,"__esModule",{value:!0});var LuxonError=function(_Error){function LuxonError(){return _Error.apply(this,arguments)||this}return _inheritsLoose(LuxonError,_Error),LuxonError}(_wrapNativeSuper(Error)),InvalidDateTimeError=function(_LuxonError){function InvalidDateTimeError(reason){return _LuxonError.call(this,"Invalid DateTime: "+reason.toMessage())||this}return _inheritsLoose(InvalidDateTimeError,_LuxonError),InvalidDateTimeError}(LuxonError),InvalidIntervalError=function(_LuxonError2){function InvalidIntervalError(reason){return _LuxonError2.call(this,"Invalid Interval: "+reason.toMessage())||this}return _inheritsLoose(InvalidIntervalError,_LuxonError2),InvalidIntervalError}(LuxonError),InvalidDurationError=function(_LuxonError3){function InvalidDurationError(reason){return _LuxonError3.call(this,"Invalid Duration: "+reason.toMessage())||this}return _inheritsLoose(InvalidDurationError,_LuxonError3),InvalidDurationError}(LuxonError),ConflictingSpecificationError=function(_LuxonError4){function ConflictingSpecificationError(){return _LuxonError4.apply(this,arguments)||this}return _inheritsLoose(ConflictingSpecificationError,_LuxonError4),ConflictingSpecificationError}(LuxonError),InvalidUnitError=function(_LuxonError5){function InvalidUnitError(unit){return _LuxonError5.call(this,"Invalid unit "+unit)||this}return _inheritsLoose(InvalidUnitError,_LuxonError5),InvalidUnitError}(LuxonError),InvalidArgumentError=function(_LuxonError6){function InvalidArgumentError(){return _LuxonError6.apply(this,arguments)||this}return _inheritsLoose(InvalidArgumentError,_LuxonError6),InvalidArgumentError}(LuxonError),ZoneIsAbstractError=function(_LuxonError7){function ZoneIsAbstractError(){return _LuxonError7.call(this,"Zone is an abstract class")||this}return _inheritsLoose(ZoneIsAbstractError,_LuxonError7),ZoneIsAbstractError}(LuxonError),LuxonError="numeric",s="short",l="long",DATE_SHORT={year:LuxonError,month:LuxonError,day:LuxonError},DATE_MED={year:LuxonError,month:s,day:LuxonError},DATE_MED_WITH_WEEKDAY={year:LuxonError,month:s,day:LuxonError,weekday:s},DATE_FULL={year:LuxonError,month:l,day:LuxonError},DATE_HUGE={year:LuxonError,month:l,day:LuxonError,weekday:l},TIME_SIMPLE={hour:LuxonError,minute:LuxonError},TIME_WITH_SECONDS={hour:LuxonError,minute:LuxonError,second:LuxonError},TIME_WITH_SHORT_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:l},TIME_24_SIMPLE={hour:LuxonError,minute:LuxonError,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:LuxonError,minute:LuxonError,second:LuxonError,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:LuxonError,month:LuxonError,day:LuxonError,hour:LuxonError,minute:LuxonError},DATETIME_SHORT_WITH_SECONDS={year:LuxonError,month:LuxonError,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError},DATETIME_MED={year:LuxonError,month:s,day:LuxonError,hour:LuxonError,minute:LuxonError},DATETIME_MED_WITH_SECONDS={year:LuxonError,month:s,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError},DATETIME_MED_WITH_WEEKDAY={year:LuxonError,month:s,day:LuxonError,weekday:s,hour:LuxonError,minute:LuxonError},DATETIME_FULL={year:LuxonError,month:l,day:LuxonError,hour:LuxonError,minute:LuxonError,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:LuxonError,month:l,day:LuxonError,hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:s},DATETIME_HUGE={year:LuxonError,month:l,day:LuxonError,weekday:l,hour:LuxonError,minute:LuxonError,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:LuxonError,month:l,day:LuxonError,weekday:l,hour:LuxonError,minute:LuxonError,second:LuxonError,timeZoneName:l};function isNumber(o){return"number"==typeof o}function isInteger(o){return"number"==typeof o&&o%1==0}function hasRelative(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function bestBy(arr,by,compare){if(0!==arr.length)return arr.reduce(function(best,next){next=[by(next),next];return best&&compare(best[0],next[0])===best[0]?best:next},null)[1]}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function integerBetween(thing,bottom,top){return isInteger(thing)&&bottom<=thing&&thing<=top}function padStart(input,n){void 0===n&&(n=2);input=input<0?"-"+(""+-input).padStart(n,"0"):(""+input).padStart(n,"0");return input}function parseInteger(string){if(null!=string&&""!==string)return parseInt(string,10)}function parseFloating(string){if(null!=string&&""!==string)return parseFloat(string)}function parseMillis(fraction){if(null!=fraction&&""!==fraction)return fraction=1e3*parseFloat("0."+fraction),Math.floor(fraction)}function roundTo(number,digits,towardZero){void 0===towardZero&&(towardZero=!1);digits=Math.pow(10,digits);return(towardZero?Math.trunc:Math.round)(number*digits)/digits}function isLeapYear(year){return year%4==0&&(year%100!=0||year%400==0)}function daysInYear(year){return isLeapYear(year)?366:365}function daysInMonth(year,month){var n,x=(x=month-1)-(n=12)*Math.floor(x/n)+1;return 2==x?isLeapYear(year+(month-x)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][x-1]}function objToLocalTS(obj){var d=Date.UTC(obj.year,obj.month-1,obj.day,obj.hour,obj.minute,obj.second,obj.millisecond);return obj.year<100&&0<=obj.year&&(d=new Date(d)).setUTCFullYear(d.getUTCFullYear()-1900),+d}function weeksInWeekYear(weekYear){var p1=(weekYear+Math.floor(weekYear/4)-Math.floor(weekYear/100)+Math.floor(weekYear/400))%7,weekYear=weekYear-1,weekYear=(weekYear+Math.floor(weekYear/4)-Math.floor(weekYear/100)+Math.floor(weekYear/400))%7;return 4==p1||3==weekYear?53:52}function untruncateYear(year){return 99<year?year:60<year?1900+year:2e3+year}function parseZoneInfo(ts,offsetFormat,locale,timeZone){void 0===timeZone&&(timeZone=null);var ts=new Date(ts),intlOpts={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"},timeZone=(timeZone&&(intlOpts.timeZone=timeZone),_extends({timeZoneName:offsetFormat},intlOpts)),offsetFormat=new Intl.DateTimeFormat(locale,timeZone).formatToParts(ts).find(function(m){return"timezonename"===m.type.toLowerCase()});return offsetFormat?offsetFormat.value:null}function signedOffset(offHourStr,offMinuteStr){offHourStr=parseInt(offHourStr,10),Number.isNaN(offHourStr)&&(offHourStr=0),offMinuteStr=parseInt(offMinuteStr,10)||0;return 60*offHourStr+(offHourStr<0||Object.is(offHourStr,-0)?-offMinuteStr:offMinuteStr)}function asNumber(value){var numericValue=Number(value);if("boolean"==typeof value||""===value||Number.isNaN(numericValue))throw new InvalidArgumentError("Invalid unit value "+value);return numericValue}function normalizeObject(obj,normalizer){var u,v,normalized={};for(u in obj)!hasOwnProperty(obj,u)||null!=(v=obj[u])&&(normalized[normalizer(u)]=asNumber(v));return normalized}function formatOffset(offset,format){var hours=Math.trunc(Math.abs(offset/60)),minutes=Math.trunc(Math.abs(offset%60)),sign=0<=offset?"+":"-";switch(format){case"short":return sign+padStart(hours,2)+":"+padStart(minutes,2);case"narrow":return sign+hours+(0<minutes?":"+minutes:"");case"techie":return sign+padStart(hours,2)+padStart(minutes,2);default:throw new RangeError("Value format "+format+" is out of range for property format")}}function timeObject(obj){return function(obj,keys){return keys.reduce(function(a,k){return a[k]=obj[k],a},{})}(obj,["hour","minute","second","millisecond"])}var s=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(length){switch(length){case"narrow":return[].concat(monthsNarrow);case"short":return[].concat(monthsShort);case"long":return[].concat(monthsLong);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(length){switch(length){case"narrow":return[].concat(weekdaysNarrow);case"short":return[].concat(weekdaysShort);case"long":return[].concat(weekdaysLong);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(length){switch(length){case"narrow":return[].concat(erasNarrow);case"short":return[].concat(erasShort);case"long":return[].concat(erasLong);default:return null}}function stringifyTokens(splits,tokenToString){for(var s="",_iterator=_createForOfIteratorHelperLoose(splits);!(_step=_iterator()).done;){var _step=_step.value;_step.literal?s+=_step.val:s+=tokenToString(_step.val)}return s}var _macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS},Formatter=function(){function Formatter(locale,formatOpts){this.opts=formatOpts,this.loc=locale,this.systemLoc=null}Formatter.create=function(locale,opts){return new Formatter(locale,opts=void 0===opts?{}:opts)},Formatter.parseFormat=function(fmt){for(var current=null,currentFull="",bracketed=!1,splits=[],i=0;i<fmt.length;i++){var c=fmt.charAt(i);"'"===c?(0<currentFull.length&&splits.push({literal:bracketed,val:currentFull}),current=null,currentFull="",bracketed=!bracketed):bracketed||c===current?currentFull+=c:(0<currentFull.length&&splits.push({literal:!1,val:currentFull}),current=currentFull=c)}return 0<currentFull.length&&splits.push({literal:bracketed,val:currentFull}),splits},Formatter.macroTokenToFormatOpts=function(token){return _macroTokenToFormatOpts[token]};var _proto=Formatter.prototype;return _proto.formatWithSystemDefault=function(dt,opts){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(dt,_extends({},this.opts,opts)).format()},_proto.formatDateTime=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).format()},_proto.formatDateTimeParts=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).formatToParts()},_proto.resolvedOptions=function(dt,opts){return this.loc.dtFormatter(dt,_extends({},this.opts,opts=void 0===opts?{}:opts)).resolvedOptions()},_proto.num=function(n,p){var opts;return void 0===p&&(p=0),this.opts.forceSimple?padStart(n,p):(opts=_extends({},this.opts),0<p&&(opts.padTo=p),this.loc.numberFormatter(opts).format(n))},_proto.formatDateTimeFromString=function(dt,fmt){var _this=this,knownEnglish="en"===this.loc.listingMode(),useDateTimeFormatter=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,string=function(opts,extract){return _this.loc.extract(dt,opts,extract)},formatOffset=function(opts){return dt.isOffsetFixed&&0===dt.offset&&opts.allowZ?"Z":dt.isValid?dt.zone.formatOffset(dt.ts,opts.format):""},meridiem=function(){return knownEnglish?function(dt){return meridiems[dt.hour<12?0:1]}(dt):string({hour:"numeric",hourCycle:"h12"},"dayperiod")},month=function(length,standalone){return knownEnglish?function(dt,length){return months(length)[dt.month-1]}(dt,length):string(standalone?{month:length}:{month:length,day:"numeric"},"month")},weekday=function(length,standalone){return knownEnglish?function(dt,length){return weekdays(length)[dt.weekday-1]}(dt,length):string(standalone?{weekday:length}:{weekday:length,month:"long",day:"numeric"},"weekday")},maybeMacro=function(token){var formatOpts=Formatter.macroTokenToFormatOpts(token);return formatOpts?_this.formatWithSystemDefault(dt,formatOpts):token},era=function(length){return knownEnglish?function(dt,length){return eras(length)[dt.year<0?0:1]}(dt,length):string({era:length},"era")};return stringifyTokens(Formatter.parseFormat(fmt),function(token){switch(token){case"S":return _this.num(dt.millisecond);case"u":case"SSS":return _this.num(dt.millisecond,3);case"s":return _this.num(dt.second);case"ss":return _this.num(dt.second,2);case"uu":return _this.num(Math.floor(dt.millisecond/10),2);case"uuu":return _this.num(Math.floor(dt.millisecond/100));case"m":return _this.num(dt.minute);case"mm":return _this.num(dt.minute,2);case"h":return _this.num(dt.hour%12==0?12:dt.hour%12);case"hh":return _this.num(dt.hour%12==0?12:dt.hour%12,2);case"H":return _this.num(dt.hour);case"HH":return _this.num(dt.hour,2);case"Z":return formatOffset({format:"narrow",allowZ:_this.opts.allowZ});case"ZZ":return formatOffset({format:"short",allowZ:_this.opts.allowZ});case"ZZZ":return formatOffset({format:"techie",allowZ:_this.opts.allowZ});case"ZZZZ":return dt.zone.offsetName(dt.ts,{format:"short",locale:_this.loc.locale});case"ZZZZZ":return dt.zone.offsetName(dt.ts,{format:"long",locale:_this.loc.locale});case"z":return dt.zoneName;case"a":return meridiem();case"d":return useDateTimeFormatter?string({day:"numeric"},"day"):_this.num(dt.day);case"dd":return useDateTimeFormatter?string({day:"2-digit"},"day"):_this.num(dt.day,2);case"c":return _this.num(dt.weekday);case"ccc":return weekday("short",!0);case"cccc":return weekday("long",!0);case"ccccc":return weekday("narrow",!0);case"E":return _this.num(dt.weekday);case"EEE":return weekday("short",!1);case"EEEE":return weekday("long",!1);case"EEEEE":return weekday("narrow",!1);case"L":return useDateTimeFormatter?string({month:"numeric",day:"numeric"},"month"):_this.num(dt.month);case"LL":return useDateTimeFormatter?string({month:"2-digit",day:"numeric"},"month"):_this.num(dt.month,2);case"LLL":return month("short",!0);case"LLLL":return month("long",!0);case"LLLLL":return month("narrow",!0);case"M":return useDateTimeFormatter?string({month:"numeric"},"month"):_this.num(dt.month);case"MM":return useDateTimeFormatter?string({month:"2-digit"},"month"):_this.num(dt.month,2);case"MMM":return month("short",!1);case"MMMM":return month("long",!1);case"MMMMM":return month("narrow",!1);case"y":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year);case"yy":return useDateTimeFormatter?string({year:"2-digit"},"year"):_this.num(dt.year.toString().slice(-2),2);case"yyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year,4);case"yyyyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):_this.num(dt.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return _this.num(dt.weekYear.toString().slice(-2),2);case"kkkk":return _this.num(dt.weekYear,4);case"W":return _this.num(dt.weekNumber);case"WW":return _this.num(dt.weekNumber,2);case"o":return _this.num(dt.ordinal);case"ooo":return _this.num(dt.ordinal,3);case"q":return _this.num(dt.quarter);case"qq":return _this.num(dt.quarter,2);case"X":return _this.num(Math.floor(dt.ts/1e3));case"x":return _this.num(dt.ts);default:return maybeMacro(token)}})},_proto.formatDurationFromString=function(dur,fmt){var lildur,_this2=this,tokenToField=function(token){switch(token[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},fmt=Formatter.parseFormat(fmt),realTokens=fmt.reduce(function(found,_ref){var literal=_ref.literal,_ref=_ref.val;return literal?found:found.concat(_ref)},[]),dur=dur.shiftTo.apply(dur,realTokens.map(tokenToField).filter(function(t){return t}));return stringifyTokens(fmt,(lildur=dur,function(token){var mapped=tokenToField(token);return mapped?_this2.num(lildur.get(mapped),token.length):token}))},Formatter}(),Invalid=function(){function Invalid(reason,explanation){this.reason=reason,this.explanation=explanation}return Invalid.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},Invalid}(),Zone=function(){function Zone(){}var _proto=Zone.prototype;return _proto.offsetName=function(ts,opts){throw new ZoneIsAbstractError},_proto.formatOffset=function(ts,format){throw new ZoneIsAbstractError},_proto.offset=function(ts){throw new ZoneIsAbstractError},_proto.equals=function(otherZone){throw new ZoneIsAbstractError},_createClass(Zone,[{key:"type",get:function(){throw new ZoneIsAbstractError}},{key:"name",get:function(){throw new ZoneIsAbstractError}},{key:"ianaName",get:function(){return this.name}},{key:"isUniversal",get:function(){throw new ZoneIsAbstractError}},{key:"isValid",get:function(){throw new ZoneIsAbstractError}}]),Zone}(),singleton$1=null,SystemZone=function(_Zone){function SystemZone(){return _Zone.apply(this,arguments)||this}_inheritsLoose(SystemZone,_Zone);var _proto=SystemZone.prototype;return _proto.offsetName=function(ts,_ref){return parseZoneInfo(ts,_ref.format,_ref.locale)},_proto.formatOffset=function(ts,format){return formatOffset(this.offset(ts),format)},_proto.offset=function(ts){return-new Date(ts).getTimezoneOffset()},_proto.equals=function(otherZone){return"system"===otherZone.type},_createClass(SystemZone,[{key:"type",get:function(){return"system"}},{key:"name",get:function(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return singleton$1=null===singleton$1?new SystemZone:singleton$1}}]),SystemZone}(Zone),dtfCache={};var typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};var ianaZoneCache={},IANAZone=function(_Zone){function IANAZone(name){var _this=_Zone.call(this)||this;return _this.zoneName=name,_this.valid=IANAZone.isValidZone(name),_this}_inheritsLoose(IANAZone,_Zone),IANAZone.create=function(name){return ianaZoneCache[name]||(ianaZoneCache[name]=new IANAZone(name)),ianaZoneCache[name]},IANAZone.resetCache=function(){ianaZoneCache={},dtfCache={}},IANAZone.isValidSpecifier=function(s){return this.isValidZone(s)},IANAZone.isValidZone=function(zone){if(!zone)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:zone}).format(),!0}catch(e){return!1}};var _proto=IANAZone.prototype;return _proto.offsetName=function(ts,_ref){return parseZoneInfo(ts,_ref.format,_ref.locale,this.name)},_proto.formatOffset=function(ts,format){return formatOffset(this.offset(ts),format)},_proto.offset=function(ts){var year,month,day,adOrBc,minute,zone,hour,over,ts=new Date(ts);return isNaN(ts)?NaN:(zone=this.name,dtfCache[zone]||(dtfCache[zone]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:zone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),year=(zone=((zone=dtfCache[zone]).formatToParts?function(dtf,date){for(var formatted=dtf.formatToParts(date),filled=[],i=0;i<formatted.length;i++){var _formatted$i=formatted[i],type=_formatted$i.type,_formatted$i=_formatted$i.value,pos=typeToPos[type];"era"===type?filled[pos]=_formatted$i:void 0!==pos&&(filled[pos]=parseInt(_formatted$i,10))}return filled}:function(dtf,date){var dtf=dtf.format(date).replace(/\u200E/g,""),dtf=(date=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(dtf))[1],fDay=date[2];return[date[3],dtf,fDay,date[4],date[5],date[6],date[7]]})(zone,ts))[0],month=zone[1],day=zone[2],adOrBc=zone[3],hour=zone[4],minute=zone[5],zone=zone[6],hour=24===hour?0:hour,over=(ts=+ts)%1e3,(objToLocalTS({year:year="BC"===adOrBc?1-Math.abs(year):year,month:month,day:day,hour:hour,minute:minute,second:zone,millisecond:0})-(ts-=0<=over?over:1e3+over))/6e4)},_proto.equals=function(otherZone){return"iana"===otherZone.type&&otherZone.name===this.name},_createClass(IANAZone,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),IANAZone}(Zone),singleton=null,FixedOffsetZone=function(_Zone){function FixedOffsetZone(offset){var _this=_Zone.call(this)||this;return _this.fixed=offset,_this}_inheritsLoose(FixedOffsetZone,_Zone),FixedOffsetZone.instance=function(offset){return 0===offset?FixedOffsetZone.utcInstance:new FixedOffsetZone(offset)},FixedOffsetZone.parseSpecifier=function(s){if(s){s=s.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(s)return new FixedOffsetZone(signedOffset(s[1],s[2]))}return null};var _proto=FixedOffsetZone.prototype;return _proto.offsetName=function(){return this.name},_proto.formatOffset=function(ts,format){return formatOffset(this.fixed,format)},_proto.offset=function(){return this.fixed},_proto.equals=function(otherZone){return"fixed"===otherZone.type&&otherZone.fixed===this.fixed},_createClass(FixedOffsetZone,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+formatOffset(this.fixed,"narrow")}},{key:"ianaName",get:function(){return 0===this.fixed?"Etc/UTC":"Etc/GMT"+formatOffset(-this.fixed,"narrow")}},{key:"isUniversal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}],[{key:"utcInstance",get:function(){return singleton=null===singleton?new FixedOffsetZone(0):singleton}}]),FixedOffsetZone}(Zone),InvalidZone=function(_Zone){function InvalidZone(zoneName){var _this=_Zone.call(this)||this;return _this.zoneName=zoneName,_this}_inheritsLoose(InvalidZone,_Zone);var _proto=InvalidZone.prototype;return _proto.offsetName=function(){return null},_proto.formatOffset=function(){return""},_proto.offset=function(){return NaN},_proto.equals=function(){return!1},_createClass(InvalidZone,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),InvalidZone}(Zone);function normalizeZone(input,defaultZone){var lowered;return null==input?defaultZone:input instanceof Zone?input:"string"==typeof input?"default"===(lowered=input.toLowerCase())?defaultZone:"local"===lowered||"system"===lowered?SystemZone.instance:"utc"===lowered||"gmt"===lowered?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(lowered)||IANAZone.create(input):isNumber(input)?FixedOffsetZone.instance(input):"object"==typeof input&&input.offset&&"number"==typeof input.offset?input:new InvalidZone(input)}var throwOnInvalid,now=function(){return Date.now()},defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,Settings=function(){function Settings(){}return Settings.resetCaches=function(){Locale.resetCache(),IANAZone.resetCache()},_createClass(Settings,null,[{key:"now",get:function(){return now},set:function(n){now=n}},{key:"defaultZone",get:function(){return normalizeZone(defaultZone,SystemZone.instance)},set:function(zone){defaultZone=zone}},{key:"defaultLocale",get:function(){return defaultLocale},set:function(locale){defaultLocale=locale}},{key:"defaultNumberingSystem",get:function(){return defaultNumberingSystem},set:function(numberingSystem){defaultNumberingSystem=numberingSystem}},{key:"defaultOutputCalendar",get:function(){return defaultOutputCalendar},set:function(outputCalendar){defaultOutputCalendar=outputCalendar}},{key:"throwOnInvalid",get:function(){return throwOnInvalid},set:function(t){throwOnInvalid=t}}]),Settings}(),_excluded=["base"],_excluded2=["padTo","floor"],intlLFCache={};var intlDTCache={};function getCachedDTF(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),dtf=intlDTCache[key];return dtf||(dtf=new Intl.DateTimeFormat(locString,opts),intlDTCache[key]=dtf),dtf}var intlNumCache={};var intlRelCache={};var sysLocaleCache=null;function listStuff(loc,length,defaultOK,englishFn,intlFn){loc=loc.listingMode(defaultOK);return"error"===loc?null:("en"===loc?englishFn:intlFn)(length)}var PolyNumberFormatter=function(){function PolyNumberFormatter(intl,forceSimple,opts){this.padTo=opts.padTo||0,this.floor=opts.floor||!1,opts.padTo,opts.floor;var otherOpts=_objectWithoutPropertiesLoose(opts,_excluded2);(!forceSimple||0<Object.keys(otherOpts).length)&&(forceSimple=_extends({useGrouping:!1},opts),0<opts.padTo&&(forceSimple.minimumIntegerDigits=opts.padTo),this.inf=function(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),inf=intlNumCache[key];return inf||(inf=new Intl.NumberFormat(locString,opts),intlNumCache[key]=inf),inf}(intl,forceSimple))}return PolyNumberFormatter.prototype.format=function(i){var fixed;return this.inf?(fixed=this.floor?Math.floor(i):i,this.inf.format(fixed)):padStart(this.floor?Math.floor(i):roundTo(i,3),this.padTo)},PolyNumberFormatter}(),PolyDateFormatter=function(){function PolyDateFormatter(dt,intl,opts){this.opts=opts,dt.zone.isUniversal?(gmtOffset=0<=(gmtOffset=dt.offset/60*-1)?"Etc/GMT+"+gmtOffset:"Etc/GMT"+gmtOffset,0!==dt.offset&&IANAZone.create(gmtOffset).valid?(z=gmtOffset,this.dt=dt):(z="UTC",opts.timeZoneName?this.dt=dt:this.dt=0===dt.offset?dt:DateTime.fromMillis(dt.ts+60*dt.offset*1e3))):"system"===dt.zone.type?this.dt=dt:z=(this.dt=dt).zone.name;var z,gmtOffset=_extends({},this.opts);z&&(gmtOffset.timeZone=z),this.dtf=getCachedDTF(intl,gmtOffset)}var _proto2=PolyDateFormatter.prototype;return _proto2.format=function(){return this.dtf.format(this.dt.toJSDate())},_proto2.formatToParts=function(){return this.dtf.formatToParts(this.dt.toJSDate())},_proto2.resolvedOptions=function(){return this.dtf.resolvedOptions()},PolyDateFormatter}(),PolyRelFormatter=function(){function PolyRelFormatter(intl,isEnglish,opts){this.opts=_extends({style:"long"},opts),!isEnglish&&hasRelative()&&(this.rtf=function(locString,opts){(_opts=opts=void 0===opts?{}:opts).base;var _opts=_objectWithoutPropertiesLoose(_opts=opts,_excluded),_opts=JSON.stringify([locString,_opts]),inf=intlRelCache[_opts];return inf||(inf=new Intl.RelativeTimeFormat(locString,opts),intlRelCache[_opts]=inf),inf}(intl,opts))}var _proto3=PolyRelFormatter.prototype;return _proto3.format=function(count,unit){return this.rtf?this.rtf.format(count,unit):function(unit,count,numeric,narrow){void 0===numeric&&(numeric="always"),void 0===narrow&&(narrow=!1);var units={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},lastable=-1===["hours","minutes","seconds"].indexOf(unit);if("auto"===numeric&&lastable){var isDay="days"===unit;switch(count){case 1:return isDay?"tomorrow":"next "+units[unit][0];case-1:return isDay?"yesterday":"last "+units[unit][0];case 0:return isDay?"today":"this "+units[unit][0]}}var numeric=Object.is(count,-0)||count<0,count=1===(lastable=Math.abs(count)),lilUnits=units[unit],narrow=narrow?!count&&lilUnits[2]||lilUnits[1]:count?units[unit][0]:unit;return numeric?lastable+" "+narrow+" ago":"in "+lastable+" "+narrow}(unit,count,this.opts.numeric,"long"!==this.opts.style)},_proto3.formatToParts=function(count,unit){return this.rtf?this.rtf.formatToParts(count,unit):[]},PolyRelFormatter}(),Locale=function(){function Locale(locale,numbering,outputCalendar,specifiedLocale){var locale=function(localeStr){if(-1===(uIndex=localeStr.indexOf("-u-")))return[localeStr];var options,uIndex=localeStr.substring(0,uIndex);try{options=getCachedDTF(localeStr).resolvedOptions()}catch(e){options=getCachedDTF(uIndex).resolvedOptions()}return[uIndex,(localeStr=options).numberingSystem,localeStr.calendar]}(locale),parsedLocale=locale[0],parsedNumberingSystem=locale[1],locale=locale[2];this.locale=parsedLocale,this.numberingSystem=numbering||parsedNumberingSystem||null,this.outputCalendar=outputCalendar||locale||null,this.intl=function(localeStr,numberingSystem,outputCalendar){return(outputCalendar||numberingSystem)&&(localeStr+="-u",outputCalendar&&(localeStr+="-ca-"+outputCalendar),numberingSystem&&(localeStr+="-nu-"+numberingSystem)),localeStr}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=specifiedLocale,this.fastNumbersCached=null}Locale.fromOpts=function(opts){return Locale.create(opts.locale,opts.numberingSystem,opts.outputCalendar,opts.defaultToEN)},Locale.create=function(locale,numberingSystem,outputCalendar,defaultToEN){void 0===defaultToEN&&(defaultToEN=!1);locale=locale||Settings.defaultLocale;return new Locale(locale||(defaultToEN?"en-US":sysLocaleCache=sysLocaleCache||(new Intl.DateTimeFormat).resolvedOptions().locale),numberingSystem||Settings.defaultNumberingSystem,outputCalendar||Settings.defaultOutputCalendar,locale)},Locale.resetCache=function(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}},Locale.fromObject=function(_temp){var _temp=void 0===_temp?{}:_temp,locale=_temp.locale,numberingSystem=_temp.numberingSystem,_temp=_temp.outputCalendar;return Locale.create(locale,numberingSystem,_temp)};var _proto4=Locale.prototype;return _proto4.listingMode=function(){var isActuallyEn=this.isEnglish(),hasNoWeirdness=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return isActuallyEn&&hasNoWeirdness?"en":"intl"},_proto4.clone=function(alts){return alts&&0!==Object.getOwnPropertyNames(alts).length?Locale.create(alts.locale||this.specifiedLocale,alts.numberingSystem||this.numberingSystem,alts.outputCalendar||this.outputCalendar,alts.defaultToEN||!1):this},_proto4.redefaultToEN=function(alts){return this.clone(_extends({},alts=void 0===alts?{}:alts,{defaultToEN:!0}))},_proto4.redefaultToSystem=function(alts){return this.clone(_extends({},alts=void 0===alts?{}:alts,{defaultToEN:!1}))},_proto4.months=function(length,format,defaultOK){var _this=this;return void 0===format&&(format=!1),listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,months,function(){var intl=format?{month:length,day:"numeric"}:{month:length},formatStr=format?"format":"standalone";return _this.monthsCache[formatStr][length]||(_this.monthsCache[formatStr][length]=function(f){for(var ms=[],i=1;i<=12;i++){var dt=DateTime.utc(2016,i,1);ms.push(f(dt))}return ms}(function(dt){return _this.extract(dt,intl,"month")})),_this.monthsCache[formatStr][length]})},_proto4.weekdays=function(length,format,defaultOK){var _this2=this;return void 0===format&&(format=!1),listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,weekdays,function(){var intl=format?{weekday:length,year:"numeric",month:"long",day:"numeric"}:{weekday:length},formatStr=format?"format":"standalone";return _this2.weekdaysCache[formatStr][length]||(_this2.weekdaysCache[formatStr][length]=function(f){for(var ms=[],i=1;i<=7;i++){var dt=DateTime.utc(2016,11,13+i);ms.push(f(dt))}return ms}(function(dt){return _this2.extract(dt,intl,"weekday")})),_this2.weekdaysCache[formatStr][length]})},_proto4.meridiems=function(defaultOK){var _this3=this;return listStuff(this,void 0,defaultOK=void 0===defaultOK?!0:defaultOK,function(){return meridiems},function(){var intl;return _this3.meridiemCache||(intl={hour:"numeric",hourCycle:"h12"},_this3.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(function(dt){return _this3.extract(dt,intl,"dayperiod")})),_this3.meridiemCache})},_proto4.eras=function(length,defaultOK){var _this4=this;return listStuff(this,length,defaultOK=void 0===defaultOK?!0:defaultOK,eras,function(){var intl={era:length};return _this4.eraCache[length]||(_this4.eraCache[length]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(function(dt){return _this4.extract(dt,intl,"era")})),_this4.eraCache[length]})},_proto4.extract=function(dt,intlOpts,field){dt=this.dtFormatter(dt,intlOpts).formatToParts().find(function(m){return m.type.toLowerCase()===field});return dt?dt.value:null},_proto4.numberFormatter=function(opts){return new PolyNumberFormatter(this.intl,(opts=void 0===opts?{}:opts).forceSimple||this.fastNumbers,opts)},_proto4.dtFormatter=function(dt,intlOpts){return new PolyDateFormatter(dt,this.intl,intlOpts=void 0===intlOpts?{}:intlOpts)},_proto4.relFormatter=function(opts){return void 0===opts&&(opts={}),new PolyRelFormatter(this.intl,this.isEnglish(),opts)},_proto4.listFormatter=function(opts){return function(locString,opts){void 0===opts&&(opts={});var key=JSON.stringify([locString,opts]),dtf=intlLFCache[key];return dtf||(dtf=new Intl.ListFormat(locString,opts),intlLFCache[key]=dtf),dtf}(this.intl,opts=void 0===opts?{}:opts)},_proto4.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},_proto4.equals=function(other){return this.locale===other.locale&&this.numberingSystem===other.numberingSystem&&this.outputCalendar===other.outputCalendar},_createClass(Locale,[{key:"fastNumbers",get:function(){var loc;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(loc=this).numberingSystem||"latn"===loc.numberingSystem)&&("latn"===loc.numberingSystem||!loc.locale||loc.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(loc.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),Locale}();function combineRegexes(){for(var _len=arguments.length,regexes=new Array(_len),_key=0;_key<_len;_key++)regexes[_key]=arguments[_key];var full=regexes.reduce(function(f,r){return f+r.source},"");return RegExp("^"+full+"$")}function combineExtractors(){for(var _len2=arguments.length,extractors=new Array(_len2),_key2=0;_key2<_len2;_key2++)extractors[_key2]=arguments[_key2];return function(m){return extractors.reduce(function(_ref,ex){var mergedVals=_ref[0],mergedZone=_ref[1],_ref=_ref[2],ex=ex(m,_ref),_ref=ex[0],zone=ex[1],ex=ex[2];return[_extends({},mergedVals,_ref),zone||mergedZone,ex]},[{},null,1]).slice(0,2)}}function parse(s){if(null!=s){for(var _len3=arguments.length,patterns=new Array(1<_len3?_len3-1:0),_key3=1;_key3<_len3;_key3++)patterns[_key3-1]=arguments[_key3];for(var _i=0,_patterns=patterns;_i<_patterns.length;_i++){var _patterns$_i=_patterns[_i],regex=_patterns$_i[0],_patterns$_i=_patterns$_i[1],regex=regex.exec(s);if(regex)return _patterns$_i(regex)}}return[null,null]}function simpleParse(){for(var _len4=arguments.length,keys=new Array(_len4),_key4=0;_key4<_len4;_key4++)keys[_key4]=arguments[_key4];return function(match,cursor){for(var ret={},i=0;i<keys.length;i++)ret[keys[i]]=parseInteger(match[cursor+i]);return[ret,null,cursor+i]}}var LuxonError=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,l=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(l.source+("(?:"+LuxonError.source+"?(?:\\[("+s.source+")\\])?)?")),isoTimeExtensionRegex=RegExp("(?:T"+isoTimeRegex.source+")?"),extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),LuxonError=RegExp(l.source+" ?(?:"+LuxonError.source+"|("+s.source+"))?"),s=RegExp("(?: "+LuxonError.source+")?");function int(match,pos,fallback){match=match[pos];return void 0===match?fallback:parseInteger(match)}function extractISOTime(match,cursor){return[{hours:int(match,cursor,0),minutes:int(match,cursor+1,0),seconds:int(match,cursor+2,0),milliseconds:parseMillis(match[cursor+3])},null,cursor+4]}function extractISOOffset(match,cursor){var local=!match[cursor]&&!match[cursor+1],match=signedOffset(match[cursor+1],match[cursor+2]);return[{},local?null:FixedOffsetZone.instance(match),cursor+3]}function extractIANAZone(match,cursor){return[{},match[cursor]?IANAZone.create(match[cursor]):null,cursor+1]}var isoTimeOnly=RegExp("^T?"+l.source+"$"),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(match){function maybeNegate(num,force){return void 0===force&&(force=!1),void 0!==num&&(force||num&&hasNegativePrefix)?-num:num}var s=match[0],yearStr=match[1],monthStr=match[2],weekStr=match[3],dayStr=match[4],hourStr=match[5],minuteStr=match[6],secondStr=match[7],match=match[8],hasNegativePrefix="-"===s[0],s=secondStr&&"-"===secondStr[0];return[{years:maybeNegate(parseFloating(yearStr)),months:maybeNegate(parseFloating(monthStr)),weeks:maybeNegate(parseFloating(weekStr)),days:maybeNegate(parseFloating(dayStr)),hours:maybeNegate(parseFloating(hourStr)),minutes:maybeNegate(parseFloating(minuteStr)),seconds:maybeNegate(parseFloating(secondStr),"-0"===secondStr),milliseconds:maybeNegate(parseMillis(match),s)}]}var obsOffsets={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){yearStr={year:2===yearStr.length?untruncateYear(parseInteger(yearStr)):parseInteger(yearStr),month:monthsShort.indexOf(monthStr)+1,day:parseInteger(dayStr),hour:parseInteger(hourStr),minute:parseInteger(minuteStr)};return secondStr&&(yearStr.second=parseInteger(secondStr)),weekdayStr&&(yearStr.weekday=3<weekdayStr.length?weekdaysLong.indexOf(weekdayStr)+1:weekdaysShort.indexOf(weekdayStr)+1),yearStr}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(match){var weekdayStr=match[1],dayStr=match[2],monthStr=match[3],yearStr=match[4],hourStr=match[5],minuteStr=match[6],secondStr=match[7],obsOffset=match[8],milOffset=match[9],offHourStr=match[10],match=match[11],weekdayStr=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),yearStr=obsOffset?obsOffsets[obsOffset]:milOffset?0:signedOffset(offHourStr,match);return[weekdayStr,new FixedOffsetZone(yearStr)]}var rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(match){var weekdayStr=match[1],dayStr=match[2],monthStr=match[3];return[fromStrings(weekdayStr,match[4],monthStr,dayStr,match[5],match[6],match[7]),FixedOffsetZone.utcInstance]}function extractASCII(match){var weekdayStr=match[1],monthStr=match[2],dayStr=match[3],hourStr=match[4],minuteStr=match[5],secondStr=match[6];return[fromStrings(weekdayStr,match[7],monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}var isoYmdWithTimeExtensionRegex=combineRegexes(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(/(\d{4})-?(\d{3})/,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(function(match,cursor){return[{year:int(match,cursor),month:int(match,cursor+1,1),day:int(match,cursor+2,1)},null,cursor+3]},extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);var extractISOTimeOnly=combineExtractors(extractISOTime);var sqlYmdWithTimeExtensionRegex=combineRegexes(/(\d{4})-(\d\d)-(\d\d)/,s),sqlTimeCombinedRegex=combineRegexes(LuxonError),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);var l={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},casualMatrix=_extends({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},l),accurateMatrix=_extends({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},l),orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$1(dur,alts,clear){clear={values:(clear=void 0===clear?!1:clear)?alts.values:_extends({},dur.values,alts.values||{}),loc:dur.loc.clone(alts.loc),conversionAccuracy:alts.conversionAccuracy||dur.conversionAccuracy,matrix:alts.matrix||dur.matrix};return new Duration(clear)}function convert(matrix,fromMap,fromUnit,toMap,toUnit){var matrix=matrix[toUnit][fromUnit],raw=fromMap[fromUnit]/matrix,n=!(Math.sign(raw)===Math.sign(toMap[toUnit]))&&0!==toMap[toUnit]&&Math.abs(raw)<=1?(n=raw)<0?Math.floor(n):Math.ceil(n):Math.trunc(raw);toMap[toUnit]+=n,fromMap[fromUnit]-=n*matrix}var Duration=function(){function Duration(config){var accurate="longterm"===config.conversionAccuracy||!1,matrix=accurate?accurateMatrix:casualMatrix;config.matrix&&(matrix=config.matrix),this.values=config.values,this.loc=config.loc||Locale.create(),this.conversionAccuracy=accurate?"longterm":"casual",this.invalid=config.invalid||null,this.matrix=matrix,this.isLuxonDuration=!0}Duration.fromMillis=function(count,opts){return Duration.fromObject({milliseconds:count},opts)},Duration.fromObject=function(obj,opts){if(void 0===opts&&(opts={}),null==obj||"object"!=typeof obj)throw new InvalidArgumentError("Duration.fromObject: argument expected to be an object, got "+(null===obj?"null":typeof obj));return new Duration({values:normalizeObject(obj,Duration.normalizeUnit),loc:Locale.fromObject(opts),conversionAccuracy:opts.conversionAccuracy,matrix:opts.matrix})},Duration.fromDurationLike=function(durationLike){if(isNumber(durationLike))return Duration.fromMillis(durationLike);if(Duration.isDuration(durationLike))return durationLike;if("object"==typeof durationLike)return Duration.fromObject(durationLike);throw new InvalidArgumentError("Unknown duration argument "+durationLike+" of type "+typeof durationLike)},Duration.fromISO=function(text,opts){var parsed=parse(text,[isoDuration,extractISODuration])[0];return parsed?Duration.fromObject(parsed,opts):Duration.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Duration.fromISOTime=function(text,opts){var parsed=parse(text,[isoTimeOnly,extractISOTimeOnly])[0];return parsed?Duration.fromObject(parsed,opts):Duration.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Duration.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDurationError(reason);return new Duration({invalid:reason})},Duration.normalizeUnit=function(unit){var normalized={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[unit&&unit.toLowerCase()];if(normalized)return normalized;throw new InvalidUnitError(unit)},Duration.isDuration=function(o){return o&&o.isLuxonDuration||!1};var _proto=Duration.prototype;return _proto.toFormat=function(fmt,opts){opts=_extends({},opts=void 0===opts?{}:opts,{floor:!1!==opts.round&&!1!==opts.floor});return this.isValid?Formatter.create(this.loc,opts).formatDurationFromString(this,fmt):"Invalid Duration"},_proto.toHuman=function(opts){var _this=this,l=(void 0===opts&&(opts={}),orderedUnits$1.map(function(unit){var val=_this.values[unit];return void 0===val?null:_this.loc.numberFormatter(_extends({style:"unit",unitDisplay:"long"},opts,{unit:unit.slice(0,-1)})).format(val)}).filter(function(n){return n}));return this.loc.listFormatter(_extends({type:"conjunction",style:opts.listStyle||"narrow"},opts)).format(l)},_proto.toObject=function(){return this.isValid?_extends({},this.values):{}},_proto.toISO=function(){var s;return this.isValid?(s="P",0!==this.years&&(s+=this.years+"Y"),0===this.months&&0===this.quarters||(s+=this.months+3*this.quarters+"M"),0!==this.weeks&&(s+=this.weeks+"W"),0!==this.days&&(s+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(s+="T"),0!==this.hours&&(s+=this.hours+"H"),0!==this.minutes&&(s+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(s+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===s&&(s+="T0S"),s):null},_proto.toISOTime=function(opts){if(void 0===opts&&(opts={}),!this.isValid)return null;var millis=this.toMillis();if(millis<0||864e5<=millis)return null;opts=_extends({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},opts);var millis=this.shiftTo("hours","minutes","seconds","milliseconds"),fmt="basic"===opts.format?"hhmm":"hh:mm",millis=(opts.suppressSeconds&&0===millis.seconds&&0===millis.milliseconds||(fmt+="basic"===opts.format?"ss":":ss",opts.suppressMilliseconds&&0===millis.milliseconds||(fmt+=".SSS")),millis.toFormat(fmt));return millis=opts.includePrefix?"T"+millis:millis},_proto.toJSON=function(){return this.toISO()},_proto.toString=function(){return this.toISO()},_proto.toMillis=function(){return this.as("milliseconds")},_proto.valueOf=function(){return this.toMillis()},_proto.plus=function(duration){if(!this.isValid)return this;for(var dur=Duration.fromDurationLike(duration),result={},_iterator=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step=_iterator()).done;){var _step=_step.value;(hasOwnProperty(dur.values,_step)||hasOwnProperty(this.values,_step))&&(result[_step]=dur.get(_step)+this.get(_step))}return clone$1(this,{values:result},!0)},_proto.minus=function(duration){return this.isValid?(duration=Duration.fromDurationLike(duration),this.plus(duration.negate())):this},_proto.mapUnits=function(fn){if(!this.isValid)return this;for(var result={},_i=0,_Object$keys=Object.keys(this.values);_i<_Object$keys.length;_i++){var k=_Object$keys[_i];result[k]=asNumber(fn(this.values[k],k))}return clone$1(this,{values:result},!0)},_proto.get=function(unit){return this[Duration.normalizeUnit(unit)]},_proto.set=function(values){return this.isValid?clone$1(this,{values:_extends({},this.values,normalizeObject(values,Duration.normalizeUnit))}):this},_proto.reconfigure=function(_temp){var _temp=void 0===_temp?{}:_temp,locale=_temp.locale,numberingSystem=_temp.numberingSystem,conversionAccuracy=_temp.conversionAccuracy,_temp=_temp.matrix,locale=this.loc.clone({locale:locale,numberingSystem:numberingSystem});return clone$1(this,{loc:locale,matrix:_temp,conversionAccuracy:conversionAccuracy})},_proto.as=function(unit){return this.isValid?this.shiftTo(unit).get(unit):NaN},_proto.normalize=function(){var vals;return this.isValid?(vals=this.toObject(),function(matrix,vals){reverseUnits.reduce(function(previous,current){return void 0!==vals[current]?(previous&&convert(matrix,vals,previous,vals,current),current):previous},null)}(this.matrix,vals),clone$1(this,{values:vals},!0)):this},_proto.shiftTo=function(){for(var _len=arguments.length,units=new Array(_len),_key=0;_key<_len;_key++)units[_key]=arguments[_key];if(!this.isValid)return this;if(0===units.length)return this;for(var key,units=units.map(function(u){return Duration.normalizeUnit(u)}),built={},accumulated={},vals=this.toObject(),_iterator2=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step2=_iterator2()).done;){var k=_step2.value;if(0<=units.indexOf(k)){var ak,lastUnit=k,own=0;for(ak in accumulated)own+=this.matrix[ak][k]*accumulated[ak],accumulated[ak]=0;isNumber(vals[k])&&(own+=vals[k]);var down,_step2=Math.trunc(own);for(down in accumulated[k]=(1e3*own-1e3*(built[k]=_step2))/1e3,vals)orderedUnits$1.indexOf(down)>orderedUnits$1.indexOf(k)&&convert(this.matrix,vals,down,built,k)}else isNumber(vals[k])&&(accumulated[k]=vals[k])}for(key in accumulated)0!==accumulated[key]&&(built[lastUnit]+=key===lastUnit?accumulated[key]:accumulated[key]/this.matrix[lastUnit][key]);return clone$1(this,{values:built},!0).normalize()},_proto.negate=function(){if(!this.isValid)return this;for(var negated={},_i2=0,_Object$keys2=Object.keys(this.values);_i2<_Object$keys2.length;_i2++){var k=_Object$keys2[_i2];negated[k]=0===this.values[k]?0:-this.values[k]}return clone$1(this,{values:negated},!0)},_proto.equals=function(other){if(!this.isValid||!other.isValid)return!1;if(!this.loc.equals(other.loc))return!1;for(var v1,_iterator3=_createForOfIteratorHelperLoose(orderedUnits$1);!(_step3=_iterator3()).done;){var _step3=_step3.value;if(v1=this.values[_step3],_step3=other.values[_step3],!(void 0===v1||0===v1?void 0===_step3||0===_step3:v1===_step3))return!1}return!0},_createClass(Duration,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),Duration}(),INVALID$1="Invalid Interval";function validateStartEnd(start,end){return start&&start.isValid?end&&end.isValid?end<start?Interval.invalid("end before start","The end of an interval must be after its start, but you had start="+start.toISO()+" and end="+end.toISO()):null:Interval.invalid("missing or invalid end"):Interval.invalid("missing or invalid start")}var Interval=function(){function Interval(config){this.s=config.start,this.e=config.end,this.invalid=config.invalid||null,this.isLuxonInterval=!0}Interval.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidIntervalError(reason);return new Interval({invalid:reason})},Interval.fromDateTimes=function(start,end){var start=friendlyDateTime(start),end=friendlyDateTime(end),validateError=validateStartEnd(start,end);return null==validateError?new Interval({start:start,end:end}):validateError},Interval.after=function(start,duration){duration=Duration.fromDurationLike(duration),start=friendlyDateTime(start);return Interval.fromDateTimes(start,start.plus(duration))},Interval.before=function(end,duration){duration=Duration.fromDurationLike(duration),end=friendlyDateTime(end);return Interval.fromDateTimes(end.minus(duration),end)},Interval.fromISO=function(text,opts){var start,end,endIsValid,_split=(text||"").split("/",2),s=_split[0],e=_split[1];if(s&&e){try{startIsValid=(start=DateTime.fromISO(s,opts)).isValid}catch(e){startIsValid=!1}try{endIsValid=(end=DateTime.fromISO(e,opts)).isValid}catch(e){endIsValid=!1}if(startIsValid&&endIsValid)return Interval.fromDateTimes(start,end);if(startIsValid){_split=Duration.fromISO(e,opts);if(_split.isValid)return Interval.after(start,_split)}else if(endIsValid){var startIsValid=Duration.fromISO(s,opts);if(startIsValid.isValid)return Interval.before(end,startIsValid)}}return Interval.invalid("unparsable",'the input "'+text+"\" can't be parsed as ISO 8601")},Interval.isInterval=function(o){return o&&o.isLuxonInterval||!1};var _proto=Interval.prototype;return _proto.length=function(unit){return void 0===unit&&(unit="milliseconds"),this.isValid?this.toDuration.apply(this,[unit]).get(unit):NaN},_proto.count=function(unit){var start,end;return void 0===unit&&(unit="milliseconds"),this.isValid?(start=this.start.startOf(unit),end=this.end.startOf(unit),Math.floor(end.diff(start,unit).get(unit))+1):NaN},_proto.hasSame=function(unit){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,unit))},_proto.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},_proto.isAfter=function(dateTime){return!!this.isValid&&this.s>dateTime},_proto.isBefore=function(dateTime){return!!this.isValid&&this.e<=dateTime},_proto.contains=function(dateTime){return!!this.isValid&&(this.s<=dateTime&&this.e>dateTime)},_proto.set=function(_temp){var _temp=void 0===_temp?{}:_temp,start=_temp.start,_temp=_temp.end;return this.isValid?Interval.fromDateTimes(start||this.s,_temp||this.e):this},_proto.splitAt=function(){var _this=this;if(!this.isValid)return[];for(var _len=arguments.length,dateTimes=new Array(_len),_key=0;_key<_len;_key++)dateTimes[_key]=arguments[_key];for(var sorted=dateTimes.map(friendlyDateTime).filter(function(d){return _this.contains(d)}).sort(),results=[],s=this.s,i=0;s<this.e;){var added=sorted[i]||this.e,added=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,added)),s=added,i+=1}return results},_proto.splitBy=function(duration){var dur=Duration.fromDurationLike(duration);if(!this.isValid||!dur.isValid||0===dur.as("milliseconds"))return[];for(var s=this.s,idx=1,results=[];s<this.e;){var added=this.start.plus(dur.mapUnits(function(x){return x*idx})),added=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,added)),s=added,idx+=1}return results},_proto.divideEqually=function(numberOfParts){return this.isValid?this.splitBy(this.length()/numberOfParts).slice(0,numberOfParts):[]},_proto.overlaps=function(other){return this.e>other.s&&this.s<other.e},_proto.abutsStart=function(other){return!!this.isValid&&+this.e==+other.s},_proto.abutsEnd=function(other){return!!this.isValid&&+other.e==+this.s},_proto.engulfs=function(other){return!!this.isValid&&(this.s<=other.s&&this.e>=other.e)},_proto.equals=function(other){return!(!this.isValid||!other.isValid)&&(this.s.equals(other.s)&&this.e.equals(other.e))},_proto.intersection=function(other){var s;return this.isValid?(s=(this.s>other.s?this:other).s,(other=(this.e<other.e?this:other).e)<=s?null:Interval.fromDateTimes(s,other)):this},_proto.union=function(other){var s;return this.isValid?(s=(this.s<other.s?this:other).s,other=(this.e>other.e?this:other).e,Interval.fromDateTimes(s,other)):this},Interval.merge=function(intervals){var intervals=intervals.sort(function(a,b){return a.s-b.s}).reduce(function(_ref2,item){var sofar=_ref2[0],_ref2=_ref2[1];return _ref2?_ref2.overlaps(item)||_ref2.abutsStart(item)?[sofar,_ref2.union(item)]:[sofar.concat([_ref2]),item]:[sofar,item]},[[],null]),found=intervals[0],intervals=intervals[1];return intervals&&found.push(intervals),found},Interval.xor=function(intervals){for(var _Array$prototype,start=null,currentCount=0,results=[],intervals=intervals.map(function(i){return[{time:i.s,type:"s"},{time:i.e,type:"e"}]}),_iterator=_createForOfIteratorHelperLoose((_Array$prototype=Array.prototype).concat.apply(_Array$prototype,intervals).sort(function(a,b){return a.time-b.time}));!(_step=_iterator()).done;)var _step=_step.value,start=1===(currentCount+="s"===_step.type?1:-1)?_step.time:(start&&+start!=+_step.time&&results.push(Interval.fromDateTimes(start,_step.time)),null);return Interval.merge(results)},_proto.difference=function(){for(var _this2=this,_len2=arguments.length,intervals=new Array(_len2),_key2=0;_key2<_len2;_key2++)intervals[_key2]=arguments[_key2];return Interval.xor([this].concat(intervals)).map(function(i){return _this2.intersection(i)}).filter(function(i){return i&&!i.isEmpty()})},_proto.toString=function(){return this.isValid?"["+this.s.toISO()+" – "+this.e.toISO()+")":INVALID$1},_proto.toISO=function(opts){return this.isValid?this.s.toISO(opts)+"/"+this.e.toISO(opts):INVALID$1},_proto.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():INVALID$1},_proto.toISOTime=function(opts){return this.isValid?this.s.toISOTime(opts)+"/"+this.e.toISOTime(opts):INVALID$1},_proto.toFormat=function(dateFormat,_temp2){_temp2=(void 0===_temp2?{}:_temp2).separator,_temp2=void 0===_temp2?" – ":_temp2;return this.isValid?""+this.s.toFormat(dateFormat)+_temp2+this.e.toFormat(dateFormat):INVALID$1},_proto.toDuration=function(unit,opts){return this.isValid?this.e.diff(this.s,unit,opts):Duration.invalid(this.invalidReason)},_proto.mapEndpoints=function(mapFn){return Interval.fromDateTimes(mapFn(this.s),mapFn(this.e))},_createClass(Interval,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),Interval}(),Info=function(){function Info(){}return Info.hasDST=function(zone){void 0===zone&&(zone=Settings.defaultZone);var proto=DateTime.now().setZone(zone).set({month:12});return!zone.isUniversal&&proto.offset!==proto.set({month:6}).offset},Info.isValidIANAZone=function(zone){return IANAZone.isValidZone(zone)},Info.normalizeZone=function(input){return normalizeZone(input,Settings.defaultZone)},Info.months=function(length,_temp){void 0===length&&(length="long");var _temp=void 0===_temp?{}:_temp,_ref$locale=_temp.locale,_ref$numberingSystem=_temp.numberingSystem,_ref$locObj=_temp.locObj,_ref$locObj=void 0===_ref$locObj?null:_ref$locObj,_temp=_temp.outputCalendar;return(_ref$locObj||Locale.create(void 0===_ref$locale?null:_ref$locale,void 0===_ref$numberingSystem?null:_ref$numberingSystem,void 0===_temp?"gregory":_temp)).months(length)},Info.monthsFormat=function(length,_temp2){void 0===length&&(length="long");var _temp2=void 0===_temp2?{}:_temp2,_ref2$locale=_temp2.locale,_ref2$numberingSystem=_temp2.numberingSystem,_ref2$locObj=_temp2.locObj,_ref2$locObj=void 0===_ref2$locObj?null:_ref2$locObj,_temp2=_temp2.outputCalendar;return(_ref2$locObj||Locale.create(void 0===_ref2$locale?null:_ref2$locale,void 0===_ref2$numberingSystem?null:_ref2$numberingSystem,void 0===_temp2?"gregory":_temp2)).months(length,!0)},Info.weekdays=function(length,_temp3){void 0===length&&(length="long");var _temp3=void 0===_temp3?{}:_temp3,_ref3$locale=_temp3.locale,_ref3$numberingSystem=_temp3.numberingSystem,_temp3=_temp3.locObj;return((void 0===_temp3?null:_temp3)||Locale.create(void 0===_ref3$locale?null:_ref3$locale,void 0===_ref3$numberingSystem?null:_ref3$numberingSystem,null)).weekdays(length)},Info.weekdaysFormat=function(length,_temp4){void 0===length&&(length="long");var _temp4=void 0===_temp4?{}:_temp4,_ref4$locale=_temp4.locale,_ref4$numberingSystem=_temp4.numberingSystem,_temp4=_temp4.locObj;return((void 0===_temp4?null:_temp4)||Locale.create(void 0===_ref4$locale?null:_ref4$locale,void 0===_ref4$numberingSystem?null:_ref4$numberingSystem,null)).weekdays(length,!0)},Info.meridiems=function(_temp5){_temp5=(void 0===_temp5?{}:_temp5).locale;return Locale.create(void 0===_temp5?null:_temp5).meridiems()},Info.eras=function(length,_temp6){void 0===length&&(length="short");_temp6=(void 0===_temp6?{}:_temp6).locale;return Locale.create(void 0===_temp6?null:_temp6,null,"gregory").eras(length)},Info.features=function(){return{relative:hasRelative()}},Info}();function dayDiff(earlier,later){function utcDayStart(dt){return dt.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()}later=utcDayStart(later)-utcDayStart(earlier);return Math.floor(Duration.fromMillis(later).as("days"))}function _diff(earlier,later,units,opts){var earlier=function(cursor,later,units){for(var results={},_i=0,_differs=[["years",function(a,b){return b.year-a.year}],["quarters",function(a,b){return b.quarter-a.quarter+4*(b.year-a.year)}],["months",function(a,b){return b.month-a.month+12*(b.year-a.year)}],["weeks",function(a,b){a=dayDiff(a,b);return(a-a%7)/7}],["days",dayDiff]];_i<_differs.length;_i++){var lowestOrder,_cursor$plus,highWater,_differs$_i=_differs[_i],unit=_differs$_i[0],_differs$_i=_differs$_i[1];0<=units.indexOf(unit)&&(lowestOrder=unit,_differs$_i=_differs$_i(cursor,later),later<(highWater=cursor.plus(((_cursor$plus={})[unit]=_differs$_i,_cursor$plus)))?(cursor=cursor.plus(((_cursor$plus={})[unit]=_differs$_i-1,_cursor$plus)),--_differs$_i):cursor=highWater,results[unit]=_differs$_i)}return[cursor,results,highWater,lowestOrder]}(earlier,later,units),cursor=earlier[0],results=earlier[1],highWater=earlier[2],earlier=earlier[3],remainingMillis=later-cursor,units=units.filter(function(u){return 0<=["hours","minutes","seconds","milliseconds"].indexOf(u)}),later=(0===units.length&&(highWater=highWater<later?cursor.plus(((later={})[earlier]=1,later)):highWater)!==cursor&&(results[earlier]=(results[earlier]||0)+remainingMillis/(highWater-cursor)),Duration.fromObject(results,opts));return 0<units.length?(earlier=Duration.fromMillis(remainingMillis,opts)).shiftTo.apply(earlier,units).plus(later):later}var numberingSystems={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function digitRegex(_ref,append){_ref=_ref.numberingSystem;return void 0===append&&(append=""),new RegExp(""+numberingSystems[_ref||"latn"]+append)}var MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(regex,post){return void 0===post&&(post=function(i){return i}),{regex:regex,deser:function(_ref){_ref=_ref[0];return post(function(str){var value=parseInt(str,10);if(isNaN(value)){for(var value="",i=0;i<str.length;i++){var code=str.charCodeAt(i);if(-1!==str[i].search(numberingSystems.hanidec))value+=hanidecChars.indexOf(str[i]);else for(var key in numberingSystemsUTF16){var key=numberingSystemsUTF16[key],min=key[0],key=key[1];min<=code&&code<=key&&(value+=code-min)}}return parseInt(value,10)}return value}(_ref))}}}var spaceOrNBSP="[ "+String.fromCharCode(160)+"]",spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(s){return s.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(s){return s.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(strings,startIndex){return null===strings?null:{regex:RegExp(strings.map(fixListRegex).join("|")),deser:function(_ref2){var s=_ref2[0];return strings.findIndex(function(i){return stripInsensitivities(s)===stripInsensitivities(i)})+startIndex}}}function offset(regex,groups){return{regex:regex,deser:function(_ref3){return signedOffset(_ref3[1],_ref3[2])},groups:groups}}function simple(regex){return{regex:regex,deser:function(_ref4){return _ref4[0]}}}function unitForToken(token,loc){function literal(t){return{regex:RegExp(t.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")),deser:function(_ref5){return _ref5[0]},literal:!0}}var one=digitRegex(loc),two=digitRegex(loc,"{2}"),three=digitRegex(loc,"{3}"),four=digitRegex(loc,"{4}"),six=digitRegex(loc,"{6}"),oneOrTwo=digitRegex(loc,"{1,2}"),oneToThree=digitRegex(loc,"{1,3}"),oneToSix=digitRegex(loc,"{1,6}"),oneToNine=digitRegex(loc,"{1,9}"),twoToFour=digitRegex(loc,"{2,4}"),fourToSix=digitRegex(loc,"{4,6}"),unit=function(t){if(token.literal)return literal(t);switch(t.val){case"G":return oneOf(loc.eras("short",!1),0);case"GG":return oneOf(loc.eras("long",!1),0);case"y":return intUnit(oneToSix);case"yy":return intUnit(twoToFour,untruncateYear);case"yyyy":return intUnit(four);case"yyyyy":return intUnit(fourToSix);case"yyyyyy":return intUnit(six);case"M":return intUnit(oneOrTwo);case"MM":return intUnit(two);case"MMM":return oneOf(loc.months("short",!0,!1),1);case"MMMM":return oneOf(loc.months("long",!0,!1),1);case"L":return intUnit(oneOrTwo);case"LL":return intUnit(two);case"LLL":return oneOf(loc.months("short",!1,!1),1);case"LLLL":return oneOf(loc.months("long",!1,!1),1);case"d":return intUnit(oneOrTwo);case"dd":return intUnit(two);case"o":return intUnit(oneToThree);case"ooo":return intUnit(three);case"HH":return intUnit(two);case"H":return intUnit(oneOrTwo);case"hh":return intUnit(two);case"h":return intUnit(oneOrTwo);case"mm":return intUnit(two);case"m":case"q":return intUnit(oneOrTwo);case"qq":return intUnit(two);case"s":return intUnit(oneOrTwo);case"ss":return intUnit(two);case"S":return intUnit(oneToThree);case"SSS":return intUnit(three);case"u":return simple(oneToNine);case"uu":return simple(oneOrTwo);case"uuu":return intUnit(one);case"a":return oneOf(loc.meridiems(),0);case"kkkk":return intUnit(four);case"kk":return intUnit(twoToFour,untruncateYear);case"W":return intUnit(oneOrTwo);case"WW":return intUnit(two);case"E":case"c":return intUnit(one);case"EEE":return oneOf(loc.weekdays("short",!1,!1),1);case"EEEE":return oneOf(loc.weekdays("long",!1,!1),1);case"ccc":return oneOf(loc.weekdays("short",!0,!1),1);case"cccc":return oneOf(loc.weekdays("long",!0,!1),1);case"Z":case"ZZ":return offset(new RegExp("([+-]"+oneOrTwo.source+")(?::("+two.source+"))?"),2);case"ZZZ":return offset(new RegExp("([+-]"+oneOrTwo.source+")("+two.source+")?"),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);default:return literal(t)}}(token)||{invalidReason:MISSING_FTP};return unit.token=token,unit}var partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};var dummyDateTimeCache=null;function expandMacroTokens(tokens,locale){var _Array$prototype;return(_Array$prototype=Array.prototype).concat.apply(_Array$prototype,tokens.map(function(t){return function(token,locale){return token.literal||null==(locale=formatOptsToTokens(Formatter.macroTokenToFormatOpts(token.val),locale))||locale.includes(void 0)?token:locale}(t,locale)}))}function explainFromTokens(locale,input,format){var format=expandMacroTokens(Formatter.parseFormat(format),locale),units=format.map(function(t){return unitForToken(t,locale)}),disqualifyingUnit=units.find(function(t){return t.invalidReason});if(disqualifyingUnit)return{input:input,tokens:format,invalidReason:disqualifyingUnit.invalidReason};var disqualifyingUnit=function(units){return["^"+units.map(function(u){return u.regex}).reduce(function(f,r){return f+"("+r.source+")"},"")+"$",units]}(units),units=disqualifyingUnit[0],disqualifyingUnit=disqualifyingUnit[1],units=RegExp(units,"i"),disqualifyingUnit=function(input,regex,handlers){var matches=input.match(regex);if(matches){var i,h,groups,all={},matchIndex=1;for(i in handlers)hasOwnProperty(handlers,i)&&(groups=(h=handlers[i]).groups?h.groups+1:1,!h.literal&&h.token&&(all[h.token.val[0]]=h.deser(matches.slice(matchIndex,matchIndex+groups))),matchIndex+=groups);return[matches,all]}return[matches,{}]}(input,units,disqualifyingUnit),rawMatches=disqualifyingUnit[0],disqualifyingUnit=disqualifyingUnit[1],_ref6=disqualifyingUnit?function(matches){var specificOffset,zone=null;return void 0!==matches.z&&(zone=IANAZone.create(matches.z)),void 0!==matches.Z&&(zone=zone||new FixedOffsetZone(matches.Z),specificOffset=matches.Z),void 0!==matches.q&&(matches.M=3*(matches.q-1)+1),void 0!==matches.h&&(matches.h<12&&1===matches.a?matches.h+=12:12===matches.h&&0===matches.a&&(matches.h=0)),0===matches.G&&matches.y&&(matches.y=-matches.y),void 0!==matches.u&&(matches.S=parseMillis(matches.u)),[Object.keys(matches).reduce(function(r,k){var f=function(token){switch(token){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(k);return f&&(r[f]=matches[k]),r},{}),zone,specificOffset]}(disqualifyingUnit):[null,null,void 0],result=_ref6[0],zone=_ref6[1],_ref6=_ref6[2];if(hasOwnProperty(disqualifyingUnit,"a")&&hasOwnProperty(disqualifyingUnit,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:input,tokens:format,regex:units,rawMatches:rawMatches,matches:disqualifyingUnit,result:result,zone:zone,specificOffset:_ref6}}function formatOptsToTokens(formatOpts,locale){return formatOpts?Formatter.create(locale,formatOpts).formatDateTimeParts(dummyDateTimeCache=dummyDateTimeCache||DateTime.fromMillis(1555555555555)).map(function(p){return function(part,formatOpts){var type=part.type,part=part.value;return"literal"===type?{literal:!0,val:part}:(part=formatOpts[type],(formatOpts="object"==typeof(formatOpts=partTypeStyleToTokenVal[type])?formatOpts[part]:formatOpts)?{literal:!1,val:formatOpts}:void 0)}(p,formatOpts)}):null}var nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(unit,value){return new Invalid("unit out of range","you specified "+value+" (of type "+typeof value+") as a "+unit+", which is invalid")}function dayOfWeek(year,month,day){month=new Date(Date.UTC(year,month-1,day)),year<100&&0<=year&&month.setUTCFullYear(month.getUTCFullYear()-1900),day=month.getUTCDay();return 0===day?7:day}function computeOrdinal(year,month,day){return day+(isLeapYear(year)?leapLadder:nonLeapLadder)[month-1]}function uncomputeOrdinal(year,ordinal){var year=isLeapYear(year)?leapLadder:nonLeapLadder,month0=year.findIndex(function(i){return i<ordinal});return{month:month0+1,day:ordinal-year[month0]}}function gregorianToWeek(gregObj){var weekYear,year=gregObj.year,month=gregObj.month,day=gregObj.day,ordinal=computeOrdinal(year,month,day),month=dayOfWeek(year,month,day),day=Math.floor((ordinal-month+10)/7);return day<1?day=weeksInWeekYear(weekYear=year-1):day>weeksInWeekYear(year)?(weekYear=year+1,day=1):weekYear=year,_extends({weekYear:weekYear,weekNumber:day,weekday:month},timeObject(gregObj))}function weekToGregorian(weekData){var year,weekYear=weekData.weekYear,weekNumber=weekData.weekNumber,weekday=weekData.weekday,weekdayOfJan4=dayOfWeek(weekYear,1,4),yearInDays=daysInYear(weekYear),weekNumber=7*weekNumber+weekday-weekdayOfJan4-3,weekday=(weekNumber<1?weekNumber+=daysInYear(year=weekYear-1):yearInDays<weekNumber?(year=weekYear+1,weekNumber-=daysInYear(weekYear)):year=weekYear,uncomputeOrdinal(year,weekNumber));return _extends({year:year,month:weekday.month,day:weekday.day},timeObject(weekData))}function gregorianToOrdinal(gregData){var year=gregData.year;return _extends({year:year,ordinal:computeOrdinal(year,gregData.month,gregData.day)},timeObject(gregData))}function ordinalToGregorian(ordinalData){var year=ordinalData.year,_uncomputeOrdinal2=uncomputeOrdinal(year,ordinalData.ordinal);return _extends({year:year,month:_uncomputeOrdinal2.month,day:_uncomputeOrdinal2.day},timeObject(ordinalData))}function hasInvalidGregorianData(obj){var validYear=isInteger(obj.year),validMonth=integerBetween(obj.month,1,12),validDay=integerBetween(obj.day,1,daysInMonth(obj.year,obj.month));return validYear?validMonth?!validDay&&unitOutOfRange("day",obj.day):unitOutOfRange("month",obj.month):unitOutOfRange("year",obj.year)}function hasInvalidTimeData(obj){var hour=obj.hour,minute=obj.minute,second=obj.second,obj=obj.millisecond,validHour=integerBetween(hour,0,23)||24===hour&&0===minute&&0===second&&0===obj,validMinute=integerBetween(minute,0,59),validSecond=integerBetween(second,0,59),validMillisecond=integerBetween(obj,0,999);return validHour?validMinute?validSecond?!validMillisecond&&unitOutOfRange("millisecond",obj):unitOutOfRange("second",second):unitOutOfRange("minute",minute):unitOutOfRange("hour",hour)}var INVALID="Invalid DateTime";function unsupportedZone(zone){return new Invalid("unsupported zone",'the zone "'+zone.name+'" is not supported')}function possiblyCachedWeekData(dt){return null===dt.weekData&&(dt.weekData=gregorianToWeek(dt.c)),dt.weekData}function clone(inst,alts){inst={ts:inst.ts,zone:inst.zone,c:inst.c,o:inst.o,loc:inst.loc,invalid:inst.invalid};return new DateTime(_extends({},inst,alts,{old:inst}))}function fixOffset(localTS,o,tz){var utcGuess=localTS-60*o*1e3,o2=tz.offset(utcGuess);return o===o2?[utcGuess,o]:o2===(tz=tz.offset(utcGuess-=60*(o2-o)*1e3))?[utcGuess,o2]:[localTS-60*Math.min(o2,tz)*1e3,Math.max(o2,tz)]}function tsToObj(ts,offset){ts+=60*offset*1e3;offset=new Date(ts);return{year:offset.getUTCFullYear(),month:offset.getUTCMonth()+1,day:offset.getUTCDate(),hour:offset.getUTCHours(),minute:offset.getUTCMinutes(),second:offset.getUTCSeconds(),millisecond:offset.getUTCMilliseconds()}}function objToTS(obj,offset,zone){return fixOffset(objToLocalTS(obj),offset,zone)}function adjustTime(inst,dur){var oPre=inst.o,year=inst.c.year+Math.trunc(dur.years),month=inst.c.month+Math.trunc(dur.months)+3*Math.trunc(dur.quarters),year=_extends({},inst.c,{year:year,month:month,day:Math.min(inst.c.day,daysInMonth(year,month))+Math.trunc(dur.days)+7*Math.trunc(dur.weeks)}),month=Duration.fromObject({years:dur.years-Math.trunc(dur.years),quarters:dur.quarters-Math.trunc(dur.quarters),months:dur.months-Math.trunc(dur.months),weeks:dur.weeks-Math.trunc(dur.weeks),days:dur.days-Math.trunc(dur.days),hours:dur.hours,minutes:dur.minutes,seconds:dur.seconds,milliseconds:dur.milliseconds}).as("milliseconds"),dur=fixOffset(objToLocalTS(year),oPre,inst.zone),year=dur[0],oPre=dur[1];return 0!==month&&(oPre=inst.zone.offset(year+=month)),{ts:year,o:oPre}}function parseDataToDateTime(parsed,parsedZone,opts,format,text,specificOffset){var setZone=opts.setZone,zone=opts.zone;return parsed&&0!==Object.keys(parsed).length?(parsed=DateTime.fromObject(parsed,_extends({},opts,{zone:parsedZone||zone,specificOffset:specificOffset})),setZone?parsed:parsed.setZone(zone)):DateTime.invalid(new Invalid("unparsable",'the input "'+text+"\" can't be parsed as "+format))}function toTechFormat(dt,format,allowZ){return void 0===allowZ&&(allowZ=!0),dt.isValid?Formatter.create(Locale.create("en-US"),{allowZ:allowZ,forceSimple:!0}).formatDateTimeFromString(dt,format):null}function _toISODate(o,extended){var longFormat=9999<o.c.year||o.c.year<0,c="";return longFormat&&0<=o.c.year&&(c+="+"),c+=padStart(o.c.year,longFormat?6:4),c=extended?(c=(c+="-")+padStart(o.c.month)+"-")+padStart(o.c.day):(c+=padStart(o.c.month))+padStart(o.c.day)}function _toISOTime(o,extended,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone){var c=padStart(o.c.hour);return extended?(c=(c+=":")+padStart(o.c.minute),0===o.c.second&&suppressSeconds||(c+=":")):c+=padStart(o.c.minute),0===o.c.second&&suppressSeconds||(c+=padStart(o.c.second),0===o.c.millisecond&&suppressMilliseconds||(c=(c+=".")+padStart(o.c.millisecond,3))),includeOffset&&(o.isOffsetFixed&&0===o.offset&&!extendedZone?c+="Z":c=o.o<0?(c=(c+="-")+padStart(Math.trunc(-o.o/60))+":")+padStart(Math.trunc(-o.o%60)):(c=(c+="+")+padStart(Math.trunc(o.o/60))+":")+padStart(Math.trunc(o.o%60))),extendedZone&&(c+="["+o.zone.ianaName+"]"),c}var defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(unit){var normalized={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[unit.toLowerCase()];if(normalized)return normalized;throw new InvalidUnitError(unit)}function quickDT(obj,opts){var zone=normalizeZone(opts.zone,Settings.defaultZone),opts=Locale.fromObject(opts),tsNow=Settings.now();if(void 0!==obj.year){for(var _iterator=_createForOfIteratorHelperLoose(orderedUnits);!(_step=_iterator()).done;){var _step=_step.value;void 0===obj[_step]&&(obj[_step]=defaultUnitValues[_step])}var invalid=hasInvalidGregorianData(obj)||hasInvalidTimeData(obj);if(invalid)return DateTime.invalid(invalid);var invalid=objToTS(obj,zone.offset(tsNow),zone),ts=invalid[0],invalid=invalid[1]}else ts=tsNow;return new DateTime({ts:ts,zone:zone,loc:opts,o:invalid})}function diffRelative(start,end,opts){function format(c,unit){return c=roundTo(c,round||opts.calendary?0:2,!0),end.loc.clone(opts).relFormatter(opts).format(c,unit)}function differ(unit){return opts.calendary?end.hasSame(start,unit)?0:end.startOf(unit).diff(start.startOf(unit),unit).get(unit):end.diff(start,unit).get(unit)}var round=void 0===opts.round||opts.round;if(opts.unit)return format(differ(opts.unit),opts.unit);for(var _iterator2=_createForOfIteratorHelperLoose(opts.units);!(_step2=_iterator2()).done;){var _step2=_step2.value,count=differ(_step2);if(1<=Math.abs(count))return format(count,_step2)}return format(end<start?-0:0,opts.units[opts.units.length-1])}function lastOpts(argList){var opts={},argList=0<argList.length&&"object"==typeof argList[argList.length-1]?(opts=argList[argList.length-1],Array.from(argList).slice(0,argList.length-1)):Array.from(argList);return[opts,argList]}var DateTime=function(){function DateTime(config){var _ref,zone=config.zone||Settings.defaultZone,invalid=config.invalid||(Number.isNaN(config.ts)?new Invalid("invalid input"):null)||(zone.isValid?null:unsupportedZone(zone)),c=(this.ts=void 0===config.ts?Settings.now():config.ts,null),o=null;invalid||(o=config.old&&config.old.ts===this.ts&&config.old.zone.equals(zone)?(c=(_ref=[config.old.c,config.old.o])[0],_ref[1]):(_ref=zone.offset(this.ts),c=tsToObj(this.ts,_ref),c=(invalid=Number.isNaN(c.year)?new Invalid("invalid input"):null)?null:c,invalid?null:_ref)),this._zone=zone,this.loc=config.loc||Locale.create(),this.invalid=invalid,this.weekData=null,this.c=c,this.o=o,this.isLuxonDateTime=!0}DateTime.now=function(){return new DateTime({})},DateTime.local=function(){var _lastOpts=lastOpts(arguments),opts=_lastOpts[0],_lastOpts=_lastOpts[1];return quickDT({year:_lastOpts[0],month:_lastOpts[1],day:_lastOpts[2],hour:_lastOpts[3],minute:_lastOpts[4],second:_lastOpts[5],millisecond:_lastOpts[6]},opts)},DateTime.utc=function(){var _lastOpts2=lastOpts(arguments),opts=_lastOpts2[0],_lastOpts2=_lastOpts2[1],year=_lastOpts2[0],month=_lastOpts2[1],day=_lastOpts2[2],hour=_lastOpts2[3],minute=_lastOpts2[4],second=_lastOpts2[5],_lastOpts2=_lastOpts2[6];return opts.zone=FixedOffsetZone.utcInstance,quickDT({year:year,month:month,day:day,hour:hour,minute:minute,second:second,millisecond:_lastOpts2},opts)},DateTime.fromJSDate=function(date,options){void 0===options&&(options={});var zoneToUse,date="[object Date]"===Object.prototype.toString.call(date)?date.valueOf():NaN;return Number.isNaN(date)?DateTime.invalid("invalid input"):(zoneToUse=normalizeZone(options.zone,Settings.defaultZone)).isValid?new DateTime({ts:date,zone:zoneToUse,loc:Locale.fromObject(options)}):DateTime.invalid(unsupportedZone(zoneToUse))},DateTime.fromMillis=function(milliseconds,options){if(void 0===options&&(options={}),isNumber(milliseconds))return milliseconds<-864e13||864e13<milliseconds?DateTime.invalid("Timestamp out of range"):new DateTime({ts:milliseconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromMillis requires a numerical input, but received a "+typeof milliseconds+" with value "+milliseconds)},DateTime.fromSeconds=function(seconds,options){if(void 0===options&&(options={}),isNumber(seconds))return new DateTime({ts:1e3*seconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromSeconds requires a numerical input")},DateTime.fromObject=function(obj,opts){obj=obj||{};var zoneToUse=normalizeZone((opts=void 0===opts?{}:opts).zone,Settings.defaultZone);if(!zoneToUse.isValid)return DateTime.invalid(unsupportedZone(zoneToUse));var tsNow=Settings.now(),offsetProvis=void 0!==opts.specificOffset?opts.specificOffset:zoneToUse.offset(tsNow),normalized=normalizeObject(obj,normalizeUnit),containsOrdinal=!(void 0===normalized.ordinal),containsGregorYear=!(void 0===normalized.year),containsGregorMD=!(void 0===normalized.month&&void 0===normalized.day),containsGregorYear=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber,opts=Locale.fromObject(opts);if((containsGregorYear||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");for(var defaultValues,containsGregorMD=definiteWeekDef||normalized.weekday&&!containsGregorYear,objNow=tsToObj(tsNow,offsetProvis),foundFirst=(containsGregorMD?(units=orderedWeekUnits,defaultValues=defaultWeekUnitValues,objNow=gregorianToWeek(objNow)):containsOrdinal?(units=orderedOrdinalUnits,defaultValues=defaultOrdinalUnitValues,objNow=gregorianToOrdinal(objNow)):(units=orderedUnits,defaultValues=defaultUnitValues),!1),_iterator3=_createForOfIteratorHelperLoose(units);!(_step3=_iterator3()).done;){var _step3=_step3.value;void 0!==normalized[_step3]?foundFirst=!0:normalized[_step3]=(foundFirst?defaultValues:objNow)[_step3]}var units,definiteWeekDef=(containsGregorMD?function(obj){var validYear=isInteger(obj.weekYear),validWeek=integerBetween(obj.weekNumber,1,weeksInWeekYear(obj.weekYear)),validWeekday=integerBetween(obj.weekday,1,7);return validYear?validWeek?!validWeekday&&unitOutOfRange("weekday",obj.weekday):unitOutOfRange("week",obj.week):unitOutOfRange("weekYear",obj.weekYear)}:containsOrdinal?function(obj){var validYear=isInteger(obj.year),validOrdinal=integerBetween(obj.ordinal,1,daysInYear(obj.year));return validYear?!validOrdinal&&unitOutOfRange("ordinal",obj.ordinal):unitOutOfRange("year",obj.year)}:hasInvalidGregorianData)(normalized)||hasInvalidTimeData(normalized);return definiteWeekDef?DateTime.invalid(definiteWeekDef):(units=new DateTime({ts:(tsNow=objToTS(containsGregorMD?weekToGregorian(normalized):containsOrdinal?ordinalToGregorian(normalized):normalized,offsetProvis,zoneToUse))[0],zone:zoneToUse,o:tsNow[1],loc:opts}),normalized.weekday&&containsGregorYear&&obj.weekday!==units.weekday?DateTime.invalid("mismatched weekday","you can't specify both a weekday of "+normalized.weekday+" and a date of "+units.toISO()):units)},DateTime.fromISO=function(text,opts){void 0===opts&&(opts={});var _parseISODate=parse(text,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset]);return parseDataToDateTime(_parseISODate[0],_parseISODate[1],opts,"ISO 8601",text)},DateTime.fromRFC2822=function(text,opts){void 0===opts&&(opts={});var _parseRFC2822Date=parse(text.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[rfc2822,extractRFC2822]);return parseDataToDateTime(_parseRFC2822Date[0],_parseRFC2822Date[1],opts,"RFC 2822",text)},DateTime.fromHTTP=function(text,opts){void 0===opts&&(opts={});text=parse(text,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII]);return parseDataToDateTime(text[0],text[1],opts,"HTTP",opts)},DateTime.fromFormat=function(text,fmt,opts){if(void 0===opts&&(opts={}),void 0===text||void 0===fmt)throw new InvalidArgumentError("fromFormat requires an input string and a format");var _opts=opts,_opts$locale=_opts.locale,_opts=_opts.numberingSystem,_opts$locale=function(locale,input,format){return[(locale=explainFromTokens(locale,input,format)).result,locale.zone,locale.specificOffset,locale.invalidReason]}(Locale.fromOpts({locale:void 0===_opts$locale?null:_opts$locale,numberingSystem:void 0===_opts?null:_opts,defaultToEN:!0}),text,fmt),_opts=_opts$locale[0],parsedZone=_opts$locale[1],specificOffset=_opts$locale[2],_opts$locale=_opts$locale[3];return _opts$locale?DateTime.invalid(_opts$locale):parseDataToDateTime(_opts,parsedZone,opts,"format "+fmt,text,specificOffset)},DateTime.fromString=function(text,fmt,opts){return DateTime.fromFormat(text,fmt,opts=void 0===opts?{}:opts)},DateTime.fromSQL=function(text,opts){void 0===opts&&(opts={});var _parseSQL=parse(text,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone]);return parseDataToDateTime(_parseSQL[0],_parseSQL[1],opts,"SQL",text)},DateTime.invalid=function(reason,explanation){if(void 0===explanation&&(explanation=null),!reason)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");reason=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(reason);return new DateTime({invalid:reason})},DateTime.isDateTime=function(o){return o&&o.isLuxonDateTime||!1},DateTime.parseFormatForOpts=function(formatOpts,localeOpts){formatOpts=formatOptsToTokens(formatOpts,Locale.fromObject(localeOpts=void 0===localeOpts?{}:localeOpts));return formatOpts?formatOpts.map(function(t){return t?t.val:null}).join(""):null},DateTime.expandFormat=function(fmt,localeOpts){return void 0===localeOpts&&(localeOpts={}),expandMacroTokens(Formatter.parseFormat(fmt),Locale.fromObject(localeOpts)).map(function(t){return t.val}).join("")};var _proto=DateTime.prototype;return _proto.get=function(unit){return this[unit]},_proto.resolvedLocaleOptions=function(opts){opts=Formatter.create(this.loc.clone(opts=void 0===opts?{}:opts),opts).resolvedOptions(this);return{locale:opts.locale,numberingSystem:opts.numberingSystem,outputCalendar:opts.calendar}},_proto.toUTC=function(offset,opts){return void 0===opts&&(opts={}),this.setZone(FixedOffsetZone.instance(offset=void 0===offset?0:offset),opts)},_proto.toLocal=function(){return this.setZone(Settings.defaultZone)},_proto.setZone=function(zone,_temp){var newTS,_temp=void 0===_temp?{}:_temp,_ref2$keepLocalTime=_temp.keepLocalTime,_ref2$keepLocalTime=void 0!==_ref2$keepLocalTime&&_ref2$keepLocalTime,_temp=_temp.keepCalendarTime,_temp=void 0!==_temp&&_temp;return(zone=normalizeZone(zone,Settings.defaultZone)).equals(this.zone)?this:zone.isValid?(newTS=this.ts,(_ref2$keepLocalTime||_temp)&&(_ref2$keepLocalTime=zone.offset(this.ts),newTS=objToTS(this.toObject(),_ref2$keepLocalTime,zone)[0]),clone(this,{ts:newTS,zone:zone})):DateTime.invalid(unsupportedZone(zone))},_proto.reconfigure=function(_temp2){var _temp2=void 0===_temp2?{}:_temp2,locale=_temp2.locale,numberingSystem=_temp2.numberingSystem,_temp2=_temp2.outputCalendar,locale=this.loc.clone({locale:locale,numberingSystem:numberingSystem,outputCalendar:_temp2});return clone(this,{loc:locale})},_proto.setLocale=function(locale){return this.reconfigure({locale:locale})},_proto.set=function(values){if(!this.isValid)return this;var mixed,values=normalizeObject(values,normalizeUnit),settingWeekStuff=!(void 0===values.weekYear&&void 0===values.weekNumber&&void 0===values.weekday),containsOrdinal=!(void 0===values.ordinal),containsGregorYear=!(void 0===values.year),containsGregorMD=!(void 0===values.month&&void 0===values.day),definiteWeekDef=values.weekYear||values.weekNumber;if((containsGregorYear||containsGregorMD||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");settingWeekStuff?mixed=weekToGregorian(_extends({},gregorianToWeek(this.c),values)):void 0!==values.ordinal?mixed=ordinalToGregorian(_extends({},gregorianToOrdinal(this.c),values)):(mixed=_extends({},this.toObject(),values),void 0===values.day&&(mixed.day=Math.min(daysInMonth(mixed.year,mixed.month),mixed.day)));containsGregorYear=objToTS(mixed,this.o,this.zone);return clone(this,{ts:containsGregorYear[0],o:containsGregorYear[1]})},_proto.plus=function(duration){return this.isValid?clone(this,adjustTime(this,Duration.fromDurationLike(duration))):this},_proto.minus=function(duration){return this.isValid?clone(this,adjustTime(this,Duration.fromDurationLike(duration).negate())):this},_proto.startOf=function(unit){if(!this.isValid)return this;var o={},unit=Duration.normalizeUnit(unit);switch(unit){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0}return"weeks"===unit&&(o.weekday=1),"quarters"===unit&&(unit=Math.ceil(this.month/3),o.month=3*(unit-1)+1),this.set(o)},_proto.endOf=function(unit){var _this$plus;return this.isValid?this.plus(((_this$plus={})[unit]=1,_this$plus)).startOf(unit).minus(1):this},_proto.toFormat=function(fmt,opts){return void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this,fmt):INVALID},_proto.toLocaleString=function(formatOpts,opts){return void 0===formatOpts&&(formatOpts=DATE_SHORT),void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.clone(opts),formatOpts).formatDateTime(this):INVALID},_proto.toLocaleParts=function(opts){return void 0===opts&&(opts={}),this.isValid?Formatter.create(this.loc.clone(opts),opts).formatDateTimeParts(this):[]},_proto.toISO=function(_temp3){var c,_temp3=void 0===_temp3?{}:_temp3,_ref4$format=_temp3.format,_ref4$suppressSeconds=_temp3.suppressSeconds,_ref4$suppressSeconds=void 0!==_ref4$suppressSeconds&&_ref4$suppressSeconds,_ref4$suppressMillise=_temp3.suppressMilliseconds,_ref4$suppressMillise=void 0!==_ref4$suppressMillise&&_ref4$suppressMillise,_ref4$includeOffset=_temp3.includeOffset,_ref4$includeOffset=void 0===_ref4$includeOffset||_ref4$includeOffset,_temp3=_temp3.extendedZone,_temp3=void 0!==_temp3&&_temp3;return this.isValid?(c=_toISODate(this,_ref4$format="extended"===(void 0===_ref4$format?"extended":_ref4$format)),(c+="T")+_toISOTime(this,_ref4$format,_ref4$suppressSeconds,_ref4$suppressMillise,_ref4$includeOffset,_temp3)):null},_proto.toISODate=function(_temp4){_temp4=(void 0===_temp4?{}:_temp4).format;return this.isValid?_toISODate(this,"extended"===(void 0===_temp4?"extended":_temp4)):null},_proto.toISOWeekDate=function(){return toTechFormat(this,"kkkk-'W'WW-c")},_proto.toISOTime=function(_temp5){var _temp5=void 0===_temp5?{}:_temp5,_ref6$suppressMillise=_temp5.suppressMilliseconds,_ref6$suppressSeconds=_temp5.suppressSeconds,_ref6$includeOffset=_temp5.includeOffset,_ref6$includePrefix=_temp5.includePrefix,_ref6$extendedZone=_temp5.extendedZone,_temp5=_temp5.format;return this.isValid?(void 0!==_ref6$includePrefix&&_ref6$includePrefix?"T":"")+_toISOTime(this,"extended"===(void 0===_temp5?"extended":_temp5),void 0!==_ref6$suppressSeconds&&_ref6$suppressSeconds,void 0!==_ref6$suppressMillise&&_ref6$suppressMillise,void 0===_ref6$includeOffset||_ref6$includeOffset,void 0!==_ref6$extendedZone&&_ref6$extendedZone):null},_proto.toRFC2822=function(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},_proto.toHTTP=function(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},_proto.toSQLDate=function(){return this.isValid?_toISODate(this,!0):null},_proto.toSQLTime=function(_temp6){var _temp6=void 0===_temp6?{}:_temp6,_ref7$includeOffset=_temp6.includeOffset,_ref7$includeOffset=void 0===_ref7$includeOffset||_ref7$includeOffset,_ref7$includeZone=_temp6.includeZone,_ref7$includeZone=void 0!==_ref7$includeZone&&_ref7$includeZone,_temp6=_temp6.includeOffsetSpace,fmt="HH:mm:ss.SSS";return(_ref7$includeZone||_ref7$includeOffset)&&((void 0===_temp6||_temp6)&&(fmt+=" "),_ref7$includeZone?fmt+="z":_ref7$includeOffset&&(fmt+="ZZ")),toTechFormat(this,fmt,!0)},_proto.toSQL=function(opts){return void 0===opts&&(opts={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(opts):null},_proto.toString=function(){return this.isValid?this.toISO():INVALID},_proto.valueOf=function(){return this.toMillis()},_proto.toMillis=function(){return this.isValid?this.ts:NaN},_proto.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},_proto.toUnixInteger=function(){return this.isValid?Math.floor(this.ts/1e3):NaN},_proto.toJSON=function(){return this.toISO()},_proto.toBSON=function(){return this.toJSDate()},_proto.toObject=function(opts){var base;return void 0===opts&&(opts={}),this.isValid?(base=_extends({},this.c),opts.includeConfig&&(base.outputCalendar=this.outputCalendar,base.numberingSystem=this.loc.numberingSystem,base.locale=this.loc.locale),base):{}},_proto.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},_proto.diff=function(otherDateTime,unit,opts){var otherIsLater;return void 0===unit&&(unit="milliseconds"),void 0===opts&&(opts={}),this.isValid&&otherDateTime.isValid?(opts=_extends({locale:this.locale,numberingSystem:this.numberingSystem},opts),unit=unit,unit=(Array.isArray(unit)?unit:[unit]).map(Duration.normalizeUnit),otherDateTime=_diff((otherIsLater=otherDateTime.valueOf()>this.valueOf())?this:otherDateTime,otherIsLater?otherDateTime:this,unit,opts),otherIsLater?otherDateTime.negate():otherDateTime):Duration.invalid("created by diffing an invalid DateTime")},_proto.diffNow=function(unit,opts){return void 0===unit&&(unit="milliseconds"),void 0===opts&&(opts={}),this.diff(DateTime.now(),unit,opts)},_proto.until=function(otherDateTime){return this.isValid?Interval.fromDateTimes(this,otherDateTime):this},_proto.hasSame=function(otherDateTime,unit){var inputMs;return!!this.isValid&&(inputMs=otherDateTime.valueOf(),(otherDateTime=this.setZone(otherDateTime.zone,{keepLocalTime:!0})).startOf(unit)<=inputMs&&inputMs<=otherDateTime.endOf(unit))},_proto.equals=function(other){return this.isValid&&other.isValid&&this.valueOf()===other.valueOf()&&this.zone.equals(other.zone)&&this.loc.equals(other.loc)},_proto.toRelative=function(options){var base,padding,units,unit;return this.isValid?(base=(options=void 0===options?{}:options).base||DateTime.fromObject({},{zone:this.zone}),padding=options.padding?this<base?-options.padding:options.padding:0,units=["years","months","days","hours","minutes","seconds"],unit=options.unit,Array.isArray(options.unit)&&(units=options.unit,unit=void 0),diffRelative(base,this.plus(padding),_extends({},options,{numeric:"always",units:units,unit:unit}))):null},_proto.toRelativeCalendar=function(options){return void 0===options&&(options={}),this.isValid?diffRelative(options.base||DateTime.fromObject({},{zone:this.zone}),this,_extends({},options,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},DateTime.min=function(){for(var _len=arguments.length,dateTimes=new Array(_len),_key=0;_key<_len;_key++)dateTimes[_key]=arguments[_key];if(dateTimes.every(DateTime.isDateTime))return bestBy(dateTimes,function(i){return i.valueOf()},Math.min);throw new InvalidArgumentError("min requires all arguments be DateTimes")},DateTime.max=function(){for(var _len2=arguments.length,dateTimes=new Array(_len2),_key2=0;_key2<_len2;_key2++)dateTimes[_key2]=arguments[_key2];if(dateTimes.every(DateTime.isDateTime))return bestBy(dateTimes,function(i){return i.valueOf()},Math.max);throw new InvalidArgumentError("max requires all arguments be DateTimes")},DateTime.fromFormatExplain=function(text,fmt,options){var options=options=void 0===options?{}:options,_options$locale=options.locale,options=options.numberingSystem;return explainFromTokens(Locale.fromOpts({locale:void 0===_options$locale?null:_options$locale,numberingSystem:void 0===options?null:options,defaultToEN:!0}),text,fmt)},DateTime.fromStringExplain=function(text,fmt,options){return DateTime.fromFormatExplain(text,fmt,options=void 0===options?{}:options)},_createClass(DateTime,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return isLeapYear(this.year)}},{key:"daysInMonth",get:function(){return daysInMonth(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?daysInYear(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return DATE_SHORT}},{key:"DATE_MED",get:function(){return DATE_MED}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return DATE_MED_WITH_WEEKDAY}},{key:"DATE_FULL",get:function(){return DATE_FULL}},{key:"DATE_HUGE",get:function(){return DATE_HUGE}},{key:"TIME_SIMPLE",get:function(){return TIME_SIMPLE}},{key:"TIME_WITH_SECONDS",get:function(){return TIME_WITH_SECONDS}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return TIME_WITH_SHORT_OFFSET}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return TIME_WITH_LONG_OFFSET}},{key:"TIME_24_SIMPLE",get:function(){return TIME_24_SIMPLE}},{key:"TIME_24_WITH_SECONDS",get:function(){return TIME_24_WITH_SECONDS}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return TIME_24_WITH_SHORT_OFFSET}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return TIME_24_WITH_LONG_OFFSET}},{key:"DATETIME_SHORT",get:function(){return DATETIME_SHORT}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return DATETIME_SHORT_WITH_SECONDS}},{key:"DATETIME_MED",get:function(){return DATETIME_MED}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return DATETIME_MED_WITH_SECONDS}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return DATETIME_MED_WITH_WEEKDAY}},{key:"DATETIME_FULL",get:function(){return DATETIME_FULL}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return DATETIME_FULL_WITH_SECONDS}},{key:"DATETIME_HUGE",get:function(){return DATETIME_HUGE}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return DATETIME_HUGE_WITH_SECONDS}}]),DateTime}();function friendlyDateTime(dateTimeish){if(DateTime.isDateTime(dateTimeish))return dateTimeish;if(dateTimeish&&dateTimeish.valueOf&&isNumber(dateTimeish.valueOf()))return DateTime.fromJSDate(dateTimeish);if(dateTimeish&&"object"==typeof dateTimeish)return DateTime.fromObject(dateTimeish);throw new InvalidArgumentError("Unknown datetime argument: "+dateTimeish+", of type "+typeof dateTimeish)}exports.DateTime=DateTime,exports.Duration=Duration,exports.FixedOffsetZone=FixedOffsetZone,exports.IANAZone=IANAZone,exports.Info=Info,exports.Interval=Interval,exports.InvalidZone=InvalidZone,exports.Settings=Settings,exports.SystemZone=SystemZone,exports.VERSION="3.0.4",exports.Zone=Zone},{}],2:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderableComponent=void 0;require=function(_super){function RenderableComponent(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RenderableComponent,_super),RenderableComponent.prototype.hide=function(){return __awaiter(this,void 0,void 0,function(){var _a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return _a.hidden=!0,[2,this]}})})},RenderableComponent.prototype.render=function(maybeParent,prepend){return void 0===prepend&&(prepend=!1),__awaiter(this,void 0,void 0,function(){var element,_a,_b,parent;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return element=_a,parent=maybeParent||document.body,prepend?parent.prepend(element):parent.append(element),[2,element]}})})},RenderableComponent.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var _a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return _a.hidden=!1,[2,this]}})})},RenderableComponent.prototype.teardown=function(){return __awaiter(this,void 0,void 0,function(){var element,_a,_b;return __generator(this,function(_c){switch(_c.label){case 0:return(_a=this.element)?[3,2]:[4,(_b=this).create()];case 1:_a=_b.element=_c.sent(),_c.label=2;case 2:return(element=_a).remove(),[2,element]}})})},RenderableComponent}(require("../services/card/index").InspectableComponent);exports.RenderableComponent=require},{"../services/card/index":26}],3:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.AddInMenu=void 0,require(".")),html_1=require("../utils/html"),identifiers_1=require("../utils/identifiers"),require=function(_super){function AddInMenu(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.cardActions={},_this.universalActions={},_this}return __extends(AddInMenu,_super),AddInMenu.prototype.getIdentifiers=function(type){return Object.keys(this["".concat(type,"Actions")])},AddInMenu.prototype.addCardAction=function(cardAction){return __awaiter(this,void 0,void 0,function(){var guid;return __generator(this,function(_a){return guid=(0,identifiers_1.getGuid)(this.getIdentifiers("card")),this.cardActions[guid]=cardAction,[2,this]})})},AddInMenu.prototype.addUniversalAction=function(universalAction){return __awaiter(this,void 0,void 0,function(){var guid;return __generator(this,function(_a){return guid=(0,identifiers_1.getGuid)(this.getIdentifiers("universal")),this.universalActions[guid]=universalAction,[2,this]})})},AddInMenu.prototype.clear=function(type){var store=this["".concat(type,"Actions")];return Object.entries(store).forEach(function(_a){var _a=__read(_a,2),guid=_a[0];_a[1].teardown(),delete store[guid]}),this},AddInMenu.prototype.isClosed=function(){return(this.element||(this.element=this.create())).classList.contains("singulared")},AddInMenu.prototype.isOpen=function(){return!this.isClosed()},AddInMenu.prototype.remove=function(type,guid){var type=this["".concat(type,"Actions")],action=type[guid];return null!=action&&action.teardown(),delete type[guid],this},AddInMenu.prototype.close=function(){var element=this.element;return null!=element&&element.classList.add("singulared"),this},AddInMenu.prototype.toggle=function(){var element=this.element;return null!=element&&element.classList.toggle("singulared"),this},AddInMenu.prototype.create=function(){var _a,_this=this,element=document.createElement("div");return element.classList.add("menu","singulared"),null!=(_a=document.querySelector(".navelem"))&&_a.addEventListener("click",function(event){event.stopPropagation(),event.preventDefault(),_this.toggle(),_this.isOpen()&&(0,html_1.bindSelfRemovingListener)(document.body,"click",function(){return _this.close()})}),element},AddInMenu.prototype.render=function(maybeParent){return __awaiter(this,void 0,void 0,function(){var cardActions,_a,element,_b,_c,_d,_e,e_1_1,_f,e_2_1,_g;return __generator(this,function(_h){switch(_h.label){case 0:cardActions=(_a=this).cardActions,_a=_a.universalActions,element=this.element||(this.element=this.create()),_h.label=1;case 1:_h.trys.push([1,6,7,8]),_b=__values(Object.values(cardActions)),_c=_b.next(),_h.label=2;case 2:return _c.done?[3,5]:[4,_c.value.render(element)];case 3:_h.sent(),_h.label=4;case 4:return _c=_b.next(),[3,2];case 5:return[3,8];case 6:return e_1_1=_h.sent(),e_1_1={error:e_1_1},[3,8];case 7:try{_c&&!_c.done&&(_f=_b.return)&&_f.call(_b)}finally{if(e_1_1)throw e_1_1.error}return[7];case 8:_h.trys.push([8,13,14,15]),_d=__values(Object.values(_a)),_e=_d.next(),_h.label=9;case 9:return _e.done?[3,12]:[4,_e.value.render(element)];case 10:_h.sent(),_h.label=11;case 11:return _e=_d.next(),[3,9];case 12:return[3,15];case 13:return e_2_1=_h.sent(),e_2_1={error:e_2_1},[3,15];case 14:try{_e&&!_e.done&&(_g=_d.return)&&_g.call(_d)}finally{if(e_2_1)throw e_2_1.error}return[7];case 15:return[2,_super.prototype.render.call(this,maybeParent)]}})})},AddInMenu}(_1.RenderableComponent);exports.AddInMenu=require},{".":2,"../utils/html":33,"../utils/identifiers":34}],4:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Overlay=void 0,require(".")),html_1=require("../utils/html"),require=function(_super){function Overlay(containerId){var _this=_super.call(this)||this;return _this.containerId=containerId,_this.color="white",_this.tone="light",_this}return __extends(Overlay,_super),Overlay.prototype.setColor=function(color){return this.color=color,this},Overlay.prototype.setTone=function(tone){return this.tone=tone,this},Overlay.prototype.create=function(){var tone=this.tone,color=this.color,overlay=document.createElement("div");return overlay.classList.add("overlay"),overlay.classList.add("overlay-".concat(tone)),overlay.hidden=!0,overlay.style.backgroundColor=color,overlay},Overlay.prototype.cover=function(){var containerId=this.containerId,element=this.element||(this.element=this.create()),appContainer=document.getElementById(containerId);if(appContainer)return appContainer=window.getComputedStyle(appContainer),appContainer=(0,html_1.parsePixelLength)(appContainer.height)+35,element.style.height="".concat(appContainer,"px"),this;throw new Error("missing app container: #".concat(containerId))},Overlay.prototype.hide=function(){return this.cover(),_super.prototype.hide.call(this)},Overlay.prototype.show=function(){return this.cover(),_super.prototype.show.call(this)},Overlay}(_1.RenderableComponent);exports.Overlay=require},{".":2,"../utils/html":33}],5:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.Spinner=void 0;require=function(_super){function Spinner(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.size="small",_this}return __extends(Spinner,_super),Spinner.prototype.setSize=function(size){return this.size=size,this},Spinner.prototype.create=function(){var size=this.size,spinner=document.createElement("div");return spinner.classList.add("spinner","spinner-".concat(size)),spinner},Spinner.prototype.render=function(maybeParent){var element=this.element||(this.element=this.create()),classList=element.classList;return classList.forEach(function(token){token.startsWith("spinner-")&&classList.remove(token)}),element.classList.add("spinner-".concat(this.size)),_super.prototype.render.call(this,maybeParent)},Spinner}(require(".").RenderableComponent);exports.Spinner=require},{".":2}],6:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},luxon_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventObject=void 0,__importDefault(require("luxon"))),office_1=require("./utils/office"),EventTimezone=function(){function EventTimezone(){}return Object.defineProperty(EventTimezone.prototype,"id",{get:function(){return(0,office_1.getProfile)().timeZone},enumerable:!1,configurable:!0}),Object.defineProperty(EventTimezone.prototype,"offset",{get:function(){return(60*luxon_1.default.DateTime.fromJSDate(new Date,{zone:this.id}).offset*1e3).toString()},enumerable:!1,configurable:!0}),EventTimezone}(),CommonEventObject=function(){function CommonEventObject(){this.timeZone=new EventTimezone,this.parameters={},this.formInputs={}}return Object.defineProperty(CommonEventObject.prototype,"platform",{get:function(){return Office.context.platform||Office.PlatformType.OfficeOnline},enumerable:!1,configurable:!0}),Object.defineProperty(CommonEventObject.prototype,"userLocale",{get:function(){return Office.context.displayLanguage||"en-US"},enumerable:!1,configurable:!0}),CommonEventObject}(),GmailEventObject=function(){function GmailEventObject(item){this.item=item}return Object.defineProperty(GmailEventObject.prototype,"accessToken",{get:function(){return new Promise(function(res,rej){(0,office_1.getMailbox)().getCallbackTokenAsync(function(result){var error=result.error,result=result.value;null!=error&&error.code?rej(error):res(result)})})},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"bccRecipients",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"ccRecipients",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.cc.map(function(_a){return _a.emailAddress}))||[]},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"messageId",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.itemId)||""},enumerable:!1,configurable:!0}),Object.defineProperty(GmailEventObject.prototype,"threadId",{get:function(){var _a;return(null==(_a=this.item)?void 0:_a.conversationId)||""},enumerable:!1,configurable:!0}),GmailEventObject}(),__importDefault=function(){function EventObject(){var _a;this.commonEventObject=new CommonEventObject,this.gmail=new GmailEventObject(null==(_a=Office.context.mailbox)?void 0:_a.item)}return Object.defineProperty(EventObject.prototype,"formInput",{get:function(){var formInputs=this.commonEventObject.formInputs,inputs={};return Object.entries(formInputs).forEach(function(_a){var _a=__read(_a,2),key=_a[0],_a=_a[1].stringInputs;inputs[key]=_a.value[0]}),inputs},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"formInputs",{get:function(){var formInputs=this.commonEventObject.formInputs,inputs={};return Object.entries(formInputs).forEach(function(_a){var _a=__read(_a,2),key=_a[0],_a=_a[1].stringInputs;inputs[key]=_a.value}),inputs},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"clientPlatform",{get:function(){return this.commonEventObject.platform},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"messageMetadata",{get:function(){var gmail=this.gmail;return{accessToken:gmail.accessToken,messageId:gmail.messageId}},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"parameters",{get:function(){return this.commonEventObject.parameters},set:function(value){this.commonEventObject.parameters=value},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userCountry",{get:function(){var userLocale=this.commonEventObject.userLocale;return __read(userLocale.split("-"),2)[1]||"US"},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userLocale",{get:function(){return this.commonEventObject.userLocale},enumerable:!1,configurable:!0}),Object.defineProperty(EventObject.prototype,"userTimezone",{get:function(){return this.commonEventObject.timeZone},enumerable:!1,configurable:!0}),EventObject}();exports.EventObject=__importDefault},{"./utils/office":38,luxon:1}],7:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},overlay_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.getActionResponse=void 0,require("../components/overlay")),spinner_1=require("../components/spinner"),action_response_1=require("../services/card/builders/action_response"),enums_1=require("../services/card/enums"),functions_1=require("../utils/functions"),log_1=require("../utils/log"),strings_1=require("../utils/strings");exports.getActionResponse=function(action,event){return __awaiter(void 0,void 0,void 0,function(){var indicator,name,overlayParent,overlay,spinner,parameters,handlerResult_1,handlerResult_1_1,card,navigation,error_1,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:if(indicator=action.indicator,name=action.name,parameters=action.parameters,name)return Object.assign(event.parameters,parameters),overlayParent=document.getElementById("app-overlay"),[4,(overlay=new overlay_1.Overlay("app-body")).render(overlayParent)];throw new Error("action is missing the function name",{cause:action});case 1:return _b.sent(),[4,overlay.show()];case 2:return _b.sent(),(spinner=new spinner_1.Spinner).setSize("large"),[4,spinner.render(overlayParent)];case 3:return _b.sent(),indicator===enums_1.LoadIndicator.NONE?[3,5]:[4,spinner.show()];case 4:_b.sent(),_b.label=5;case 5:if(_b.trys.push([5,6,7,10]),(parameters=(0,functions_1.callFunctionFromGlobalScope)(name,event))instanceof Array){navigation=window.CardService.newNavigation();try{for(handlerResult_1=__values(parameters),handlerResult_1_1=handlerResult_1.next();!handlerResult_1_1.done;handlerResult_1_1=handlerResult_1.next())card=handlerResult_1_1.value,navigation.pushCard(card)}catch(e_1_1){e_1={error:e_1_1}}finally{try{handlerResult_1_1&&!handlerResult_1_1.done&&(_a=handlerResult_1.return)&&_a.call(handlerResult_1)}finally{if(e_1)throw e_1.error}}return[2,(new action_response_1.ActionResponseBuilder).setNavigation(navigation).build()]}return window.CardServiceConfig.isInstance(parameters,"Card")?(navigation=window.CardService.newNavigation(),[2,(new action_response_1.ActionResponseBuilder).setNavigation(navigation.pushCard(parameters)).build()]):[2,parameters];case 6:throw error_1=_b.sent(),(0,log_1.log)("error","failed to handle action",(0,strings_1.safeToString)(error_1)),error_1;case 7:return[4,spinner.hide()];case 8:return _b.sent(),[4,overlay.hide()];case 9:return _b.sent(),[7];case 10:return[2]}})})}},{"../components/overlay":4,"../components/spinner":5,"../services/card/builders/action_response":18,"../services/card/enums":25,"../utils/functions":31,"../utils/log":35,"../utils/strings":39}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDisplayCardsResponse=void 0;var universal_action_response_1=require("../services/card/builders/universal_action_response");exports.getDisplayCardsResponse=function(action){var builder=new universal_action_response_1.UniversalActionResponseBuilder;return builder.displayAddOnCards(action.getCards()),builder.build()}},{"../services/card/builders/universal_action_response":20}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOpenLinkResponse=void 0;var universal_action_response_1=require("../services/card/builders/universal_action_response");exports.getOpenLinkResponse=function(action){var builder=new universal_action_response_1.UniversalActionResponseBuilder;return builder.setOpenLink(action),builder.build()}},{"../services/card/builders/universal_action_response":20}],10:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},action_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleAction=void 0,require("../getters/action")),display_cards_1=require("../getters/display_cards"),open_link_1=require("../getters/open_link"),action_2=require("../services/card/actions/action"),display_cards_2=require("../services/card/actions/display_cards"),open_link_2=require("../services/card/actions/open_link"),action_response_1=require("../services/card/components/responses/action_response"),suggestions_response_1=require("../services/card/components/responses/suggestions_response"),universal_action_response_1=require("../services/card/components/responses/universal_action_response"),actions_1=require("../stores/actions"),rules_1=require("../stores/rules"),log_1=require("../utils/log"),strings_1=require("../utils/strings"),response_1=require("./response");exports.handleAction=function(event,element){return __awaiter(void 0,void 0,void 0,function(){var guid,action,actionResponse_1,actionHandlerStore,_b;return __generator(this,function(_c){switch(_c.label){case 0:if(guid=element.getAttribute("action"),action=guid?actions_1.ActionStore.get(guid):void 0,!guid||!action)return[2];console.debug(guid,event,action),_c.label=1;case 1:if(_c.trys.push([1,5,6,8]),actionHandlerStore=new rules_1.RuleStore([[action_2.Action,action_1.getActionResponse],[display_cards_2.DisplayCardsAction,display_cards_1.getDisplayCardsResponse],[open_link_2.OpenLink,open_link_1.getOpenLinkResponse]]),actionHandlerStore=__read(actionHandlerStore.find(function(_a){_a=__read(_a,1)[0];return action instanceof _a||window.CardServiceConfig.isInstance(action,_a.name)}),2),actionHandlerStore=actionHandlerStore[1])return[4,actionHandlerStore(action,event)];throw new Error("missing handler for action",{cause:action});case 2:if(!(actionResponse_1=_c.sent()))return[3,4];if(actionHandlerStore=new rules_1.RuleStore([[action_response_1.ActionResponse,response_1.handleActionResponse],[suggestions_response_1.SuggestionsResponse,response_1.handleSuggestionsResponse],[universal_action_response_1.UniversalActionResponse,response_1.handleUniversalActionResponse]]),_b=__read(actionHandlerStore.find(function(_a){_a=__read(_a,1)[0];return actionResponse_1 instanceof _a||window.CardServiceConfig.isInstance(actionResponse_1,_a.name)}),2),_b=_b[1])return[4,_b(actionResponse_1,element)];throw new Error("missing action response handler",{cause:actionResponse_1});case 3:_c.sent(),_c.label=4;case 4:return[3,8];case 5:return _b=_c.sent(),(0,log_1.log)("error","action handler error",(0,strings_1.safeToString)(_b)),[3,8];case 6:return actions_1.ActionStore.remove(guid),[4,new Promise(function(r){return setTimeout(r,500)})];case 7:return _c.sent(),[7];case 8:return[2]}})})}},{"../getters/action":7,"../getters/display_cards":8,"../getters/open_link":9,"../services/card/actions/action":14,"../services/card/actions/display_cards":15,"../services/card/actions/open_link":16,"../services/card/components/responses/action_response":22,"../services/card/components/responses/suggestions_response":23,"../services/card/components/responses/universal_action_response":24,"../stores/actions":27,"../stores/rules":28,"../utils/log":35,"../utils/strings":39,"./response":13}],11:[function(require,module,exports){"use strict";var __values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},events_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=void 0,require("../events")),guards_1=require("../utils/guards"),action_1=require("./action"),addToFormInputs=function(event,name,value){event=event.commonEventObject.formInputs;(event[name]||(event[name]={stringInputs:{value:[]}})).stringInputs.value.push(value)},removeFromFormInputs=function(event,name,value){name=(event=event.commonEventObject.formInputs[name].stringInputs).value||(event.value=[]);-1<name.indexOf(value)&&name.splice(name.indexOf(value),1)},fillFormInputs=function(event){var e_1,_a,e_2,_b,forms=document.getElementsByTagName("form");try{for(var forms_1=__values(forms),forms_1_1=forms_1.next();!forms_1_1.done;forms_1_1=forms_1.next()){var elements=forms_1_1.value.elements;try{e_2=void 0;for(var elements_1=__values(elements),elements_1_1=elements_1.next();!elements_1_1.done;elements_1_1=elements_1.next()){var name_1,value,element=elements_1_1.value;(0,guards_1.isInputLike)(element)&&(name_1=element.name,value=element.value,(!(0,guards_1.isOfficeJSstateFormElement)(element)||(0,guards_1.isSelectedStateFormElement)(element)?addToFormInputs:removeFromFormInputs)(event,name_1,value))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{elements_1_1&&!elements_1_1.done&&(_b=elements_1.return)&&_b.call(elements_1)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{forms_1_1&&!forms_1_1.done&&(_a=forms_1.return)&&_a.call(forms_1)}finally{if(e_1)throw e_1.error}}};exports.handleEvent=function(element){var event=new events_1.EventObject;fillFormInputs(event),(0,action_1.handleAction)(event,element)}},{"../events":6,"../utils/guards":32,"./action":10}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleOpenLinkAction=void 0;var ready_1=require("../../ready"),enums_1=require("../services/card/enums"),anchors_1=require("../utils/anchors");exports.handleOpenLinkAction=function(openLink){var onClose=openLink.onClose,openAs=openLink.openAs,openLink=openLink.url,openLink=void 0===openLink?"":openLink;(_a={})[enums_1.OpenAs.FULL_SIZE]="browser",_a[enums_1.OpenAs.OVERLAY]="dialog";var _a=Office.context.host?_a[openAs]:"web";(0,anchors_1.openURL)(openLink,_a,function(){onClose===enums_1.OnClose.RELOAD&&(0,ready_1.readyCallback)(Office.context)})}},{"../../ready":43,"../services/card/enums":25,"../utils/anchors":29}],13:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},navigation_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleUniversalActionResponse=exports.handleSuggestionsResponse=exports.handleActionResponse=void 0,require("../services/card/components/navigation")),rules_1=require("../stores/rules"),log_1=require("../utils/log"),strings_1=require("../utils/strings"),open_link_1=require("./open_link"),navigationRules=new rules_1.RuleStore([[navigation_1.NavigationType.NAMED,function(store,action){store.named(action.name)}],[navigation_1.NavigationType.POP,function(store){store.pop()}],[navigation_1.NavigationType.PUSH,function(store,action){store.push(action.card)}],[navigation_1.NavigationType.ROOT,function(store){store.root()}]]);exports.handleActionResponse=function(response){return __awaiter(void 0,void 0,void 0,function(){var notification,openLink,actions,CardStore_1,_loop_1,actions_1,actions_1_1,action,navigation,error_1,e_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:return(_b.trys.push([0,6,,7]),navigation=response.navigation,notification=response.notification,openLink=response.openLink,navigation)?(actions=navigation.actions,[4,(CardStore_1=window.CardServiceConfig.CardStore).teardown()]):[3,3];case 1:_b.sent(),_loop_1=function(action){var type=action.type,navigationHandler=__read(navigationRules.find(function(_a){return __read(_a,1)[0]===type}),2)[1];if(!navigationHandler)throw new Error("missing Navigation handler",{cause:action});navigationHandler(CardStore_1,action)};try{for(actions_1=__values(actions),actions_1_1=actions_1.next();!actions_1_1.done;actions_1_1=actions_1.next())action=actions_1_1.value,_loop_1(action)}catch(e_1_1){e_1={error:e_1_1}}finally{try{actions_1_1&&!actions_1_1.done&&(_a=actions_1.return)&&_a.call(actions_1)}finally{if(e_1)throw e_1.error}}return[4,CardStore_1.render(document.getElementById("app-body"))];case 2:_b.sent(),_b.label=3;case 3:return notification?(navigation=document.getElementById("app-notif")||document.body,[4,notification.render(navigation)]):[3,5];case 4:_b.sent(),_b.label=5;case 5:return openLink&&(0,open_link_1.handleOpenLinkAction)(openLink),[3,7];case 6:return error_1=_b.sent(),(0,log_1.log)("error","ActionResponse handler error",(0,strings_1.safeToString)(error_1)),[3,7];case 7:return[2]}})})},exports.handleSuggestionsResponse=function(response,element){element.dispatchEvent(new CustomEvent("suggestions",{detail:(null==(element=response.suggestions)?void 0:element.suggestions)||[],bubbles:!1}))};exports.handleUniversalActionResponse=function(response){return __awaiter(void 0,void 0,void 0,function(){var cards,openLink,CardStore_2,error_2;return __generator(this,function(_a){switch(_a.label){case 0:return(_a.trys.push([0,4,,5]),cards=response.cards,openLink=response.openLink,CardStore_2=window.CardServiceConfig.CardStore,cards.length)?[4,CardStore_2.teardown()]:[3,3];case 1:return _a.sent(),CardStore_2.reset(cards),[4,CardStore_2.render(document.getElementById("app-body"))];case 2:_a.sent(),_a.label=3;case 3:return openLink&&(0,open_link_1.handleOpenLinkAction)(openLink),[3,5];case 4:return error_2=_a.sent(),(0,log_1.log)("error","UniversalActionResponse handler error",(0,strings_1.safeToString)(error_2)),[3,5];case 5:return[2]}})})}},{"../services/card/components/navigation":21,"../stores/rules":28,"../utils/log":35,"../utils/strings":39,"./open_link":12}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;var enums_1=require("../enums"),require=function(){function Action(){this.indicator=enums_1.LoadIndicator.SPINNER,this.parameters={}}return Action.prototype.setFunctionName=function(functionName){return this.name=functionName,this},Action.prototype.setLoadIndicator=function(loadIndicator){return this.indicator=loadIndicator,this},Action.prototype.setParameters=function(parameters){return this.parameters=parameters,this},Action}();exports.Action=require},{"../enums":25}],15:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},DisplayCardsAction=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.DisplayCardsAction=void 0,function(){function DisplayCardsAction(){this.cards=[]}return DisplayCardsAction.prototype.getCards=function(){return __spreadArray([],__read(this.cards),!1)},DisplayCardsAction.prototype.setCards=function(cards){return this.cards=__spreadArray([],__read(cards),!1),this},DisplayCardsAction.prototype.displayCards=function(){return __awaiter(this,void 0,void 0,function(){var cards,parent,cards_1,cards_1_1,e_1_1,_a;return __generator(this,function(_b){switch(_b.label){case 0:cards=this.getCards(),parent=document.getElementById("app-body"),_b.label=1;case 1:_b.trys.push([1,6,7,8]),cards_1=__values(cards),cards_1_1=cards_1.next(),_b.label=2;case 2:return cards_1_1.done?[3,5]:[4,cards_1_1.value.render(parent)];case 3:_b.sent(),_b.label=4;case 4:return cards_1_1=cards_1.next(),[3,2];case 5:return[3,8];case 6:return e_1_1=_b.sent(),e_1_1={error:e_1_1},[3,8];case 7:try{cards_1_1&&!cards_1_1.done&&(_a=cards_1.return)&&_a.call(cards_1)}finally{if(e_1_1)throw e_1_1.error}return[7];case 8:return[2,this]}})})},DisplayCardsAction}());exports.DisplayCardsAction=DisplayCardsAction},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenLink=void 0;var enums_1=require("../enums"),require=function(){function OpenLink(){this.onClose=enums_1.OnClose.NOTHING,this.openAs=enums_1.OpenAs.FULL_SIZE}return OpenLink.prototype.setOnClose=function(onClose){return this.onClose=onClose,this},OpenLink.prototype.setOpenAs=function(openAs){return this.openAs=openAs,this},OpenLink.prototype.setUrl=function(url){return this.url=url,this},OpenLink}();exports.OpenLink=require},{"../enums":25}],17:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),components_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalAction=void 0,require("../../../../gas-js/components")),events_1=require("../../../../gas-js/events"),event_1=require("../../../../gas-js/handlers/event"),actions_1=require("../../../../gas-js/stores/actions"),functions_1=require("../../../../gas-js/utils/functions"),display_cards_1=require("./display_cards"),require=function(_super){function UniversalAction(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(UniversalAction,_super),UniversalAction.prototype.getText=function(){var text=this.text;if(text)return text;throw new Error("universal actions must have text set")},UniversalAction.prototype.run=function(){var functionName=this.functionName;if(functionName)return(functionName=(0,functions_1.callFunctionFromGlobalScope)(functionName,new events_1.EventObject))instanceof Array?(new display_cards_1.DisplayCardsAction).setCards(functionName):window.CardServiceConfig.isInstance(functionName,"Card")?(new display_cards_1.DisplayCardsAction).setCards([functionName]):functionName;throw new Error("universal actions must have a function name set")},UniversalAction.prototype.setRunFunction=function(name){return this.functionName=name,this},UniversalAction.prototype.setText=function(text){return this.text=text,this},UniversalAction.prototype.create=function(){var _this=this,text=this.getText(),wrapper=document.createElement("div"),textElement=(wrapper.classList.add("menu-item"),document.createElement("p"));return textElement.classList.add("menu-item-text"),textElement.textContent=text,wrapper.addEventListener("click",function(){actions_1.ActionStore.set(wrapper,_this.run()),(0,event_1.handleEvent)(wrapper)}),wrapper.append(textElement),wrapper},UniversalAction}(components_1.RenderableComponent);exports.UniversalAction=require},{"../../../../gas-js/components":2,"../../../../gas-js/events":6,"../../../../gas-js/handlers/event":11,"../../../../gas-js/stores/actions":27,"../../../../gas-js/utils/functions":31,"./display_cards":15}],18:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),action_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionResponseBuilder=void 0,require("../components/responses/action_response")),require=function(_super){function ActionResponseBuilder(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.stateChanged=!1,_this}return __extends(ActionResponseBuilder,_super),ActionResponseBuilder.prototype.build=function(){var response=new action_response_1.ActionResponse({navigation:this.navigation,notification:this.notification,openLink:this.openLink,stateChanged:this.stateChanged});return _super.prototype.build.call(this,response),response},ActionResponseBuilder.prototype.setNavigation=function(navigation){return this.navigation=navigation,this},ActionResponseBuilder.prototype.setNotification=function(notification){return this.notification=notification,this},ActionResponseBuilder.prototype.setOpenLink=function(openLink){return this.openLink=openLink,this},ActionResponseBuilder.prototype.setStateChanged=function(stateChanged){return this.stateChanged=stateChanged,this},ActionResponseBuilder.prototype.validate=function(){return[this.navigation,this.notification,this.openLink].some(Boolean)},ActionResponseBuilder}(require("./index").CardServiceBuilder);exports.ActionResponseBuilder=require},{"../components/responses/action_response":22,"./index":19}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardServiceBuilder=void 0;var CardServiceBuilder=function(){function CardServiceBuilder(){}return CardServiceBuilder.prototype.build=function(item){if(this.validate())return item;throw new Error("Invalid ".concat(item.constructor.name))},CardServiceBuilder}();exports.CardServiceBuilder=CardServiceBuilder},{}],20:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),universal_action_response_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalActionResponseBuilder=void 0,require("../components/responses/universal_action_response")),require=function(_super){function UniversalActionResponseBuilder(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.cards=[],_this}return __extends(UniversalActionResponseBuilder,_super),UniversalActionResponseBuilder.prototype.build=function(){var response=new universal_action_response_1.UniversalActionResponse({cards:this.cards,openLink:this.openLink});return _super.prototype.build.call(this,response),response},UniversalActionResponseBuilder.prototype.displayAddOnCards=function(cardObjects){return this.cards=cardObjects,this},UniversalActionResponseBuilder.prototype.setOpenLink=function(openLink){return this.openLink=openLink,this},UniversalActionResponseBuilder.prototype.validate=function(){var openLink=this.openLink;return[this.cards.length,openLink].some(Boolean)},UniversalActionResponseBuilder}(require("./index").CardServiceBuilder);exports.UniversalActionResponseBuilder=require},{"../components/responses/universal_action_response":24,"./index":19}],21:[function(require,module,exports){"use strict";var extendStatics,NavigationType,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),require=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Navigation=exports.PushNavigationAction=exports.NavigationAction=exports.NavigationType=void 0,require("../index")),NavigationAction=(!function(NavigationType){NavigationType.NAMED="NAMED",NavigationType.POP="POP",NavigationType.PUSH="PUSH",NavigationType.ROOT="ROOT"}(NavigationType=exports.NavigationType||(exports.NavigationType={})),function(type,name){this.type=type,this.name=name}),PushNavigationAction=function(_super){function PushNavigationAction(card){var _this=_super.call(this,NavigationType.PUSH)||this;return _this.card=card,_this}return __extends(PushNavigationAction,_super),PushNavigationAction}(exports.NavigationAction=NavigationAction),require=(exports.PushNavigationAction=PushNavigationAction,function(_super){function Navigation(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.actions=[],_this}return __extends(Navigation,_super),Navigation.prototype.popCard=function(){return this.actions.push(new NavigationAction(NavigationType.POP)),this},Navigation.prototype.popToNamedCard=function(cardName){return this.actions.push(new NavigationAction(NavigationType.NAMED,cardName)),this},Navigation.prototype.popToRoot=function(){return this.actions.push(new NavigationAction(NavigationType.ROOT)),this},Navigation.prototype.pushCard=function(card){return this.actions.push(new PushNavigationAction(card)),this},Navigation.prototype.updateCard=function(card){return this.actions.push(new NavigationAction(NavigationType.POP),new PushNavigationAction(card)),this},Navigation}(require.InspectableComponent));exports.Navigation=require},{"../index":26}],22:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionResponse=void 0;require=function(_super){function ActionResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(ActionResponse,_super),Object.defineProperty(ActionResponse.prototype,"navigation",{get:function(){return this.config.navigation},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"notification",{get:function(){return this.config.notification},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"openLink",{get:function(){return this.config.openLink},enumerable:!1,configurable:!0}),Object.defineProperty(ActionResponse.prototype,"stateChanged",{get:function(){return this.config.stateChanged},enumerable:!1,configurable:!0}),ActionResponse}(require("../../index").InspectableComponent);exports.ActionResponse=require},{"../../index":26}],23:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestionsResponse=void 0;require=function(_super){function SuggestionsResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(SuggestionsResponse,_super),Object.defineProperty(SuggestionsResponse.prototype,"suggestions",{get:function(){return this.config.suggestions},enumerable:!1,configurable:!0}),SuggestionsResponse}(require("../../index").InspectableComponent);exports.SuggestionsResponse=require},{"../../index":26}],24:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(d,b){d.__proto__=b}:function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])}))(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalActionResponse=void 0;require=function(_super){function UniversalActionResponse(config){var _this=_super.call(this)||this;return _this.config=config,_this}return __extends(UniversalActionResponse,_super),Object.defineProperty(UniversalActionResponse.prototype,"cards",{get:function(){return this.config.cards},enumerable:!1,configurable:!0}),Object.defineProperty(UniversalActionResponse.prototype,"openLink",{get:function(){return this.config.openLink},enumerable:!1,configurable:!0}),UniversalActionResponse}(require("../../index").InspectableComponent);exports.UniversalActionResponse=require},{"../../index":26}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateDraftBodyType=exports.TextButtonStyle=exports.SwitchControlType=exports.SelectionInputType=exports.OpenAs=exports.OnClose=exports.LoadIndicator=exports.ImageStyle=exports.ImageCropType=exports.Icon=exports.HorizontalAlignment=exports.GridItemLayout=exports.DisplayStyle=exports.ContentType=exports.ComposedEmailType=exports.BorderType=void 0,function(BorderType){BorderType.NO_BORDER="NO_BORDER",BorderType.STROKE="STROKE"}(exports.BorderType||(exports.BorderType={})),function(ComposedEmailType){ComposedEmailType.REPLY_AS_DRAFT="REPLY_AS_DRAFT",ComposedEmailType.STANDALONE_DRAFT="STANDALONE_DRAFT"}(exports.ComposedEmailType||(exports.ComposedEmailType={})),function(ContentType){ContentType.TEXT="TEXT",ContentType.MUTABLE_HTML="MUTABLE_HTML",ContentType.IMMUTABLE_HTML="IMMUTABLE_HTML"}(exports.ContentType||(exports.ContentType={})),function(DisplayStyle){DisplayStyle.REPLACE="REPLACE",DisplayStyle.PEEK="PEEK"}(exports.DisplayStyle||(exports.DisplayStyle={})),function(GridItemLayout){GridItemLayout.TEXT_BELOW="TEXT_BELOW",GridItemLayout.TEXT_ABOVE="TEXT_ABOVE"}(exports.GridItemLayout||(exports.GridItemLayout={})),function(HorizontalAlignment){HorizontalAlignment.START="START",HorizontalAlignment.CENTER="CENTER",HorizontalAlignment.END="END"}(exports.HorizontalAlignment||(exports.HorizontalAlignment={})),function(Icon){Icon.NONE="",Icon.AIRPLANE="AIRPLANE",Icon.BOOKMARK="BOOKMARK",Icon.BUS="BUS",Icon.CAR="CAR",Icon.CLOCK="CLOCK",Icon.CONFIRMATION_NUMBER_ICON="CONFIRMATION_NUMBER_ICON",Icon.DOLLAR="DOLLAR",Icon.DESCRIPTION="DESCRIPTION",Icon.EMAIL="EMAIL",Icon.EVENT_PERFORMER="EVENT_PERFORMER",Icon.EVENT_SEAT="EVENT_SEAT",Icon.FLIGHT_ARRIVAL="FLIGHT_ARRIVAL",Icon.FLIGHT_DEPARTURE="FLIGHT_DEPARTURE",Icon.HOTEL="HOTEL",Icon.HOTEL_ROOM_TYPE="HOTEL_ROOM_TYPE",Icon.INVITE="INVITE",Icon.MAP_PIN="MAP_PIN",Icon.MEMBERSHIP="MEMBERSHIP",Icon.MULTIPLE_PEOPLE="MULTIPLE_PEOPLE",Icon.OFFER="OFFER",Icon.PERSON="PERSON",Icon.PHONE="PHONE",Icon.RESTAURANT_ICON="RESTAURANT_ICON",Icon.SHOPPING_CART="SHOPPING_CART",Icon.STAR="STAR",Icon.STORE="STORE",Icon.TICKET="TICKET",Icon.TRAIN="TRAIN",Icon.VIDEO_CAMERA="VIDEO_CAMERA",Icon.VIDEO_PLAY="VIDEO_PLAY"}(exports.Icon||(exports.Icon={})),function(ImageCropType){ImageCropType.SQUARE="SQUARE",ImageCropType.CIRCLE="CIRCLE",ImageCropType.RECTANGLE_CUSTOM="RECTANGLE_CUSTOM",ImageCropType.RECTANGLE_4_3="RECTANGLE_4_3"}(exports.ImageCropType||(exports.ImageCropType={})),function(ImageStyle){ImageStyle.SQUARE="SQUARE",ImageStyle.CIRCLE="CIRCLE"}(exports.ImageStyle||(exports.ImageStyle={})),function(LoadIndicator){LoadIndicator.SPINNER="SPINNER",LoadIndicator.NONE="NONE"}(exports.LoadIndicator||(exports.LoadIndicator={})),function(OnClose){OnClose.NOTHING="NOTHING",OnClose.RELOAD="RELOAD"}(exports.OnClose||(exports.OnClose={})),function(OpenAs){OpenAs.FULL_SIZE="FULL_SIZE",OpenAs.OVERLAY="OVERLAY"}(exports.OpenAs||(exports.OpenAs={})),function(SelectionInputType){SelectionInputType.CHECK_BOX="CHECK_BOX",SelectionInputType.RADIO_BUTTON="RADIO_BUTTON",SelectionInputType.DROPDOWN="DROPDOWN"}(exports.SelectionInputType||(exports.SelectionInputType={})),function(SwitchControlType){SwitchControlType.SWITCH="SWITCH",SwitchControlType.CHECK_BOX="CHECK_BOX"}(exports.SwitchControlType||(exports.SwitchControlType={})),function(TextButtonStyle){TextButtonStyle.TEXT="TEXT",TextButtonStyle.FILLED="FILLED"}(exports.TextButtonStyle||(exports.TextButtonStyle={})),function(UpdateDraftBodyType){UpdateDraftBodyType.IN_PLACE_INSERT="IN_PLACE_INSERT",UpdateDraftBodyType.INSERT_AT_START="INSERT_AT_START",UpdateDraftBodyType.INSERT_AT_END="INSERT_AT_END"}(exports.UpdateDraftBodyType||(exports.UpdateDraftBodyType={}))},{}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InspectableComponent=void 0;var InspectableComponent=function(){function InspectableComponent(){}return InspectableComponent.prototype.printJson=function(){return JSON.stringify(this)},InspectableComponent}();exports.InspectableComponent=InspectableComponent},{}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionStore=void 0;var event_1=require("../handlers/event"),identifiers_1=require("../utils/identifiers"),require=function(){function ActionStore(){}return Object.defineProperty(ActionStore,"identifiers",{get:function(){return Object.keys(this.actions)},enumerable:!1,configurable:!0}),ActionStore.bind=function(event,caller,action,target){this.set(caller,action);var eventTarget=target||caller;return eventTarget.addEventListener(event,function(){(0,event_1.handleEvent)(eventTarget)}),this},ActionStore.get=function(guid){return this.actions[guid]},ActionStore.set=function(caller,action){var actions=this.actions,identifiers=this.identifiers,identifiers=(0,identifiers_1.getGuid)(identifiers);return actions[identifiers]=action,caller.classList.add("pointer"),caller.setAttribute("action",identifiers),this},ActionStore.remove=function(guid){return delete this.actions[guid],this},ActionStore.actions={},ActionStore}();exports.ActionStore=require},{"../handlers/event":11,"../utils/identifiers":34}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RuleStore=void 0;var RuleStore=function(){function RuleStore(rules){this.rules=rules}return RuleStore.prototype.find=function(predicate){return this.rules.find(predicate)||[]},RuleStore}();exports.RuleStore=RuleStore},{}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addTelListener=exports.addAnchorListener=exports.openURL=void 0;var dialogs_1=require("./dialogs"),network_1=require("./network"),url_1=require("./url");exports.openURL=function(href,type,onClose){var url=new URL("".concat((0,url_1.getNormalizedBaseURL)(),"/redirect.html"));return url.searchParams.append("endpoint",(0,network_1.forceHttps)(href)),{browser:function(url){return Office.context.ui.openBrowserWindow(url.toString())},dialog:function(url){Office.context.ui.displayDialogAsync(url.toString(),{width:150,height:250},function(res){res.value.addEventHandler(Office.EventType.DialogEventReceived,function(event){return(0,dialogs_1.dialogCallback)(event,onClose)})})},web:function(url){url=window.open(url);null!=url&&url.addEventListener("close",function(){(0,dialogs_1.dialogCallback)({error:dialogs_1.DialogErrorCode.CLOSED},onClose)})}}[type](url)},exports.addAnchorListener=function(target,href,type){target.addEventListener("click",function(event){return event.preventDefault(),(0,exports.openURL)(href,type),!1})};exports.addTelListener=function(target){target.addEventListener("click",function(event){return event.stopPropagation(),!(target.target="_self")})}},{"./dialogs":30,"./network":37,"./url":40}],30:[function(require,module,exports){"use strict";var DialogErrorCode,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},log_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.dialogCallback=exports.DialogErrorCode=void 0,require("./log"));(function(DialogErrorCode){DialogErrorCode[DialogErrorCode.CLOSED=12006]="CLOSED",DialogErrorCode[DialogErrorCode.HTTPS_ERROR=12003]="HTTPS_ERROR",DialogErrorCode[DialogErrorCode.LOAD_ERROR=12002]="LOAD_ERROR"})(DialogErrorCode=exports.DialogErrorCode||(exports.DialogErrorCode={}));exports.dialogCallback=function(event,onClose){var error,eventLog={type:"dialog"};return"error"in event?((error=event.error)===DialogErrorCode.CLOSED&&null!=onClose&&onClose(),(onClose={})[DialogErrorCode.LOAD_ERROR]="The dialog box has been directed to a page that it cannot find or load, or the URL syntax is invalid.",onClose[DialogErrorCode.HTTPS_ERROR]="The dialog box has been directed to a URL with the HTTP protocol. HTTPS is required.",onClose[DialogErrorCode.CLOSED]="Dialog closed.",onClose=onClose,(0,log_1.log)("log","dialog event",__assign(__assign({},eventLog),{event:onClose[error]||"Unknown error in dialog box."}))):(onClose=event.message,(0,log_1.log)("log","dialog event",__assign(__assign({},eventLog),{event:onClose})))}},{"./log":35}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.callFunctionFromGlobalScope=void 0;exports.callFunctionFromGlobalScope=function(name,event){name=window[name];return"function"==typeof name?name(event):void 0}},{}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isSelectedStateFormElement=exports.isOfficeJSstateFormElement=exports.isInputLike=exports.isHTMLAnchorElement=exports.isHTMLTextAreaElement=exports.isElementNode=void 0;exports.isElementNode=function(node){return node.nodeType===Node.ELEMENT_NODE},exports.isHTMLTextAreaElement=function(node){return"textarea"===node.nodeName.toLowerCase()},exports.isHTMLAnchorElement=function(node){return"a"===node.nodeName.toLowerCase()},exports.isInputLike=function(element){return"name"in element&&"value"in element},exports.isOfficeJSstateFormElement=function(element){var classList=element.classList;return["ms-Toggle-input","ms-CheckBox-input","ms-RadioButton-input"].some(function(token){return classList.contains(token)})};exports.isSelectedStateFormElement=function(element){return element.classList.contains("is-selected")||element.checked}},{}],33:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return{value:(o=o&&i>=o.length?void 0:o)&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},anchors_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindSelfRemovingListener=exports.stripHTMLMarkup=exports.parseHTMLWidgetContent=exports.sanitizeContent=exports.sanitizeAttributes=exports.bindAnchorListener=exports.parsePixelLength=void 0,require("./anchors")),guards_1=require("./guards"),mailbox_1=require("./mailbox");exports.parsePixelLength=function(length){return Math.ceil(+length.replace("px",""))},exports.bindAnchorListener=function(anchor,rules,defaultHandler){var href=anchor.href;(0,__read(rules.find(function(_a){_a=__read(_a,1)[0];return href.startsWith(_a)})||[,defaultHandler],2)[1])(anchor)},exports.sanitizeAttributes=function(element,allowedAttributes){var e_1,_a,attributes=element.attributes,tagName=element.tagName.toLowerCase();try{for(var attributes_1=__values(attributes),attributes_1_1=attributes_1.next();!attributes_1_1.done;attributes_1_1=attributes_1.next()){var attributeName=attributes_1_1.value.name.toLowerCase();allowedAttributes[tagName].includes(attributeName)||attributes.removeNamedItem(attributeName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{attributes_1_1&&!attributes_1_1.done&&(_a=attributes_1.return)&&_a.call(attributes_1)}finally{if(e_1)throw e_1.error}}return element},exports.sanitizeContent=function(node,allowedNodeNames){var nodeName=node.nodeName.toLowerCase();return allowedNodeNames.includes(nodeName)?node:(allowedNodeNames=document.createTextNode((0,guards_1.isElementNode)(node)?node.outerHTML:node.nodeValue||""),null!=(nodeName=node.parentNode)&&nodeName.replaceChild(allowedNodeNames,node),allowedNodeNames)},exports.parseHTMLWidgetContent=function(parent,content){for(var temp=document.createElement("div"),walker=(temp.innerHTML=content,document.createTreeWalker(temp,NodeFilter.SHOW_ALL,{acceptNode:function(node){return node.nodeType===Node.ATTRIBUTE_NODE?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}})),allowedNodeNames=["b","i","u","s","font","a","time","br"],allowedAttributes={font:["color"],a:["href"]},anchorHandlerRules=[["mailto:",function(anchor){(0,mailbox_1.addMailtoListener)(anchor,anchor.href.replace("mailto:",""))}],["tel:",function(anchor){(0,anchors_1.addTelListener)(anchor)}]],defaultAnchorHandler=function(anchor){(0,anchors_1.addAnchorListener)(anchor,anchor.href,"browser")},current=walker.currentNode;current;)(0,exports.sanitizeContent)(current,allowedNodeNames),(0,guards_1.isElementNode)(current)&&(0,exports.sanitizeAttributes)(current,allowedAttributes),(0,guards_1.isHTMLAnchorElement)(current)&&(0,exports.bindAnchorListener)(current,anchorHandlerRules,defaultAnchorHandler),current=walker.nextNode();return parent.append.apply(parent,__spreadArray([],__read(temp.childNodes),!1)),parent},exports.stripHTMLMarkup=function(content){var temp=document.createElement("div");return temp.innerHTML=content,temp.textContent};exports.bindSelfRemovingListener=function(target,type,callback){function listener(event){callback(event),target.removeEventListener(type,listener)}target.addEventListener(type,listener)}},{"./anchors":29,"./guards":32,"./mailbox":36}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGuid=void 0;exports.getGuid=function(store,seed){void 0===seed&&(seed=1e5);var id=btoa((Math.random()*seed).toString());return store.includes(id)?(0,exports.getGuid)(store,seed):(store.unshift(id),id)}},{}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.log=void 0;exports.log=function(level,message,data){var stamp=(new Date).toISOString(),date=stamp.slice(0,10),stamp=stamp.slice(11);console[level].call(console,{message:message,on:date,at:stamp,data:data})}},{}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addMailtoListener=void 0;exports.addMailtoListener=function(target,to){target.addEventListener("click",function(event){return event.preventDefault(),Office.context.mailbox.displayNewMessageForm({toRecipients:[to]}),!1})}},{}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forceHttps=void 0;exports.forceHttps=function(input){var secure=/^https:\/\//.test(input),insecure=/^http:\/\//.test(input);return secure?input:"https://".concat(insecure?input.substring(7):input)}},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProfile=exports.getMailbox=exports.getSettings=exports.supportsSet=void 0;exports.supportsSet=function(name,version){return Office.context.requirements.isSetSupported(name,version.toString())},exports.getSettings=function(){return Office.context.roamingSettings||{get:function(name){name=localStorage.getItem(name);return null===name?void 0:JSON.parse(name)},remove:function(name){localStorage.removeItem(name)},saveAsync:function(callback){null!=callback&&callback({asyncContext:void 0,error:{code:0,message:"",name:""},diagnostics:"",status:Office.AsyncResultStatus.Succeeded,value:void 0})},set:function(name,value){localStorage.setItem(name,JSON.stringify(value))}}},exports.getMailbox=function(){return Office.context.mailbox||{getCallbackTokenAsync:function(callback,asyncContext){callback({asyncContext:asyncContext,diagnostics:{},error:{code:0,message:"",name:""},status:Office.AsyncResultStatus.Succeeded,value:""})},userProfile:(0,exports.getProfile)()}};exports.getProfile=function(){var _a;return(null==(_a=Office.context.mailbox)?void 0:_a.userProfile)||{accountType:"office365",displayName:"",emailAddress:"",timeZone:"UTC"}}},{}],39:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};Object.defineProperty(exports,"__esModule",{value:!0}),exports.safeToString=void 0;exports.safeToString=function(item){var rules=[["string"==typeof item,function(item){return item}],["object"==typeof item&&!!item&&"toString"in item,function(item){return item.toString()}]],rules=__read(rules.find(function(_a){return!!__read(_a,1)[0]})||[,function(item){return Object.prototype.toString.call(item)}],2)[1];return null==rules?void 0:rules(item)}},{}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNormalizedBaseURL=void 0;exports.getNormalizedBaseURL=function(){var origin=location.origin,pathname=location.pathname;return"".concat(origin).concat(pathname.replace("index.html","").replace(/\/$/,""))}},{}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports=require("./ready");Office.onReady(exports.readyCallback)},{"./ready":43}],42:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},overlay_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialize=void 0,require("./gas-js/components/overlay")),spinner_1=require("./gas-js/components/spinner"),events_1=require("./gas-js/events");exports.initialize=function(homepageTriggerName){return __awaiter(void 0,void 0,void 0,function(){var event,overlayParent,overlay,spinner,homepageTrigger,cards,CardStore;return __generator(this,function(_a){switch(_a.label){case 0:return event=new events_1.EventObject,overlayParent=document.getElementById("app-overlay"),(overlay=new overlay_1.Overlay("app-body")).setColor("white"),[4,overlay.render(overlayParent)];case 1:return _a.sent(),[4,overlay.show()];case 2:return _a.sent(),(spinner=new spinner_1.Spinner).setSize("large"),[4,spinner.render(overlayParent)];case 3:return _a.sent(),[4,spinner.show()];case 4:if(_a.sent(),"function"!=typeof(homepageTrigger=window[homepageTriggerName]))throw new Error('missing homepage trigger "'.concat(homepageTriggerName,'"'));return[4,homepageTrigger(event)];case 5:if(homepageTrigger=_a.sent(),cards=homepageTrigger instanceof Array?homepageTrigger:[homepageTrigger],cards.at(-1))return[4,(CardStore=window.CardServiceConfig.CardStore).teardown()];throw new Error("Add-In must initialize with at least 1 card");case 6:return _a.sent(),CardStore.reset(cards),[4,CardStore.render(document.getElementById("app-body"))];case 7:return _a.sent(),[4,spinner.hide()];case 8:return _a.sent(),[4,overlay.hide()];case 9:return _a.sent(),[2]}})})}},{"./gas-js/components/overlay":4,"./gas-js/components/spinner":5,"./gas-js/events":6}],43:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else{if(!(t&&_.label<t[2])){t[2]&&_.ops.pop(),_.trys.pop();continue}_.label=t[2],_.ops.push(op)}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},menu_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.readyCallback=void 0,require("./gas-js/components/menu")),universal_1=require("./gas-js/services/card/actions/universal"),log_1=require("./gas-js/utils/log"),office_1=require("./gas-js/utils/office"),strings_1=require("./gas-js/utils/strings"),initialize_1=require("./initialize"),url_1=require("./gas-js/utils/url"),showRootElement=function(id){var root=document.getElementById(id);root?root.style.visibility="visible":(0,log_1.log)("error","missing root element",{id:id})};exports.readyCallback=function(info){return __awaiter(void 0,void 0,void 0,function(){var host,res,_a,_b,homepageTrigger,_c,primaryColor,common,menu;return __generator(this,function(_e){switch(_e.label){case 0:return(host=info.host)!==Office.HostType.Outlook&&(0,log_1.log)("log","initialized outside host application",(0,strings_1.safeToString)(host)),[4,fetch("".concat((0,url_1.getNormalizedBaseURL)(),"/appsscript.json"))];case 1:return(res=_e.sent()).ok?[3,3]:(_a=log_1.log,_b=["error","failed to get manifest"],[4,res.text()]);case 2:return _a.apply(void 0,_b.concat([_e.sent()])),[2];case 3:return[4,res.json()];case 4:return _c=_e.sent().addOns,common=_c.common,_c=_c.gmail,homepageTrigger=_c.homepageTrigger,_c=common.universalActions,common=common.layoutProperties,primaryColor=common.primaryColor,common=common.secondaryColor,menu=new menu_1.AddInMenu,window.CardServiceConfig.set("primaryColor",primaryColor).set("secondaryColor",common).set("menu",menu).validate(),host&&(0,office_1.supportsSet)("Mailbox",1.5)&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,function(){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(_a){return(0,office_1.getSettings)().saveAsync(function(){(0,initialize_1.initialize)(homepageTrigger.runFunction)}),[2]})})}),_c.forEach(function(_a){var label=_a.label,_a=_a.runFunction,action=new universal_1.UniversalAction;action.setText(label),action.setRunFunction(_a),menu.addUniversalAction(action)}),[4,menu.render(document.getElementById("app-menu"))];case 5:return _e.sent(),showRootElement("app-body"),[2,(0,initialize_1.initialize)(homepageTrigger.runFunction)]}})})}},{"./gas-js/components/menu":3,"./gas-js/services/card/actions/universal":17,"./gas-js/utils/log":35,"./gas-js/utils/office":38,"./gas-js/utils/strings":39,"./gas-js/utils/url":40,"./initialize":42}]},{},[41]);
</script>
</body>

</html>